<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>July 5th Weekday Matrix - Interactive Buddhist Era Timeline</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background particles */
        #particles-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.3;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Animated header */
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: glow 2s ease-in-out infinite alternate;
            position: relative;
        }

        @keyframes glow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 10px rgba(255,255,255,0.5); }
            to { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 20px rgba(255,255,255,0.8), 0 0 30px rgba(255,255,255,0.6); }
        }

        /* Control panel */
        .control-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn:before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover:before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        /* Table styling */
        .table-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            overflow: hidden;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        thead tr {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
        }

        th {
            padding: 15px;
            text-align: center;
            font-weight: bold;
            letter-spacing: 1px;
            position: relative;
        }

        td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
            position: relative;
            transition: all 0.3s;
        }

        tbody tr {
            transition: all 0.3s;
            position: relative;
        }

        tbody tr:hover {
            background: linear-gradient(90deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .year-col {
            font-weight: bold;
            background: linear-gradient(90deg, rgba(102,126,234,0.05) 0%, rgba(118,75,162,0.05) 100%);
            position: relative;
        }

        .cell-content {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .occurrence {
            background: linear-gradient(135deg, #4caf50, #8bc34a);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .weekend-highlight {
            background: linear-gradient(135deg, #f44336, #ff6b6b);
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
            animation: pulse 1.5s infinite, glow-red 2s infinite;
        }

        @keyframes glow-red {
            0% { box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4); }
            50% { box-shadow: 0 4px 25px rgba(244, 67, 54, 0.6), 0 0 30px rgba(244, 67, 54, 0.3); }
            100% { box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4); }
        }

        .special-event {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
            animation: pulse 1.5s infinite, sparkle 3s infinite;
            line-height: 1.2;
            padding: 6px 12px !important;
        }

        .special-year {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            animation: sparkle 3s infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .cell-content:hover {
            transform: scale(1.2) rotate(5deg);
            z-index: 10;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        /* Special events info */
        .special-info {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 15px;
            border-radius: 15px;
            margin: 10px 0;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
            font-size: 0.95em;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .event-list {
            list-style: none;
            padding: 10px 0;
        }

        .event-list li {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            border-left: 4px solid #764ba2;
            transition: all 0.3s;
        }

        .event-list li:hover {
            transform: translateX(10px);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }

        /* Tooltip styling */
        .tooltip {
            position: absolute;
            text-align: center;
            padding: 12px;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border-radius: 10px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        /* Visualization container */
        .viz-container {
            margin-top: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .viz-title {
            text-align: center;
            color: #764ba2;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        /* Loading animation */
        .loader {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            display: none;
        }

        .loader div {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #764ba2;
            animation: loader 1.2s linear infinite;
        }

        @keyframes loader {
            0% {
                transform: rotate(0deg) translate(30px) rotate(0deg);
            }
            100% {
                transform: rotate(360deg) translate(30px) rotate(-360deg);
            }
        }

        /* Stats cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #764ba2;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #666;
            margin-top: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            .table-container { padding: 15px; overflow-x: auto; }
            th, td { padding: 8px; font-size: 0.9em; }
            .controls { flex-direction: column; width: 100%; }
            .btn { width: 100%; }
        }
    </style>
</head>
<body>
    <canvas id="particles-canvas"></canvas>
    
    <div class="main-container">
        <h1>🌟 Interactive July 5th Buddhist Era Timeline 🌟</h1>
        
        <!-- Control Panel -->
        <div class="control-panel">
            <div class="controls">
                <button class="btn" onclick="animateTable()">✨ Animate Table</button>
                <button class="btn" onclick="showVisualization()">📊 Show D3 Visualization</button>
                <button class="btn" onclick="filterWeekends()">🎯 Highlight Weekends & Holidays</button>
                <button class="btn" onclick="resetView()">🔄 Reset View</button>
                <button class="btn" onclick="playSound()">🔊 Sound Effects</button>
                <button class="btn" onclick="startFireworks()">🎆 Fireworks</button>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="stats-container">
            <div class="stat-card" onclick="highlightWeekdays('Saturday')">
                <div class="stat-number" id="saturday-count">0</div>
                <div class="stat-label">Saturdays</div>
            </div>
            <div class="stat-card" onclick="highlightWeekdays('Sunday')">
                <div class="stat-number" id="sunday-count">0</div>
                <div class="stat-label">Sundays</div>
            </div>
            <div class="stat-card" onclick="highlightWeekdays('Weekend')">
                <div class="stat-number" id="weekend-count">0</div>
                <div class="stat-label">Total Weekends</div>
            </div>
            <div class="stat-card" onclick="focusYear(2552)">
                <div class="stat-number">2552</div>
                <div class="stat-label">Special Year</div>
            </div>
        </div>
        
        <!-- Main Table -->
        <div class="table-container">
            <table id="mainTable">
                <thead>
                    <tr>
                        <th>Year (B.E.)</th>
                        <th>Monday</th>
                        <th>Tuesday</th>
                        <th>Wednesday</th>
                        <th>Thursday</th>
                        <th>Friday</th>
                        <th>Saturday</th>
                        <th>Sunday</th>
                    </tr>
                </thead>
                <tbody>
<tr><td class='year-col'>2539</td><td></td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2539" data-day="Friday">July 5th</span></td><td></td><td></td></tr>
<tr><td class='year-col'>2540</td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2540" data-day="Saturday">July 5th</span></td><td></td></tr>
<tr><td class='year-col'>2541</td><td></td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2541" data-day="Sunday">July 5th</span></td></tr>
<tr><td class='year-col'>2542</td><td><span class='cell-content occurrence' data-year="2542" data-day="Monday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2543</td><td></td><td></td><td><span class='cell-content occurrence' data-year="2543" data-day="Wednesday">July 5th</span></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2544</td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2544" data-day="Thursday">July 5th</span></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2545</td><td></td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2545" data-day="Friday">July 5th</span></td><td></td><td></td></tr>
<tr><td class='year-col'>2546</td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2546" data-day="Saturday">July 5th</span></td><td></td></tr>
<tr><td class='year-col'>2547</td><td><span class='cell-content occurrence' data-year="2547" data-day="Monday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2548</td><td></td><td><span class='cell-content occurrence' data-year="2548" data-day="Tuesday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2549</td><td></td><td></td><td><span class='cell-content occurrence' data-year="2549" data-day="Wednesday">July 5th</span></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2550</td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2550" data-day="Thursday">July 5th</span></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2551</td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2551" data-day="Saturday">July 5th</span></td><td></td></tr>
<tr id="year-2552" style="background: linear-gradient(90deg, rgba(255,215,0,0.2) 0%, rgba(255,237,78,0.2) 100%);">
    <td class='year-col special-year'>2552 ⭐</td>
    <td>
        <span class='cell-content special-event' data-year="2552" data-day="Monday" style="background: linear-gradient(135deg, #FF6347, #FF8C00);">
            July 6<br><small style="font-size: 0.7em;">วันหยุดพิเศษ</small>
        </span>
    </td>
    <td>
        <span class='cell-content special-event' data-year="2552" data-day="Tuesday" style="background: linear-gradient(135deg, #9370DB, #BA55D3);">
            July 7<br><small style="font-size: 0.7em;">อาสาฬหบูชา</small>
        </span>
    </td>
    <td>
        <span class='cell-content special-event' data-year="2552" data-day="Wednesday" style="background: linear-gradient(135deg, #9370DB, #BA55D3);">
            July 8<br><small style="font-size: 0.7em;">วันเข้าพรรษา</small>
        </span>
    </td>
    <td>
        <span class='cell-content special-event' data-year="2552" data-day="Thursday" style="background: linear-gradient(135deg, #20B2AA, #48D1CC);">
            July 9<br><small style="font-size: 0.7em;">ชำระหนี้ กยศ.</small>
        </span>
    </td>
    <td></td>
    <td></td>
    <td>
        <span class='cell-content weekend-highlight' data-year="2552" data-day="Sunday" style="background: linear-gradient(135deg, #FFD700, #FFA500); font-size: 1.1em; font-weight: bold; box-shadow: 0 0 25px rgba(255, 215, 0, 0.7);">
            July 5th<br><small style="font-size: 0.65em;">ครบกำหนดชำระหนี้</small>
        </span>
        <div class="special-info">
            <strong>พ.ศ. 2552 - Special Buddhist Calendar Week:</strong>
            <ul class="event-list">
                <li>📅 <strong>อา. 5 ก.ค.:</strong> วันครบกำหนดชำระหนี้ (Payment Due Date)</li>
                <li>🏛️ <strong>จ. 6 ก.ค.:</strong> วันหยุดพิเศษ มติ ครม. (Cabinet Special Holiday)</li>
                <li>🙏 <strong>อ. 7 ก.ค.:</strong> วันอาสาฬหบูชา (Asalha Bucha Day)</li>
                <li>☸️ <strong>พ. 8 ก.ค.:</strong> วันเข้าพรรษา (Buddhist Lent Begins)</li>
                <li>💰 <strong>พฤ. 9 ก.ค.:</strong> วันสุดท้ายชำระหนี้ กยศ. (Student Loan Final Payment)</li>
            </ul>
        </div>
    </td>
</tr>
<tr><td class='year-col'>2553</td><td><span class='cell-content occurrence' data-year="2553" data-day="Monday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2554</td><td></td><td><span class='cell-content occurrence' data-year="2554" data-day="Tuesday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2555</td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2555" data-day="Thursday">July 5th</span></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2556</td><td></td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2556" data-day="Friday">July 5th</span></td><td></td><td></td></tr>
<tr><td class='year-col'>2557</td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2557" data-day="Saturday">July 5th</span></td><td></td></tr>
<tr><td class='year-col'>2558</td><td></td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2558" data-day="Sunday">July 5th</span></td></tr>
<tr><td class='year-col'>2559</td><td></td><td><span class='cell-content occurrence' data-year="2559" data-day="Tuesday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2560</td><td></td><td></td><td><span class='cell-content occurrence' data-year="2560" data-day="Wednesday">July 5th</span></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2561</td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2561" data-day="Thursday">July 5th</span></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2562</td><td></td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2562" data-day="Friday">July 5th</span></td><td></td><td></td></tr>
<tr><td class='year-col'>2563</td><td></td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2563" data-day="Sunday">July 5th</span></td></tr>
<tr><td class='year-col'>2564</td><td><span class='cell-content occurrence' data-year="2564" data-day="Monday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2565</td><td></td><td><span class='cell-content occurrence' data-year="2565" data-day="Tuesday">July 5th</span></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2566</td><td></td><td></td><td><span class='cell-content occurrence' data-year="2566" data-day="Wednesday">July 5th</span></td><td></td><td></td><td></td><td></td></tr>
<tr><td class='year-col'>2567</td><td></td><td></td><td></td><td></td><td><span class='cell-content occurrence' data-year="2567" data-day="Friday">July 5th</span></td><td></td><td></td></tr>
<tr><td class='year-col'>2568</td><td></td><td></td><td></td><td></td><td></td><td><span class='cell-content weekend-highlight' data-year="2568" data-day="Saturday">July 5th</span></td><td></td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- D3.js Visualization Container -->
        <div class="viz-container" id="vizContainer" style="display: none;">
            <h2 class="viz-title">📈 Interactive July 5th Weekday Distribution</h2>
            <div id="chart"></div>
            <div id="pieChart"></div>
            <div id="timeline"></div>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <!-- Audio context for sound effects -->
    <audio id="clickSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhDTGSzvLJeCcFJHfH8N2QQAoUXrTp66hVFApGn+Dy" type="audio/wav">
    </audio>

    <script>
        // Initialize particle background
        const canvas = document.getElementById('particles-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.radius = Math.random() * 3 + 1;
                this.opacity = Math.random() * 0.5 + 0.5;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;

                if (this.x < 0 || this.x > canvas.width) this.vx = -this.vx;
                if (this.y < 0 || this.y > canvas.height) this.vy = -this.vy;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                ctx.fill();
            }
        }

        const particles = [];
        for (let i = 0; i < 50; i++) {
            particles.push(new Particle());
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(particle => {
                particle.update();
                particle.draw();
            });
            requestAnimationFrame(animateParticles);
        }
        animateParticles();

        // Window resize handler
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Count statistics
        function updateStatistics() {
            const cells = document.querySelectorAll('.cell-content[data-year]');
            let saturdayCount = 0, sundayCount = 0, weekendCount = 0;
            
            cells.forEach(cell => {
                const day = cell.getAttribute('data-day');
                // Only count July 5th occurrences
                if (cell.textContent.includes('July 5th')) {
                    if (day === 'Saturday') saturdayCount++;
                    if (day === 'Sunday') sundayCount++;
                    if (day === 'Saturday' || day === 'Sunday') weekendCount++;
                }
            });
            
            document.getElementById('saturday-count').textContent = saturdayCount;
            document.getElementById('sunday-count').textContent = sundayCount;
            document.getElementById('weekend-count').textContent = weekendCount;
        }
        updateStatistics();

        // Interactive tooltips
        document.querySelectorAll('.cell-content').forEach(cell => {
            cell.addEventListener('mouseenter', function(e) {
                const tooltip = document.getElementById('tooltip');
                const year = this.getAttribute('data-year');
                const day = this.getAttribute('data-day');
                const dateText = this.innerText.split('\n')[0];
                
                let tooltipContent = `<strong>Year ${year} B.E.</strong><br>`;
                
                if (year === '2552') {
                    if (dateText.includes('July 5')) {
                        tooltipContent += `July 5th falls on ${day}<br>วันครบกำหนดชำระหนี้`;
                    } else if (dateText.includes('July 6')) {
                        tooltipContent += `July 6th - ${day}<br>วันหยุดพิเศษ (มติ ครม.)`;
                    } else if (dateText.includes('July 7')) {
                        tooltipContent += `July 7th - ${day}<br>วันอาสาฬหบูชา`;
                    } else if (dateText.includes('July 8')) {
                        tooltipContent += `July 8th - ${day}<br>วันเข้าพรรษา`;
                    } else if (dateText.includes('July 9')) {
                        tooltipContent += `July 9th - ${day}<br>วันสุดท้ายชำระหนี้ กยศ.`;
                    }
                    tooltipContent += '<br>🌟 Special Buddhist Events Week! 🌟';
                } else {
                    tooltipContent += `July 5th falls on ${day}`;
                }
                
                tooltip.innerHTML = tooltipContent;
                tooltip.style.opacity = '1';
                tooltip.style.left = e.pageX + 10 + 'px';
                tooltip.style.top = e.pageY + 10 + 'px';
            });
            
            cell.addEventListener('mouseleave', function() {
                const tooltip = document.getElementById('tooltip');
                tooltip.style.opacity = '0';
            });
            
            cell.addEventListener('click', function() {
                createRipple(event);
                playClickSound();
            });
        });

        // Ripple effect
        function createRipple(e) {
            const ripple = document.createElement('div');
            ripple.style.position = 'absolute';
            ripple.style.width = '10px';
            ripple.style.height = '10px';
            ripple.style.borderRadius = '50%';
            ripple.style.background = 'rgba(102, 126, 234, 0.5)';
            ripple.style.left = e.pageX - 5 + 'px';
            ripple.style.top = e.pageY - 5 + 'px';
            ripple.style.pointerEvents = 'none';
            ripple.style.transition = 'all 0.6s';
            document.body.appendChild(ripple);
            
            setTimeout(() => {
                ripple.style.width = '100px';
                ripple.style.height = '100px';
                ripple.style.marginLeft = '-45px';
                ripple.style.marginTop = '-45px';
                ripple.style.opacity = '0';
            }, 10);
            
            setTimeout(() => ripple.remove(), 600);
        }

        // Sound effects
        function playClickSound() {
            const audio = document.getElementById('clickSound');
            audio.currentTime = 0;
            audio.play().catch(e => console.log('Audio play failed:', e));
        }

        function playSound() {
            // Create a simple tone using Web Audio API
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 440;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        // Table animations
        function animateTable() {
            const rows = document.querySelectorAll('tbody tr');
            rows.forEach((row, index) => {
                row.style.animation = 'none';
                setTimeout(() => {
                    row.style.animation = `float 3s ease-in-out ${index * 0.1}s infinite`;
                }, 10);
            });
        }

        // Filter functions
        function filterWeekends() {
            const rows = document.querySelectorAll('tbody tr');
            rows.forEach(row => {
                const hasWeekend = row.querySelector('.weekend-highlight');
                const hasSpecialEvent = row.querySelector('.special-event');
                if (!hasWeekend && !hasSpecialEvent && row.id !== 'year-2552') {
                    row.style.opacity = '0.3';
                    row.style.transform = 'scale(0.95)';
                } else {
                    row.style.opacity = '1';
                    row.style.transform = 'scale(1)';
                }
            });
        }

        function highlightWeekdays(dayType) {
            const cells = document.querySelectorAll('.cell-content');
            cells.forEach(cell => {
                const day = cell.getAttribute('data-day');
                if (dayType === 'Weekend') {
                    if (day === 'Saturday' || day === 'Sunday') {
                        cell.style.transform = 'scale(1.3)';
                        cell.style.boxShadow = '0 0 30px rgba(255, 215, 0, 0.8)';
                    } else {
                        cell.style.opacity = '0.5';
                    }
                } else if (day === dayType) {
                    cell.style.transform = 'scale(1.3)';
                    cell.style.boxShadow = '0 0 30px rgba(102, 126, 234, 0.8)';
                } else {
                    cell.style.opacity = '0.5';
                }
            });
            
            setTimeout(resetView, 3000);
        }

        function focusYear(year) {
            const targetRow = document.getElementById(`year-${year}`);
            if (targetRow) {
                targetRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                targetRow.style.animation = 'pulse 1s 3';
                targetRow.style.boxShadow = '0 0 50px rgba(255, 215, 0, 0.8)';
                setTimeout(() => {
                    targetRow.style.animation = '';
                    targetRow.style.boxShadow = '';
                }, 3000);
            }
        }

        function resetView() {
            const rows = document.querySelectorAll('tbody tr');
            const cells = document.querySelectorAll('.cell-content');
            
            rows.forEach(row => {
                row.style.opacity = '1';
                row.style.transform = 'scale(1)';
                row.style.animation = '';
            });
            
            cells.forEach(cell => {
                cell.style.opacity = '1';
                cell.style.transform = '';
                cell.style.boxShadow = '';
            });
        }

        // Fireworks animation
        function startFireworks() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight / 2;
                    
                    for (let j = 0; j < 20; j++) {
                        const particle = document.createElement('div');
                        particle.style.position = 'fixed';
                        particle.style.width = '4px';
                        particle.style.height = '4px';
                        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                        particle.style.borderRadius = '50%';
                        particle.style.left = x + 'px';
                        particle.style.top = y + 'px';
                        particle.style.pointerEvents = 'none';
                        particle.style.zIndex = '10000';
                        document.body.appendChild(particle);
                        
                        const angle = (Math.PI * 2 / 20) * j;
                        const velocity = Math.random() * 200 + 100;
                        const vx = Math.cos(angle) * velocity;
                        const vy = Math.sin(angle) * velocity;
                        
                        particle.animate([
                            { transform: 'translate(0, 0)', opacity: 1 },
                            { transform: `translate(${vx}px, ${vy}px)`, opacity: 0 }
                        ], {
                            duration: 1000 + Math.random() * 1000,
                            easing: 'ease-out'
                        }).onfinish = () => particle.remove();
                    }
                }, i * 300);
            }
        }

        // D3.js Visualization
        function showVisualization() {
            const vizContainer = document.getElementById('vizContainer');
            vizContainer.style.display = 'block';
            vizContainer.scrollIntoView({ behavior: 'smooth' });
            
            // Clear previous charts
            d3.select("#chart").selectAll("*").remove();
            d3.select("#pieChart").selectAll("*").remove();
            d3.select("#timeline").selectAll("*").remove();
            
            // Prepare data
            const data = [];
            const cells = document.querySelectorAll('.cell-content');
            cells.forEach(cell => {
                // Only include July 5th dates in the visualization
                if (cell.textContent.includes('July 5th')) {
                    data.push({
                        year: parseInt(cell.getAttribute('data-year')),
                        day: cell.getAttribute('data-day'),
                        isWeekend: cell.classList.contains('weekend-highlight')
                    });
                }
            });
            
            // Create Bar Chart
            const margin = { top: 40, right: 30, bottom: 70, left: 60 };
            const width = Math.min(800, vizContainer.offsetWidth) - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;
            
            const svg = d3.select("#chart")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // Count by day
            const dayCount = d3.rollup(data, v => v.length, d => d.day);
            const dayData = Array.from(dayCount, ([day, count]) => ({ day, count }));
            
            const x = d3.scaleBand()
                .range([0, width])
                .domain(dayData.map(d => d.day))
                .padding(0.1);
            
            const y = d3.scaleLinear()
                .domain([0, d3.max(dayData, d => d.count)])
                .range([height, 0]);
            
            // Add gradient
            const gradient = svg.append("defs")
                .append("linearGradient")
                .attr("id", "bar-gradient")
                .attr("gradientUnits", "userSpaceOnUse")
                .attr("x1", 0).attr("y1", height)
                .attr("x2", 0).attr("y2", 0);
            
            gradient.append("stop")
                .attr("offset", "0%")
                .attr("stop-color", "#667eea");
            
            gradient.append("stop")
                .attr("offset", "100%")
                .attr("stop-color", "#764ba2");
            
            // Create bars with animation
            svg.selectAll(".bar")
                .data(dayData)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => x(d.day))
                .attr("width", x.bandwidth())
                .attr("y", height)
                .attr("height", 0)
                .attr("fill", "url(#bar-gradient)")
                .attr("cursor", "pointer")
                .on("mouseover", function(event, d) {
                    d3.select(this).attr("opacity", 0.8);
                    
                    const tooltip = d3.select("#tooltip");
                    tooltip.html(`<strong>${d.day}</strong><br>Occurrences: ${d.count}`)
                        .style("opacity", 1)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 10) + "px");
                })
                .on("mouseout", function() {
                    d3.select(this).attr("opacity", 1);
                    d3.select("#tooltip").style("opacity", 0);
                })
                .transition()
                .duration(800)
                .delay((d, i) => i * 100)
                .attr("y", d => y(d.count))
                .attr("height", d => height - y(d.count));
            
            // Add axes
            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x))
                .selectAll("text")
                .attr("transform", "rotate(-45)")
                .style("text-anchor", "end");
            
            svg.append("g")
                .call(d3.axisLeft(y));
            
            // Add title
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", -20)
                .attr("text-anchor", "middle")
                .style("font-size", "18px")
                .style("font-weight", "bold")
                .style("fill", "#764ba2")
                .text("July 5th Distribution by Weekday");
            
            // Create Pie Chart
            const pieWidth = 300;
            const pieHeight = 300;
            const radius = Math.min(pieWidth, pieHeight) / 2;
            
            const pieSvg = d3.select("#pieChart")
                .append("svg")
                .attr("width", pieWidth)
                .attr("height", pieHeight)
                .append("g")
                .attr("transform", `translate(${pieWidth / 2},${pieHeight / 2})`);
            
            const weekendData = [
                { label: "Weekdays", value: data.filter(d => !d.isWeekend).length },
                { label: "Weekends", value: data.filter(d => d.isWeekend).length }
            ];
            
            const pie = d3.pie()
                .value(d => d.value);
            
            const arc = d3.arc()
                .outerRadius(radius - 10)
                .innerRadius(radius - 70);
            
            const pieColors = d3.scaleOrdinal()
                .domain(weekendData.map(d => d.label))
                .range(["#4caf50", "#f44336"]);
            
            const arcs = pieSvg.selectAll(".arc")
                .data(pie(weekendData))
                .enter().append("g")
                .attr("class", "arc");
            
            arcs.append("path")
                .attr("d", arc)
                .attr("fill", d => pieColors(d.data.label))
                .attr("stroke", "white")
                .attr("stroke-width", 2)
                .style("opacity", 0)
                .transition()
                .duration(1000)
                .style("opacity", 1)
                .attrTween("d", function(d) {
                    const i = d3.interpolate({ startAngle: 0, endAngle: 0 }, d);
                    return function(t) {
                        return arc(i(t));
                    };
                });
            
            // Add labels
            arcs.append("text")
                .attr("transform", d => `translate(${arc.centroid(d)})`)
                .attr("text-anchor", "middle")
                .style("fill", "white")
                .style("font-weight", "bold")
                .style("font-size", "14px")
                .style("opacity", 0)
                .text(d => `${d.data.label}: ${d.data.value}`)
                .transition()
                .delay(1000)
                .duration(500)
                .style("opacity", 1);
            
            // Create Timeline
            const timelineHeight = 100;
            const timelineMargin = { top: 20, right: 30, bottom: 40, left: 30 };
            
            const timelineSvg = d3.select("#timeline")
                .append("svg")
                .attr("width", width + timelineMargin.left + timelineMargin.right)
                .attr("height", timelineHeight + timelineMargin.top + timelineMargin.bottom)
                .append("g")
                .attr("transform", `translate(${timelineMargin.left},${timelineMargin.top})`);
            
            const xScale = d3.scaleLinear()
                .domain([d3.min(data, d => d.year), d3.max(data, d => d.year)])
                .range([0, width]);
            
            // Add axis
            timelineSvg.append("g")
                .attr("transform", `translate(0,${timelineHeight})`)
                .call(d3.axisBottom(xScale).tickFormat(d3.format("d")));
            
            // Add circles for each year
            timelineSvg.selectAll(".timeline-point")
                .data(data)
                .enter().append("circle")
                .attr("class", "timeline-point")
                .attr("cx", d => xScale(d.year))
                .attr("cy", timelineHeight / 2)
                .attr("r", 0)
                .attr("fill", d => d.isWeekend ? "#f44336" : "#4caf50")
                .attr("stroke", d => d.year === 2552 ? "#ffd700" : "white")
                .attr("stroke-width", d => d.year === 2552 ? 3 : 1)
                .attr("cursor", "pointer")
                .on("mouseover", function(event, d) {
                    d3.select(this)
                        .transition()
                        .duration(200)
                        .attr("r", 12);
                    
                    const tooltip = d3.select("#tooltip");
                    tooltip.html(`<strong>Year ${d.year}</strong><br>${d.day}`)
                        .style("opacity", 1)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 10) + "px");
                })
                .on("mouseout", function(event, d) {
                    d3.select(this)
                        .transition()
                        .duration(200)
                        .attr("r", d.year === 2552 ? 10 : 6);
                    
                    d3.select("#tooltip").style("opacity", 0);
                })
                .transition()
                .duration(1000)
                .delay((d, i) => i * 30)
                .attr("r", d => d.year === 2552 ? 10 : 6);
            
            // Add title
            timelineSvg.append("text")
                .attr("x", width / 2)
                .attr("y", -5)
                .attr("text-anchor", "middle")
                .style("font-size", "16px")
                .style("font-weight", "bold")
                .style("fill", "#764ba2")
                .text("Timeline of July 5th Occurrences");
        }

        // Mouse trail effect
        let mouseTrail = [];
        document.addEventListener('mousemove', (e) => {
            if (Math.random() > 0.9) {
                const dot = document.createElement('div');
                dot.style.position = 'fixed';
                dot.style.width = '4px';
                dot.style.height = '4px';
                dot.style.background = `hsl(${Math.random() * 360}, 70%, 60%)`;
                dot.style.borderRadius = '50%';
                dot.style.left = e.clientX + 'px';
                dot.style.top = e.clientY + 'px';
                dot.style.pointerEvents = 'none';
                dot.style.zIndex = '999';
                document.body.appendChild(dot);
                
                dot.animate([
                    { transform: 'scale(1)', opacity: 1 },
                    { transform: 'scale(0)', opacity: 0 }
                ], {
                    duration: 1000,
                    easing: 'ease-out'
                }).onfinish = () => dot.remove();
            }
        });

        // Auto-highlight special year on load
        setTimeout(() => {
            focusYear(2552);
            // Also briefly highlight the special week
            const specialCells = document.querySelectorAll('#year-2552 .cell-content');
            specialCells.forEach((cell, index) => {
                setTimeout(() => {
                    cell.style.transform = 'scale(1.3) rotate(5deg)';
                    cell.style.boxShadow = '0 0 40px rgba(255, 215, 0, 0.9)';
                    setTimeout(() => {
                        cell.style.transform = '';
                        cell.style.boxShadow = '';
                    }, 1000);
                }, index * 200);
            });
        }, 1500);
    </script>
</body>
</html>
