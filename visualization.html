<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Analysis - Dual Matrix Visualization</title>
    
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --classic-blue: #0F4C81;
            --ultimate-gray: #939597;
            --illuminating: #F5DF4D;
            --very-peri: #6667AB;
            --viva-magenta: #BB2649;
            --peach-fuzz: #FFBE98;
            --mocha-mousse: #A47764;
            
            --bg-primary: #0a0e27;
            --bg-secondary: #151932;
            --text-primary: #ffffff;
            --text-secondary: #a0a9c9;
            --border-color: #2a3456;
            
            --gradient-primary: linear-gradient(135deg, var(--very-peri) 0%, var(--viva-magenta) 100%);
            --gradient-secondary: linear-gradient(135deg, var(--peach-fuzz) 0%, var(--mocha-mousse) 100%);
            --gradient-dark: linear-gradient(180deg, #0a0e27 0%, #151932 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.03;
            background-image: 
                radial-gradient(circle at 20% 50%, var(--very-peri) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--viva-magenta) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, var(--peach-fuzz) 0%, transparent 50%);
            animation: bgMove 20s ease-in-out infinite;
        }
        
        @keyframes bgMove {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(-20px, -20px) scale(1.1); }
            66% { transform: translate(20px, -10px) scale(0.9); }
        }
        
        .header {
            padding: 2rem 0;
            text-align: center;
            background: rgba(21, 25, 50, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { filter: drop-shadow(0 0 20px rgba(102, 103, 171, 0.5)); }
            to { filter: drop-shadow(0 0 30px rgba(187, 38, 73, 0.8)); }
        }
        
        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .controls {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .control-group {
            background: rgba(42, 52, 86, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        
        .control-group:hover {
            background: rgba(42, 52, 86, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 103, 171, 0.2);
        }
        
        .control-group label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .control-group select,
        .control-group input {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.95rem;
            min-width: 150px;
            transition: all 0.3s ease;
        }
        
        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: var(--very-peri);
            box-shadow: 0 0 0 3px rgba(102, 103, 171, 0.1);
        }
        
        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.9rem;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(187, 38, 73, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .stats-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .stat-card {
            background: rgba(42, 52, 86, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 103, 171, 0.2);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-secondary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .matrix-container {
            max-width: 1400px;
            margin: 3rem auto;
            padding: 0 2rem;
            background: rgba(21, 25, 50, 0.5);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .matrix-header {
            padding: 2rem;
            background: rgba(42, 52, 86, 0.2);
            border-bottom: 1px solid var(--border-color);
        }
        
        .matrix-header h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            background: var(--gradient-secondary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .matrix-viz {
            padding: 2rem;
            min-height: 600px;
            position: relative;
            overflow-x: auto;
        }
        
        .cell {
            stroke: var(--border-color);
            stroke-width: 1;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .cell:hover {
            stroke: var(--illuminating);
            stroke-width: 2;
            filter: brightness(1.2);
        }
        
        .axis-label {
            font-size: 12px;
            fill: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .axis-label:hover {
            fill: var(--illuminating);
        }
        
        .total-label {
            font-size: 13px;
            fill: var(--illuminating);
            font-weight: 700;
        }
        
        .tooltip {
            position: absolute;
            padding: 1rem;
            background: rgba(10, 14, 39, 0.95);
            border: 1px solid var(--very-peri);
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            max-width: 400px;
        }
        
        .tooltip.show {
            opacity: 1;
        }
        
        .tooltip h3 {
            color: var(--illuminating);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .tooltip p {
            color: var(--text-primary);
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }
        
        .tooltip .count {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--peach-fuzz);
        }
        
        .legend {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            padding: 1.5rem;
            background: rgba(42, 52, 86, 0.2);
            border-top: 1px solid var(--border-color);
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .legend-color {
            width: 30px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }
        
        .legend-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--very-peri);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .label-tooltip {
            position: absolute;
            padding: 0.5rem 1rem;
            background: rgba(10, 14, 39, 0.95);
            border: 1px solid var(--very-peri);
            border-radius: 6px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 2000;
            font-size: 0.9rem;
            color: var(--text-primary);
            white-space: nowrap;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .label-tooltip.show {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .matrix-viz {
                padding: 1rem;
            }
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        *:focus-visible {
            outline: 2px solid var(--very-peri);
            outline-offset: 2px;
        }
        
        @keyframes dataUpdate {
            0% { opacity: 0; transform: scale(0.8); }
            50% { opacity: 0.5; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .updating {
            animation: dataUpdate 0.5s ease-out;
        }
        
        .tab-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .tab {
            background: rgba(42, 52, 86, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 12px 12px 0 0;
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .tab:hover {
            background: rgba(42, 52, 86, 0.5);
            color: var(--text-primary);
        }
        
        .tab.active {
            background: var(--gradient-primary);
            color: white;
            border-bottom-color: transparent;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <header class="header">
        <h1>Account Analysis - Dual Matrix Visualization</h1>
        <p>Interactive Visualization of Account Distribution</p>
        <p style="font-size: 0.85rem; margin-top: 0.5rem; color: var(--illuminating);">
            ✨ LOT5 Sub-lots Consolidated | Generated: 2025-10-02 05:24:42
        </p>
    </header>
    
    <div class="controls">
        <div class="control-group">
            <label for="colorScheme">Color Scheme</label>
            <select id="colorScheme">
                <option value="pantone">Pantone Colors</option>
                <option value="heat">Heat Map</option>
                <option value="cool">Cool Tones</option>
                <option value="vibrant">Vibrant</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="cellSize">Cell Size</label>
            <input type="range" id="cellSize" min="30" max="80" value="50">
        </div>
        
        <div class="control-group">
            <button class="btn" onclick="resetView()">Reset View</button>
        </div>
        
        <div class="control-group">
            <button class="btn" onclick="exportData()">Export CSV</button>
        </div>
    </div>
    
    <div class="stats-container">
        <div class="stat-card">
            <div class="stat-value" id="totalAccounts">0</div>
            <div class="stat-label">Total Accounts</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalGroups">0</div>
            <div class="stat-label">Groups</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalLots">0</div>
            <div class="stat-label">Lots</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalFlags">4</div>
            <div class="stat-label">Group Flags</div>
        </div>
    </div>
    
    <div class="tab-container">
        <div class="tabs">
            <div class="tab active" onclick="switchTab(event, 'group-lot')">GROUP × LOT Matrix</div>
            <div class="tab" onclick="switchTab(event, 'lot-flag')">LOT × GROUP_FLAG Matrix</div>
        </div>
    </div>
    
    <div id="group-lot-content" class="tab-content active">
        <div class="matrix-container">
            <div class="matrix-header">
                <h2>GROUP × LOT Matrix</h2>
                <p>Click on cells to view account details • Hover for quick stats • Hover labels for full text</p>
            </div>
            
            <div id="matrix-viz-1" class="matrix-viz">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #0F4C81;"></div>
                    <span class="legend-label">0-10 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #6667AB;"></div>
                    <span class="legend-label">11-50 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #BB2649;"></div>
                    <span class="legend-label">51-100 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FFBE98;"></div>
                    <span class="legend-label">100+ Accounts</span>
                </div>
            </div>
        </div>
    </div>
    
    <div id="lot-flag-content" class="tab-content">
        <div class="matrix-container">
            <div class="matrix-header">
                <h2>LOT × GROUP_FLAG Matrix</h2>
                <p>Click on cells to view account details • Hover for quick stats • Includes row and column totals</p>
            </div>
            
            <div id="matrix-viz-2" class="matrix-viz">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #0F4C81;"></div>
                    <span class="legend-label">0-10 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #6667AB;"></div>
                    <span class="legend-label">11-50 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #BB2649;"></div>
                    <span class="legend-label">51-100 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FFBE98;"></div>
                    <span class="legend-label">100+ Accounts</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    <div class="label-tooltip" id="labelTooltip"></div>
    
    <script>
        const VISUALIZATION_DATA = {
  "group_lot_matrix": {
    "groups": [
      "GF1",
      "GF2",
      "GF3",
      "GF4"
    ],
    "lots": [
      "1",
      "2",
      "3",
      "4",
      "5"
    ],
    "matrix": [
      {
        "group": "GF1",
        "lot": "1",
        "count": 519938,
        "accounts": [
          "1038366852",
          "1048087379",
          "1049209893",
          "5002246060",
          "1048576620",
          "9100220566",
          "1090973166",
          "1042651116",
          "1043588639",
          "5001550254",
          "1054768803",
          "1040417507",
          "1042904871",
          "1050804902",
          "1044072180",
          "1090942821",
          "5001439930",
          "1052684815",
          "1038636094",
          "1042915237",
          "1053832133",
          "1042927626",
          "1053747624",
          "1041529384",
          "1050847156",
          "1047818833",
          "1043144099",
          "1090377113",
          "1038995760",
          "2008369943",
          "1010232126",
          "9100062173",
          "1045679089",
          "1049982363",
          "1051819067",
          "1090119742",
          "1046044680",
          "1047747189",
          "1091503392",
          "1010494538",
          "1091301579",
          "9100249522",
          "1090692914",
          "1048895122",
          "9100092777",
          "2008735427",
          "1037350480",
          "5001251486",
          "1048310116",
          "1049004191",
          "1037869060",
          "1008711802",
          "1041498829",
          "1040042155",
          "9100068659",
          "5001554527",
          "1009900129",
          "2009093542",
          "1054244294",
          "1047776057",
          "1052911455",
          "1039373151",
          "1048697339",
          "1053569467",
          "1042855293",
          "1008125792",
          "1044157186",
          "1054036780",
          "1053470592",
          "1091420497",
          "1049249933",
          "1048580539",
          "1040971393",
          "1055693157",
          "1039739369",
          "1041977913",
          "2010462300",
          "1045180459",
          "1039397441",
          "1008028274",
          "1050030869",
          "1043178449",
          "1054434573",
          "1042176248",
          "1042025657",
          "1009152424",
          "1050538943",
          "1055493964",
          "1048866157",
          "1045099147",
          "1040624723",
          "9100067745",
          "1053975627",
          "1039317766",
          "5001446457",
          "2009673689",
          "1044522259",
          "1039868924",
          "1053591624",
          "1043187383"
        ]
      },
      {
        "group": "GF1",
        "lot": "2",
        "count": 424963,
        "accounts": [
          "1041474814",
          "1048693546",
          "5090038002",
          "1046543806",
          "9100166280",
          "9100053060",
          "1044527684",
          "9100067504",
          "1090551881",
          "1051150981",
          "5000228820",
          "1049871375",
          "1045056022",
          "1049460596",
          "1042564353",
          "1042342423",
          "1051469570",
          "9100121974",
          "1042492697",
          "1042332584",
          "1011127946",
          "1091246349",
          "1046417797",
          "9100157678",
          "1045003352",
          "1042460116",
          "1000885445",
          "1045955620",
          "1041689462",
          "9100158914",
          "1054325030",
          "1040422039",
          "1051653118",
          "1053118465",
          "1052468330",
          "1010547682",
          "9100272588",
          "1005223297",
          "1002974941",
          "1006734880",
          "1090767264",
          "9100179234",
          "1041369379",
          "1055104224",
          "1050335341",
          "1054518440",
          "1055110178",
          "9190080473",
          "1005654298",
          "2010724941",
          "1051168562",
          "1050696751",
          "1044831081",
          "1090802752",
          "1050153340",
          "2000346162",
          "1009102133",
          "1044557087",
          "5000006348",
          "1042914656",
          "1044031808",
          "1091275500",
          "5000389417",
          "1054113831",
          "1039761003",
          "1054680957",
          "1090837408",
          "1041719426",
          "1052354580",
          "1010831232",
          "1054645787",
          "1010484435",
          "2010279859",
          "5002081908",
          "1091257251",
          "9100040542",
          "9100273496",
          "9100254904",
          "1039740073",
          "1002703956",
          "1002948088",
          "1005393257",
          "1046224891",
          "1039733026",
          "1044336617",
          "1090274063",
          "1037483413",
          "1054332959",
          "1009961276",
          "5001203740",
          "1005253250",
          "9100210866",
          "9100083495",
          "1040426158",
          "9100219434",
          "1008649848",
          "1038382440",
          "9100304883",
          "1041655681",
          "1056449357"
        ]
      },
      {
        "group": "GF1",
        "lot": "3",
        "count": 572364,
        "accounts": [
          "1091221087",
          "1038220289",
          "5000464591",
          "1040741991",
          "1039690416",
          "1044537922",
          "1042697671",
          "5001754909",
          "1041836090",
          "1048625761",
          "1045860603",
          "1045150711",
          "1044325224",
          "1055133143",
          "1048463923",
          "1053542488",
          "1000229149",
          "1008062391",
          "1050312392",
          "1044846178",
          "1010666142",
          "1050695909",
          "1043566295",
          "1055034285",
          "1041431295",
          "1046346555",
          "1008720577",
          "1042477965",
          "1042562318",
          "1040271065",
          "1008209503",
          "1009327534",
          "1050301412",
          "9200002578",
          "1044617160",
          "1054439699",
          "1049450507",
          "5001781639",
          "1004895070",
          "1045053554",
          "1009129058",
          "1038661803",
          "5001694086",
          "1010871587",
          "1046277472",
          "1009014846",
          "1051371376",
          "1042233357",
          "1048475220",
          "1047130068",
          "1040146422",
          "1046190318",
          "1046730053",
          "9200037954",
          "1050483367",
          "1090138968",
          "5000535995",
          "1000041255",
          "5000747844",
          "1009295896",
          "1045098426",
          "1056495597",
          "1042010145",
          "1010470590",
          "1009669818",
          "1044842083",
          "1009904221",
          "1049588738",
          "1010026038",
          "1004508336",
          "1044367881",
          "1011023474",
          "1046789538",
          "1047430274",
          "1053449429",
          "1009754181",
          "2000259669",
          "1048582612",
          "1005297460",
          "1040022456",
          "1047104334",
          "1044278943",
          "1049803159",
          "1044079975",
          "1051241391",
          "1041586833",
          "1091036514",
          "1051713390",
          "1051450454",
          "1045115495",
          "5001919991",
          "9100033373",
          "1039197515",
          "1038578035",
          "1045671053",
          "1039485375",
          "1042986266",
          "1009419226",
          "1055245618",
          "5001511429"
        ]
      },
      {
        "group": "GF1",
        "lot": "4",
        "count": 681485,
        "accounts": [
          "1055073477",
          "1006750355",
          "1007685786",
          "1047512599",
          "5001681650",
          "1005371350",
          "1002856272",
          "1003109039",
          "1003932568",
          "1009687069",
          "1000010163",
          "1002286425",
          "1006615903",
          "1001061969",
          "1012721140",
          "1032001534",
          "1038276233",
          "2010258754",
          "1036448932",
          "5000651634",
          "1030661162",
          "1026830850",
          "1048255115",
          "1090069109",
          "1005208298",
          "9100007950",
          "1030356661",
          "1000363376",
          "1027920594",
          "1035280469",
          "1010380532",
          "5001631505",
          "5001599261",
          "1051624584",
          "1006403949",
          "1037619706",
          "1033479764",
          "5001672228",
          "1049228790",
          "1052774504",
          "1035430452",
          "1024976335",
          "1009707337",
          "1091252209",
          "1055092439",
          "1006872779",
          "1006074651",
          "1034422987",
          "1021672521",
          "1007699450",
          "1035370190",
          "1001595505",
          "2009982223",
          "1003672086",
          "1050825152",
          "1046617966",
          "1008920916",
          "1003183638",
          "1010321765",
          "1027103391",
          "1003483631",
          "1006687823",
          "1051689899",
          "1028726058",
          "1050593537",
          "1001278542",
          "1051403847",
          "1049308557",
          "1049459636",
          "1051033233",
          "1053531249",
          "1008551643",
          "1044980982",
          "9100147265",
          "5090106156",
          "1050419219",
          "2010697812",
          "1033186422",
          "1000671240",
          "1031632360",
          "1050448588",
          "1052342191",
          "1008676691",
          "1008954640",
          "1038359953",
          "1002362555",
          "1000191656",
          "5000740289",
          "1028536232",
          "1047946955",
          "1001478282",
          "1051771943",
          "2009563395",
          "1004740735",
          "1054779562",
          "1055535241",
          "1000220095",
          "2008207765",
          "1033016659",
          "5000524497"
        ]
      },
      {
        "group": "GF1",
        "lot": "5",
        "count": 389451,
        "accounts": [
          "1040327974",
          "1006301291",
          "1049905016",
          "1044948191",
          "1038057094",
          "1006068392",
          "1047278790",
          "1002975719",
          "1041523025",
          "1040518087",
          "1041520794",
          "1003195830",
          "1008268151",
          "1091016513",
          "1090595358",
          "1038792967",
          "1003094368",
          "1008798185",
          "1051707749",
          "1040421385",
          "1049343174",
          "1042253137",
          "1053679750",
          "5000061152",
          "1041425503",
          "1053797540",
          "1041206887",
          "5090136152",
          "2010403894",
          "1046135112",
          "1049176987",
          "1008329061",
          "1002108047",
          "1049079094",
          "1049721314",
          "1049426037",
          "1040289118",
          "1039409792",
          "1041815522",
          "1000485587",
          "1009101145",
          "1041978227",
          "1010325655",
          "1038811740",
          "1004351305",
          "1030770999",
          "1090334511",
          "1041407734",
          "1045586277",
          "2009762401",
          "1008468827",
          "1008694401",
          "1056509268",
          "1009004034",
          "1003320252",
          "1037888928",
          "1038192552",
          "1050706978",
          "1038928796",
          "1053452179",
          "1049991540",
          "1007507748",
          "1042316627",
          "1006545603",
          "1010168789",
          "2010442016",
          "1009078143",
          "1007880643",
          "2010402758",
          "1048429822",
          "1009514334",
          "1044641649",
          "1006354255",
          "1090371328",
          "1043510427",
          "1032485442",
          "1044845368",
          "1041018290",
          "1000220885",
          "1045470392",
          "1004644442",
          "2009322363",
          "1001792203",
          "1041651376",
          "1046034987",
          "5001403030",
          "1039634311",
          "1032148470",
          "1051152712",
          "1090353842",
          "1038418054",
          "1090972038",
          "1008463051",
          "1090395707",
          "1090577015",
          "1009163426",
          "1046566601",
          "1039981593",
          "1050736613",
          "1053662580"
        ]
      },
      {
        "group": "GF2",
        "lot": "1",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF2",
        "lot": "2",
        "count": 1,
        "accounts": [
          "1042888175"
        ]
      },
      {
        "group": "GF2",
        "lot": "3",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF2",
        "lot": "4",
        "count": 913,
        "accounts": [
          "1023759942",
          "1027799566",
          "1019931140",
          "1028279361",
          "1015683827",
          "1015661947",
          "1015578268",
          "1013907833",
          "1011746603",
          "1027004334",
          "1013773179",
          "1032073861",
          "1014743168",
          "1019468327",
          "1016584857",
          "1017678502",
          "1029911975",
          "1025509315",
          "1033357022",
          "1012835057",
          "1017694028",
          "1031584986",
          "1026614708",
          "1011641976",
          "1026427711",
          "1033458414",
          "1033480177",
          "1018529071",
          "1015946186",
          "1024688976",
          "1020733675",
          "1028528698",
          "1032161442",
          "1026844355",
          "1012670392",
          "1021057126",
          "1024198073",
          "1016377126",
          "1020491752",
          "1022830937",
          "1022701193",
          "1033119350",
          "1019323779",
          "1024627969",
          "1024836819",
          "1021952672",
          "1027453813",
          "1024944387",
          "1021814024",
          "1032954736",
          "1022306847",
          "1025029038",
          "1018606572",
          "1037269829",
          "1016087144",
          "1016041683",
          "1030845697",
          "1027423884",
          "1013682246",
          "1021649600",
          "1028478712",
          "1013881850",
          "1033796700",
          "1018687963",
          "1013124456",
          "1020753307",
          "1025377419",
          "1018762027",
          "1023983729",
          "1011596393",
          "1026433037",
          "1024087204",
          "1012582809",
          "1022185284",
          "1030941114",
          "1025840763",
          "1024236188",
          "1011353865",
          "1018261990",
          "1024300080",
          "1026220564",
          "1015395171",
          "1030550646",
          "1024629236",
          "1017444919",
          "1013924991",
          "1018322035",
          "1025469453",
          "1022125656",
          "1011802341",
          "1018083952",
          "1020738642",
          "1028547307",
          "1013091930",
          "1015739644",
          "1025514246",
          "1025974026",
          "1021217174",
          "1011453835",
          "1020245689"
        ]
      },
      {
        "group": "GF2",
        "lot": "5",
        "count": 116,
        "accounts": [
          "1015791875",
          "1024527905",
          "1016389620",
          "1017265615",
          "1022966588",
          "1029156182",
          "1025931491",
          "1012539989",
          "1025390288",
          "1025257758",
          "1020498528",
          "1021291323",
          "1019761830",
          "1032947543",
          "1020582774",
          "1025322967",
          "1028372019",
          "1028978413",
          "1018682155",
          "1023016990",
          "1028070438",
          "1022714724",
          "1018729569",
          "1030370168",
          "1024833194",
          "1025640802",
          "1031376143",
          "1019437480",
          "1029672652",
          "1016318995",
          "1029278717",
          "1022921266",
          "1014992893",
          "1026358221",
          "1020891912",
          "1028683502",
          "1015249515",
          "1022665103",
          "1022606387",
          "1011412772",
          "1031414657",
          "1020729767",
          "1020472308",
          "1028498594",
          "1032821264",
          "1025614852",
          "1017503362",
          "1016244320",
          "1019655259",
          "1021219967",
          "1025520211",
          "1019538600",
          "1025586778",
          "1025978463",
          "1020765933",
          "1026009839",
          "1014796970",
          "1026945356",
          "1022618156",
          "1029932360",
          "1019471093",
          "1026496306",
          "1022769359",
          "1012533034",
          "1020337516",
          "1020347341",
          "1029138141",
          "1021439630",
          "1013020634",
          "1023089599",
          "1027567215",
          "1025183983",
          "1014629616",
          "1022912445",
          "1033125318",
          "1019744278",
          "1030224366",
          "1014426375",
          "1029395349",
          "1036966143",
          "1018841644",
          "1021474134",
          "1022336959",
          "1017096031",
          "1020361239",
          "1027780768",
          "1011404044",
          "1019919949",
          "1030554994",
          "1037261054",
          "1027655025",
          "1013110188",
          "1028670354",
          "1029449155",
          "1020701757",
          "1035781042",
          "1027314449",
          "1020928735",
          "1021530859",
          "1029864993"
        ]
      },
      {
        "group": "GF3",
        "lot": "1",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF3",
        "lot": "2",
        "count": 3695,
        "accounts": [
          "2008174050",
          "2010422767",
          "2000362273",
          "2009234154",
          "2009607287",
          "2008871703",
          "2009804678",
          "2008535983",
          "2010816323",
          "2009946936",
          "2008979016",
          "2010843711",
          "2000325777",
          "2008868125",
          "2000108946",
          "2009619455",
          "2010599861",
          "2010800818",
          "1006176950",
          "2008976807",
          "2009424913",
          "2009862295",
          "1004816367",
          "2010591488",
          "2008962431",
          "2009751396",
          "1001224108",
          "2000071198",
          "2009773403",
          "2000141331",
          "2009222067",
          "2009603788",
          "2008908127",
          "1005962804",
          "2009040872",
          "1010791648",
          "2008869695",
          "2010611691",
          "2010448979",
          "2010633784",
          "2010609786",
          "2010619153",
          "2008991342",
          "2008977579",
          "2008178595",
          "2010592360",
          "2009234332",
          "2008568474",
          "2010594630",
          "2008876659",
          "2009424328",
          "2008624773",
          "2009934024",
          "2010596218",
          "2008965821",
          "2009603478",
          "2010177401",
          "2000066348",
          "1008199044",
          "2000126936",
          "2009184467",
          "2008959864",
          "1000741745",
          "2010598008",
          "2010167082",
          "2009658590",
          "2009605616",
          "2010565916",
          "2009753038",
          "2009843541",
          "2008702405",
          "2008969932",
          "2010730313",
          "1010530666",
          "2000222773",
          "2010598733",
          "2010012887",
          "2010130588",
          "2011010705",
          "2009132726",
          "2008746216",
          "2008809854",
          "2008556751",
          "2008704491",
          "2010405234",
          "2010611020",
          "2009956052",
          "2009234111",
          "2008423166",
          "2009215648",
          "2010858956",
          "1010357433",
          "2009446860",
          "2010600444",
          "2009901436",
          "1010702416",
          "2008985660",
          "2010888618",
          "2009591097",
          "2010611373"
        ]
      },
      {
        "group": "GF3",
        "lot": "3",
        "count": 42,
        "accounts": [
          "2000295274",
          "2000374123",
          "2000135471",
          "2000096107",
          "1040082572",
          "2007900815",
          "1000590445",
          "2000102018",
          "2000030750",
          "2000372791",
          "1001894561",
          "2000125905",
          "1004482434",
          "2000051944",
          "2000242626",
          "2000272967",
          "2007898926",
          "2000079148",
          "2000197159",
          "1010054708",
          "2000111920",
          "2000228313",
          "2000105750",
          "2000102077",
          "2000366112",
          "2000216625",
          "2000001580",
          "2000164048",
          "2000349226",
          "2000303285",
          "1000055566",
          "1040782191",
          "2000131654",
          "2000256465",
          "2000178030",
          "1040982581",
          "2000120334",
          "1008167797",
          "2000271103",
          "2000350038",
          "1000232301",
          "2000117406"
        ]
      },
      {
        "group": "GF3",
        "lot": "4",
        "count": 196935,
        "accounts": [
          "1015956564",
          "1016102976",
          "1033666688",
          "1025103165",
          "1012096564",
          "1022429884",
          "1022853694",
          "1030992967",
          "1006781536",
          "1038194989",
          "1018118985",
          "1036858375",
          "1011361450",
          "1001649400",
          "1005301166",
          "2008245470",
          "1007634561",
          "1011487268",
          "1029426538",
          "1033453897",
          "1002005922",
          "1017491127",
          "1021868558",
          "1024333825",
          "1029608504",
          "1022574523",
          "1007274239",
          "1022293540",
          "1039738338",
          "1024980308",
          "1024955532",
          "1021434752",
          "1027349811",
          "1004091605",
          "1029563462",
          "1018367780",
          "1003519881",
          "1001502914",
          "1010732153",
          "1029081492",
          "2000208347",
          "2009753755",
          "1006249486",
          "2010771117",
          "1003139094",
          "1038381517",
          "1019934328",
          "1004983247",
          "1002956595",
          "1018416951",
          "2010947940",
          "2009166450",
          "1007817259",
          "1021651982",
          "1037605756",
          "1015910882",
          "1039198821",
          "1028706812",
          "1023593785",
          "1016043708",
          "1004779291",
          "2010598024",
          "1026334918",
          "2010467191",
          "1040200109",
          "1000434400",
          "1012439879",
          "1029388504",
          "1001147014",
          "1010856847",
          "1012069966",
          "1013593782",
          "2008685233",
          "1000464679",
          "1021331791",
          "1031993835",
          "1040125964",
          "1015191487",
          "1051867320",
          "1013332849",
          "1022652958",
          "1014071674",
          "1030352828",
          "1037418581",
          "1006588272",
          "1042313539",
          "1018856609",
          "1034906283",
          "2010463730",
          "1014296412",
          "1004638612",
          "1002243548",
          "1001251636",
          "1014698006",
          "1016138466",
          "1000399435",
          "1032271892",
          "1006637346",
          "1001711270",
          "1012404765"
        ]
      },
      {
        "group": "GF3",
        "lot": "5",
        "count": 193017,
        "accounts": [
          "1031359702",
          "1017770255",
          "1032025484",
          "1006149260",
          "1003635857",
          "2000289657",
          "1030880751",
          "2008771458",
          "1008219967",
          "1003402011",
          "1002795052",
          "1031872485",
          "1026167337",
          "1005992436",
          "2009529901",
          "1030027986",
          "1013229258",
          "1017560730",
          "1038638763",
          "1031258361",
          "1005862125",
          "1036357961",
          "2009881397",
          "1034747215",
          "1018039392",
          "1024274179",
          "2010170172",
          "1001604628",
          "2009346521",
          "1020611286",
          "1036726770",
          "1012809773",
          "1033650870",
          "1005640327",
          "1009399497",
          "1033852279",
          "1017166501",
          "5000096045",
          "1036723097",
          "2008434486",
          "2000099645",
          "1031240306",
          "1001732448",
          "1002051711",
          "1000006514",
          "1007274697",
          "1024182169",
          "1030409609",
          "1006475478",
          "2010461401",
          "2009443713",
          "1014130980",
          "1036364909",
          "2008559971",
          "1026386306",
          "1017863814",
          "1006484795",
          "1000339912",
          "1031219560",
          "1026410347",
          "1027262139",
          "1027941435",
          "2000231845",
          "1003416837",
          "1032303220",
          "1015761844",
          "1026275296",
          "1033058874",
          "1038315093",
          "1010564668",
          "1019951540",
          "1027866956",
          "1032653523",
          "1036397904",
          "1030457719",
          "1020525029",
          "1033778826",
          "2008756173",
          "1014786339",
          "1002000467",
          "1002988411",
          "1021972088",
          "2009531590",
          "2000130992",
          "1000287661",
          "1033618144",
          "1021584347",
          "1004171307",
          "1006167390",
          "1031462309",
          "1034023624",
          "1007779802",
          "1021405531",
          "1026206561",
          "1028113595",
          "1018602267",
          "1002390117",
          "1008011517",
          "1020548967",
          "1035653494"
        ]
      },
      {
        "group": "GF4",
        "lot": "1",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF4",
        "lot": "2",
        "count": 4,
        "accounts": [
          "1007688149",
          "1008485055",
          "1010937820",
          "1007695935"
        ]
      },
      {
        "group": "GF4",
        "lot": "3",
        "count": 202061,
        "accounts": [
          "1012761940",
          "2010617932",
          "1019309962",
          "1001792408",
          "1041813619",
          "1030053391",
          "2010729129",
          "1035019663",
          "2010916964",
          "1007009721",
          "1009929267",
          "2007915383",
          "1010375776",
          "1008300128",
          "2000210767",
          "1035400758",
          "1027456073",
          "1011186047",
          "1036419495",
          "1001759141",
          "2008332853",
          "1036666689",
          "1010203835",
          "1024758621",
          "1000363856",
          "2009308417",
          "2010940709",
          "2009795253",
          "1018627545",
          "1033624357",
          "2009533801",
          "1013724836",
          "1022971336",
          "1009652265",
          "1038049326",
          "1030611173",
          "1015412971",
          "1010300253",
          "2008856089",
          "1012487679",
          "1033689300",
          "1017808759",
          "1024463591",
          "1007150076",
          "2008837424",
          "1000581977",
          "2008869164",
          "1036536149",
          "1016893930",
          "2010925653",
          "2008462706",
          "1000761711",
          "1024701158",
          "2008808807",
          "1009632817",
          "1034283073",
          "1023464721",
          "1028356331",
          "1034486381",
          "1015148182",
          "2010152379",
          "1015159982",
          "1014906148",
          "1032574399",
          "2008896595",
          "2009573587",
          "1007638702",
          "1023546086",
          "1007893281",
          "1008585599",
          "1031032894",
          "1013949889",
          "1034876651",
          "1025088743",
          "2010660196",
          "1007539151",
          "1034324799",
          "1010209450",
          "1041958935",
          "1005936072",
          "1031357947",
          "1008608475",
          "1011109751",
          "1021029726",
          "1035668165",
          "1040390269",
          "1019198281",
          "1031328424",
          "1018940189",
          "1000310493",
          "1007823860",
          "2007858312",
          "1007902191",
          "1035569337",
          "1016420234",
          "1031582134",
          "1013713915",
          "1034557327",
          "1008487260",
          "2008748405"
        ]
      },
      {
        "group": "GF4",
        "lot": "4",
        "count": 260285,
        "accounts": [
          "1025546709",
          "1014265274",
          "1033531235",
          "1017843767",
          "1015273408",
          "1026828082",
          "1031017631",
          "1029605505",
          "1035054760",
          "1026148200",
          "1023022400",
          "1030111197",
          "1013725301",
          "1025175697",
          "1015757472",
          "1027620892",
          "1016696019",
          "1036852784",
          "1034581104",
          "1023131366",
          "1019520280",
          "1012265676",
          "1021356417",
          "1026046173",
          "1012526240",
          "1021408506",
          "1016035837",
          "1019893648",
          "1023961903",
          "1020857323",
          "1036775038",
          "1018933646",
          "1018988246",
          "1017372551",
          "1025319699",
          "1014558468",
          "1013332644",
          "1029140693",
          "1028823762",
          "1024299430",
          "1012272079",
          "1037011848",
          "1021892408",
          "1027219462",
          "1015846920",
          "1018300570",
          "1022771647",
          "1014482313",
          "1012443167",
          "1025744780",
          "1031259082",
          "1027779573",
          "1025346807",
          "1011858053",
          "1019901470",
          "1031299483",
          "1031095101",
          "1014478200",
          "1017261865",
          "1017192359",
          "1024571572",
          "1021544876",
          "1024872580",
          "1029624607",
          "1022975609",
          "1027135323",
          "1025304519",
          "1027958257",
          "1012217698",
          "1011918250",
          "1021764663",
          "1024075532",
          "1015544061",
          "1035641399",
          "1012937046",
          "1019654074",
          "1016668929",
          "1015661645",
          "1025253752",
          "1019023651",
          "1021180823",
          "1028149743",
          "1032861754",
          "1025716175",
          "1025394194",
          "1027954774",
          "1036779122",
          "1021565784",
          "1012836576",
          "1022863509",
          "1019590955",
          "1018263152",
          "1023018632",
          "1013127226",
          "1016504918",
          "1018262806",
          "1034113569",
          "1033974382",
          "1030799385",
          "1024431053"
        ]
      },
      {
        "group": "GF4",
        "lot": "5",
        "count": 49739,
        "accounts": [
          "1026309557",
          "1024015556",
          "1031216464",
          "1022125079",
          "1016039077",
          "1012703525",
          "1012089886",
          "1030796149",
          "1027658164",
          "1031671625",
          "1029948445",
          "1028740085",
          "1012265544",
          "1011986620",
          "1028552262",
          "1026813158",
          "1023848082",
          "1024360539",
          "1027105777",
          "1019413956",
          "1025471679",
          "1029187797",
          "1018808809",
          "1012006085",
          "1023059010",
          "1022797875",
          "1025513304",
          "1031421505",
          "1032720964",
          "1017039208",
          "1023809222",
          "1028222912",
          "1025176863",
          "1019240989",
          "1033062707",
          "1032532491",
          "1021097039",
          "1030533865",
          "1034319523",
          "1018344195",
          "1031694757",
          "1011672472",
          "1021569593",
          "1031614273",
          "1036030644",
          "1026225175",
          "1020750766",
          "1033754897",
          "1021506648",
          "1027344003",
          "1013519809",
          "1016203950",
          "1032278420",
          "1028239572",
          "1023783460",
          "1034726277",
          "1029536120",
          "1032661364",
          "1026725712",
          "1033088161",
          "1027593119",
          "1011635569",
          "1023265931",
          "1029235872",
          "1024840417",
          "1033757829",
          "1032842547",
          "1026569443",
          "1033008737",
          "1031065318",
          "1025817516",
          "1016233418",
          "1017663580",
          "1031376410",
          "1032173904",
          "1034242008",
          "1015211380",
          "1029097356",
          "1032808438",
          "1015750508",
          "1017903263",
          "1015910815",
          "1034626078",
          "1015724752",
          "1020543434",
          "1024895289",
          "1026396417",
          "1032386622",
          "1027342892",
          "1037076737",
          "1022347829",
          "1022083872",
          "1031780122",
          "1034059262",
          "1030931828",
          "1034333895",
          "1016016808",
          "1028264712",
          "1012051773",
          "1023680521"
        ]
      }
    ]
  },
  "lot_flag_matrix": {
    "lots": [
      "1",
      "2",
      "3",
      "4",
      "5"
    ],
    "flags": [
      1,
      2,
      3,
      4
    ],
    "matrix": [
      {
        "lot": "1",
        "flag": 1,
        "count": 519938,
        "accounts": [
          "1038366852",
          "1048087379",
          "1049209893",
          "5002246060",
          "1048576620",
          "9100220566",
          "1090973166",
          "1042651116",
          "1043588639",
          "5001550254",
          "1054768803",
          "1040417507",
          "1042904871",
          "1050804902",
          "1044072180",
          "1090942821",
          "5001439930",
          "1052684815",
          "1038636094",
          "1042915237",
          "1053832133",
          "1042927626",
          "1053747624",
          "1041529384",
          "1050847156",
          "1047818833",
          "1043144099",
          "1090377113",
          "1038995760",
          "2008369943",
          "1010232126",
          "9100062173",
          "1045679089",
          "1049982363",
          "1051819067",
          "1090119742",
          "1046044680",
          "1047747189",
          "1091503392",
          "1010494538",
          "1091301579",
          "9100249522",
          "1090692914",
          "1048895122",
          "9100092777",
          "2008735427",
          "1037350480",
          "5001251486",
          "1048310116",
          "1049004191",
          "1037869060",
          "1008711802",
          "1041498829",
          "1040042155",
          "9100068659",
          "5001554527",
          "1009900129",
          "2009093542",
          "1054244294",
          "1047776057",
          "1052911455",
          "1039373151",
          "1048697339",
          "1053569467",
          "1042855293",
          "1008125792",
          "1044157186",
          "1054036780",
          "1053470592",
          "1091420497",
          "1049249933",
          "1048580539",
          "1040971393",
          "1055693157",
          "1039739369",
          "1041977913",
          "2010462300",
          "1045180459",
          "1039397441",
          "1008028274",
          "1050030869",
          "1043178449",
          "1054434573",
          "1042176248",
          "1042025657",
          "1009152424",
          "1050538943",
          "1055493964",
          "1048866157",
          "1045099147",
          "1040624723",
          "9100067745",
          "1053975627",
          "1039317766",
          "5001446457",
          "2009673689",
          "1044522259",
          "1039868924",
          "1053591624",
          "1043187383"
        ]
      },
      {
        "lot": "1",
        "flag": 2,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "1",
        "flag": 3,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "1",
        "flag": 4,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "2",
        "flag": 1,
        "count": 424963,
        "accounts": [
          "1041474814",
          "1048693546",
          "5090038002",
          "1046543806",
          "9100166280",
          "9100053060",
          "1044527684",
          "9100067504",
          "1090551881",
          "1051150981",
          "5000228820",
          "1049871375",
          "1045056022",
          "1049460596",
          "1042564353",
          "1042342423",
          "1051469570",
          "9100121974",
          "1042492697",
          "1042332584",
          "1011127946",
          "1091246349",
          "1046417797",
          "9100157678",
          "1045003352",
          "1042460116",
          "1000885445",
          "1045955620",
          "1041689462",
          "9100158914",
          "1054325030",
          "1040422039",
          "1051653118",
          "1053118465",
          "1052468330",
          "1010547682",
          "9100272588",
          "1005223297",
          "1002974941",
          "1006734880",
          "1090767264",
          "9100179234",
          "1041369379",
          "1055104224",
          "1050335341",
          "1054518440",
          "1055110178",
          "9190080473",
          "1005654298",
          "2010724941",
          "1051168562",
          "1050696751",
          "1044831081",
          "1090802752",
          "1050153340",
          "2000346162",
          "1009102133",
          "1044557087",
          "5000006348",
          "1042914656",
          "1044031808",
          "1091275500",
          "5000389417",
          "1054113831",
          "1039761003",
          "1054680957",
          "1090837408",
          "1041719426",
          "1052354580",
          "1010831232",
          "1054645787",
          "1010484435",
          "2010279859",
          "5002081908",
          "1091257251",
          "9100040542",
          "9100273496",
          "9100254904",
          "1039740073",
          "1002703956",
          "1002948088",
          "1005393257",
          "1046224891",
          "1039733026",
          "1044336617",
          "1090274063",
          "1037483413",
          "1054332959",
          "1009961276",
          "5001203740",
          "1005253250",
          "9100210866",
          "9100083495",
          "1040426158",
          "9100219434",
          "1008649848",
          "1038382440",
          "9100304883",
          "1041655681",
          "1056449357"
        ]
      },
      {
        "lot": "2",
        "flag": 2,
        "count": 1,
        "accounts": [
          "1042888175"
        ]
      },
      {
        "lot": "2",
        "flag": 3,
        "count": 3695,
        "accounts": [
          "2008174050",
          "2010422767",
          "2000362273",
          "2009234154",
          "2009607287",
          "2008871703",
          "2009804678",
          "2008535983",
          "2010816323",
          "2009946936",
          "2008979016",
          "2010843711",
          "2000325777",
          "2008868125",
          "2000108946",
          "2009619455",
          "2010599861",
          "2010800818",
          "1006176950",
          "2008976807",
          "2009424913",
          "2009862295",
          "1004816367",
          "2010591488",
          "2008962431",
          "2009751396",
          "1001224108",
          "2000071198",
          "2009773403",
          "2000141331",
          "2009222067",
          "2009603788",
          "2008908127",
          "1005962804",
          "2009040872",
          "1010791648",
          "2008869695",
          "2010611691",
          "2010448979",
          "2010633784",
          "2010609786",
          "2010619153",
          "2008991342",
          "2008977579",
          "2008178595",
          "2010592360",
          "2009234332",
          "2008568474",
          "2010594630",
          "2008876659",
          "2009424328",
          "2008624773",
          "2009934024",
          "2010596218",
          "2008965821",
          "2009603478",
          "2010177401",
          "2000066348",
          "1008199044",
          "2000126936",
          "2009184467",
          "2008959864",
          "1000741745",
          "2010598008",
          "2010167082",
          "2009658590",
          "2009605616",
          "2010565916",
          "2009753038",
          "2009843541",
          "2008702405",
          "2008969932",
          "2010730313",
          "1010530666",
          "2000222773",
          "2010598733",
          "2010012887",
          "2010130588",
          "2011010705",
          "2009132726",
          "2008746216",
          "2008809854",
          "2008556751",
          "2008704491",
          "2010405234",
          "2010611020",
          "2009956052",
          "2009234111",
          "2008423166",
          "2009215648",
          "2010858956",
          "1010357433",
          "2009446860",
          "2010600444",
          "2009901436",
          "1010702416",
          "2008985660",
          "2010888618",
          "2009591097",
          "2010611373"
        ]
      },
      {
        "lot": "2",
        "flag": 4,
        "count": 4,
        "accounts": [
          "1007688149",
          "1008485055",
          "1010937820",
          "1007695935"
        ]
      },
      {
        "lot": "3",
        "flag": 1,
        "count": 572364,
        "accounts": [
          "1091221087",
          "1038220289",
          "5000464591",
          "1040741991",
          "1039690416",
          "1044537922",
          "1042697671",
          "5001754909",
          "1041836090",
          "1048625761",
          "1045860603",
          "1045150711",
          "1044325224",
          "1055133143",
          "1048463923",
          "1053542488",
          "1000229149",
          "1008062391",
          "1050312392",
          "1044846178",
          "1010666142",
          "1050695909",
          "1043566295",
          "1055034285",
          "1041431295",
          "1046346555",
          "1008720577",
          "1042477965",
          "1042562318",
          "1040271065",
          "1008209503",
          "1009327534",
          "1050301412",
          "9200002578",
          "1044617160",
          "1054439699",
          "1049450507",
          "5001781639",
          "1004895070",
          "1045053554",
          "1009129058",
          "1038661803",
          "5001694086",
          "1010871587",
          "1046277472",
          "1009014846",
          "1051371376",
          "1042233357",
          "1048475220",
          "1047130068",
          "1040146422",
          "1046190318",
          "1046730053",
          "9200037954",
          "1050483367",
          "1090138968",
          "5000535995",
          "1000041255",
          "5000747844",
          "1009295896",
          "1045098426",
          "1056495597",
          "1042010145",
          "1010470590",
          "1009669818",
          "1044842083",
          "1009904221",
          "1049588738",
          "1010026038",
          "1004508336",
          "1044367881",
          "1011023474",
          "1046789538",
          "1047430274",
          "1053449429",
          "1009754181",
          "2000259669",
          "1048582612",
          "1005297460",
          "1040022456",
          "1047104334",
          "1044278943",
          "1049803159",
          "1044079975",
          "1051241391",
          "1041586833",
          "1091036514",
          "1051713390",
          "1051450454",
          "1045115495",
          "5001919991",
          "9100033373",
          "1039197515",
          "1038578035",
          "1045671053",
          "1039485375",
          "1042986266",
          "1009419226",
          "1055245618",
          "5001511429"
        ]
      },
      {
        "lot": "3",
        "flag": 2,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "3",
        "flag": 3,
        "count": 42,
        "accounts": [
          "2000295274",
          "2000374123",
          "2000135471",
          "2000096107",
          "1040082572",
          "2007900815",
          "1000590445",
          "2000102018",
          "2000030750",
          "2000372791",
          "1001894561",
          "2000125905",
          "1004482434",
          "2000051944",
          "2000242626",
          "2000272967",
          "2007898926",
          "2000079148",
          "2000197159",
          "1010054708",
          "2000111920",
          "2000228313",
          "2000105750",
          "2000102077",
          "2000366112",
          "2000216625",
          "2000001580",
          "2000164048",
          "2000349226",
          "2000303285",
          "1000055566",
          "1040782191",
          "2000131654",
          "2000256465",
          "2000178030",
          "1040982581",
          "2000120334",
          "1008167797",
          "2000271103",
          "2000350038",
          "1000232301",
          "2000117406"
        ]
      },
      {
        "lot": "3",
        "flag": 4,
        "count": 202061,
        "accounts": [
          "1012761940",
          "2010617932",
          "1019309962",
          "1001792408",
          "1041813619",
          "1030053391",
          "2010729129",
          "1035019663",
          "2010916964",
          "1007009721",
          "1009929267",
          "2007915383",
          "1010375776",
          "1008300128",
          "2000210767",
          "1035400758",
          "1027456073",
          "1011186047",
          "1036419495",
          "1001759141",
          "2008332853",
          "1036666689",
          "1010203835",
          "1024758621",
          "1000363856",
          "2009308417",
          "2010940709",
          "2009795253",
          "1018627545",
          "1033624357",
          "2009533801",
          "1013724836",
          "1022971336",
          "1009652265",
          "1038049326",
          "1030611173",
          "1015412971",
          "1010300253",
          "2008856089",
          "1012487679",
          "1033689300",
          "1017808759",
          "1024463591",
          "1007150076",
          "2008837424",
          "1000581977",
          "2008869164",
          "1036536149",
          "1016893930",
          "2010925653",
          "2008462706",
          "1000761711",
          "1024701158",
          "2008808807",
          "1009632817",
          "1034283073",
          "1023464721",
          "1028356331",
          "1034486381",
          "1015148182",
          "2010152379",
          "1015159982",
          "1014906148",
          "1032574399",
          "2008896595",
          "2009573587",
          "1007638702",
          "1023546086",
          "1007893281",
          "1008585599",
          "1031032894",
          "1013949889",
          "1034876651",
          "1025088743",
          "2010660196",
          "1007539151",
          "1034324799",
          "1010209450",
          "1041958935",
          "1005936072",
          "1031357947",
          "1008608475",
          "1011109751",
          "1021029726",
          "1035668165",
          "1040390269",
          "1019198281",
          "1031328424",
          "1018940189",
          "1000310493",
          "1007823860",
          "2007858312",
          "1007902191",
          "1035569337",
          "1016420234",
          "1031582134",
          "1013713915",
          "1034557327",
          "1008487260",
          "2008748405"
        ]
      },
      {
        "lot": "4",
        "flag": 1,
        "count": 681485,
        "accounts": [
          "1055073477",
          "1006750355",
          "1007685786",
          "1047512599",
          "5001681650",
          "1005371350",
          "1002856272",
          "1003109039",
          "1003932568",
          "1009687069",
          "1000010163",
          "1002286425",
          "1006615903",
          "1001061969",
          "1012721140",
          "1032001534",
          "1038276233",
          "2010258754",
          "1036448932",
          "5000651634",
          "1030661162",
          "1026830850",
          "1048255115",
          "1090069109",
          "1005208298",
          "9100007950",
          "1030356661",
          "1000363376",
          "1027920594",
          "1035280469",
          "1010380532",
          "5001631505",
          "5001599261",
          "1051624584",
          "1006403949",
          "1037619706",
          "1033479764",
          "5001672228",
          "1049228790",
          "1052774504",
          "1035430452",
          "1024976335",
          "1009707337",
          "1091252209",
          "1055092439",
          "1006872779",
          "1006074651",
          "1034422987",
          "1021672521",
          "1007699450",
          "1035370190",
          "1001595505",
          "2009982223",
          "1003672086",
          "1050825152",
          "1046617966",
          "1008920916",
          "1003183638",
          "1010321765",
          "1027103391",
          "1003483631",
          "1006687823",
          "1051689899",
          "1028726058",
          "1050593537",
          "1001278542",
          "1051403847",
          "1049308557",
          "1049459636",
          "1051033233",
          "1053531249",
          "1008551643",
          "1044980982",
          "9100147265",
          "5090106156",
          "1050419219",
          "2010697812",
          "1033186422",
          "1000671240",
          "1031632360",
          "1050448588",
          "1052342191",
          "1008676691",
          "1008954640",
          "1038359953",
          "1002362555",
          "1000191656",
          "5000740289",
          "1028536232",
          "1047946955",
          "1001478282",
          "1051771943",
          "2009563395",
          "1004740735",
          "1054779562",
          "1055535241",
          "1000220095",
          "2008207765",
          "1033016659",
          "5000524497"
        ]
      },
      {
        "lot": "4",
        "flag": 2,
        "count": 913,
        "accounts": [
          "1023759942",
          "1027799566",
          "1019931140",
          "1028279361",
          "1015683827",
          "1015661947",
          "1015578268",
          "1013907833",
          "1011746603",
          "1027004334",
          "1013773179",
          "1032073861",
          "1014743168",
          "1019468327",
          "1016584857",
          "1017678502",
          "1029911975",
          "1025509315",
          "1033357022",
          "1012835057",
          "1017694028",
          "1031584986",
          "1026614708",
          "1011641976",
          "1026427711",
          "1033458414",
          "1033480177",
          "1018529071",
          "1015946186",
          "1024688976",
          "1020733675",
          "1028528698",
          "1032161442",
          "1026844355",
          "1012670392",
          "1021057126",
          "1024198073",
          "1016377126",
          "1020491752",
          "1022830937",
          "1022701193",
          "1033119350",
          "1019323779",
          "1024627969",
          "1024836819",
          "1021952672",
          "1027453813",
          "1024944387",
          "1021814024",
          "1032954736",
          "1022306847",
          "1025029038",
          "1018606572",
          "1037269829",
          "1016087144",
          "1016041683",
          "1030845697",
          "1027423884",
          "1013682246",
          "1021649600",
          "1028478712",
          "1013881850",
          "1033796700",
          "1018687963",
          "1013124456",
          "1020753307",
          "1025377419",
          "1018762027",
          "1023983729",
          "1011596393",
          "1026433037",
          "1024087204",
          "1012582809",
          "1022185284",
          "1030941114",
          "1025840763",
          "1024236188",
          "1011353865",
          "1018261990",
          "1024300080",
          "1026220564",
          "1015395171",
          "1030550646",
          "1024629236",
          "1017444919",
          "1013924991",
          "1018322035",
          "1025469453",
          "1022125656",
          "1011802341",
          "1018083952",
          "1020738642",
          "1028547307",
          "1013091930",
          "1015739644",
          "1025514246",
          "1025974026",
          "1021217174",
          "1011453835",
          "1020245689"
        ]
      },
      {
        "lot": "4",
        "flag": 3,
        "count": 196935,
        "accounts": [
          "1015956564",
          "1016102976",
          "1033666688",
          "1025103165",
          "1012096564",
          "1022429884",
          "1022853694",
          "1030992967",
          "1006781536",
          "1038194989",
          "1018118985",
          "1036858375",
          "1011361450",
          "1001649400",
          "1005301166",
          "2008245470",
          "1007634561",
          "1011487268",
          "1029426538",
          "1033453897",
          "1002005922",
          "1017491127",
          "1021868558",
          "1024333825",
          "1029608504",
          "1022574523",
          "1007274239",
          "1022293540",
          "1039738338",
          "1024980308",
          "1024955532",
          "1021434752",
          "1027349811",
          "1004091605",
          "1029563462",
          "1018367780",
          "1003519881",
          "1001502914",
          "1010732153",
          "1029081492",
          "2000208347",
          "2009753755",
          "1006249486",
          "2010771117",
          "1003139094",
          "1038381517",
          "1019934328",
          "1004983247",
          "1002956595",
          "1018416951",
          "2010947940",
          "2009166450",
          "1007817259",
          "1021651982",
          "1037605756",
          "1015910882",
          "1039198821",
          "1028706812",
          "1023593785",
          "1016043708",
          "1004779291",
          "2010598024",
          "1026334918",
          "2010467191",
          "1040200109",
          "1000434400",
          "1012439879",
          "1029388504",
          "1001147014",
          "1010856847",
          "1012069966",
          "1013593782",
          "2008685233",
          "1000464679",
          "1021331791",
          "1031993835",
          "1040125964",
          "1015191487",
          "1051867320",
          "1013332849",
          "1022652958",
          "1014071674",
          "1030352828",
          "1037418581",
          "1006588272",
          "1042313539",
          "1018856609",
          "1034906283",
          "2010463730",
          "1014296412",
          "1004638612",
          "1002243548",
          "1001251636",
          "1014698006",
          "1016138466",
          "1000399435",
          "1032271892",
          "1006637346",
          "1001711270",
          "1012404765"
        ]
      },
      {
        "lot": "4",
        "flag": 4,
        "count": 260285,
        "accounts": [
          "1025546709",
          "1014265274",
          "1033531235",
          "1017843767",
          "1015273408",
          "1026828082",
          "1031017631",
          "1029605505",
          "1035054760",
          "1026148200",
          "1023022400",
          "1030111197",
          "1013725301",
          "1025175697",
          "1015757472",
          "1027620892",
          "1016696019",
          "1036852784",
          "1034581104",
          "1023131366",
          "1019520280",
          "1012265676",
          "1021356417",
          "1026046173",
          "1012526240",
          "1021408506",
          "1016035837",
          "1019893648",
          "1023961903",
          "1020857323",
          "1036775038",
          "1018933646",
          "1018988246",
          "1017372551",
          "1025319699",
          "1014558468",
          "1013332644",
          "1029140693",
          "1028823762",
          "1024299430",
          "1012272079",
          "1037011848",
          "1021892408",
          "1027219462",
          "1015846920",
          "1018300570",
          "1022771647",
          "1014482313",
          "1012443167",
          "1025744780",
          "1031259082",
          "1027779573",
          "1025346807",
          "1011858053",
          "1019901470",
          "1031299483",
          "1031095101",
          "1014478200",
          "1017261865",
          "1017192359",
          "1024571572",
          "1021544876",
          "1024872580",
          "1029624607",
          "1022975609",
          "1027135323",
          "1025304519",
          "1027958257",
          "1012217698",
          "1011918250",
          "1021764663",
          "1024075532",
          "1015544061",
          "1035641399",
          "1012937046",
          "1019654074",
          "1016668929",
          "1015661645",
          "1025253752",
          "1019023651",
          "1021180823",
          "1028149743",
          "1032861754",
          "1025716175",
          "1025394194",
          "1027954774",
          "1036779122",
          "1021565784",
          "1012836576",
          "1022863509",
          "1019590955",
          "1018263152",
          "1023018632",
          "1013127226",
          "1016504918",
          "1018262806",
          "1034113569",
          "1033974382",
          "1030799385",
          "1024431053"
        ]
      },
      {
        "lot": "5",
        "flag": 1,
        "count": 389451,
        "accounts": [
          "1040327974",
          "1006301291",
          "1049905016",
          "1044948191",
          "1038057094",
          "1006068392",
          "1047278790",
          "1002975719",
          "1041523025",
          "1040518087",
          "1041520794",
          "1003195830",
          "1008268151",
          "1091016513",
          "1090595358",
          "1038792967",
          "1003094368",
          "1008798185",
          "1051707749",
          "1040421385",
          "1049343174",
          "1042253137",
          "1053679750",
          "5000061152",
          "1041425503",
          "1053797540",
          "1041206887",
          "5090136152",
          "2010403894",
          "1046135112",
          "1049176987",
          "1008329061",
          "1002108047",
          "1049079094",
          "1049721314",
          "1049426037",
          "1040289118",
          "1039409792",
          "1041815522",
          "1000485587",
          "1009101145",
          "1041978227",
          "1010325655",
          "1038811740",
          "1004351305",
          "1030770999",
          "1090334511",
          "1041407734",
          "1045586277",
          "2009762401",
          "1008468827",
          "1008694401",
          "1056509268",
          "1009004034",
          "1003320252",
          "1037888928",
          "1038192552",
          "1050706978",
          "1038928796",
          "1053452179",
          "1049991540",
          "1007507748",
          "1042316627",
          "1006545603",
          "1010168789",
          "2010442016",
          "1009078143",
          "1007880643",
          "2010402758",
          "1048429822",
          "1009514334",
          "1044641649",
          "1006354255",
          "1090371328",
          "1043510427",
          "1032485442",
          "1044845368",
          "1041018290",
          "1000220885",
          "1045470392",
          "1004644442",
          "2009322363",
          "1001792203",
          "1041651376",
          "1046034987",
          "5001403030",
          "1039634311",
          "1032148470",
          "1051152712",
          "1090353842",
          "1038418054",
          "1090972038",
          "1008463051",
          "1090395707",
          "1090577015",
          "1009163426",
          "1046566601",
          "1039981593",
          "1050736613",
          "1053662580"
        ]
      },
      {
        "lot": "5",
        "flag": 2,
        "count": 116,
        "accounts": [
          "1015791875",
          "1024527905",
          "1016389620",
          "1017265615",
          "1022966588",
          "1029156182",
          "1025931491",
          "1012539989",
          "1025390288",
          "1025257758",
          "1020498528",
          "1021291323",
          "1019761830",
          "1032947543",
          "1020582774",
          "1025322967",
          "1028372019",
          "1028978413",
          "1018682155",
          "1023016990",
          "1028070438",
          "1022714724",
          "1018729569",
          "1030370168",
          "1024833194",
          "1025640802",
          "1031376143",
          "1019437480",
          "1029672652",
          "1016318995",
          "1029278717",
          "1022921266",
          "1014992893",
          "1026358221",
          "1020891912",
          "1028683502",
          "1015249515",
          "1022665103",
          "1022606387",
          "1011412772",
          "1031414657",
          "1020729767",
          "1020472308",
          "1028498594",
          "1032821264",
          "1025614852",
          "1017503362",
          "1016244320",
          "1019655259",
          "1021219967",
          "1025520211",
          "1019538600",
          "1025586778",
          "1025978463",
          "1020765933",
          "1026009839",
          "1014796970",
          "1026945356",
          "1022618156",
          "1029932360",
          "1019471093",
          "1026496306",
          "1022769359",
          "1012533034",
          "1020337516",
          "1020347341",
          "1029138141",
          "1021439630",
          "1013020634",
          "1023089599",
          "1027567215",
          "1025183983",
          "1014629616",
          "1022912445",
          "1033125318",
          "1019744278",
          "1030224366",
          "1014426375",
          "1029395349",
          "1036966143",
          "1018841644",
          "1021474134",
          "1022336959",
          "1017096031",
          "1020361239",
          "1027780768",
          "1011404044",
          "1019919949",
          "1030554994",
          "1037261054",
          "1027655025",
          "1013110188",
          "1028670354",
          "1029449155",
          "1020701757",
          "1035781042",
          "1027314449",
          "1020928735",
          "1021530859",
          "1029864993"
        ]
      },
      {
        "lot": "5",
        "flag": 3,
        "count": 193017,
        "accounts": [
          "1031359702",
          "1017770255",
          "1032025484",
          "1006149260",
          "1003635857",
          "2000289657",
          "1030880751",
          "2008771458",
          "1008219967",
          "1003402011",
          "1002795052",
          "1031872485",
          "1026167337",
          "1005992436",
          "2009529901",
          "1030027986",
          "1013229258",
          "1017560730",
          "1038638763",
          "1031258361",
          "1005862125",
          "1036357961",
          "2009881397",
          "1034747215",
          "1018039392",
          "1024274179",
          "2010170172",
          "1001604628",
          "2009346521",
          "1020611286",
          "1036726770",
          "1012809773",
          "1033650870",
          "1005640327",
          "1009399497",
          "1033852279",
          "1017166501",
          "5000096045",
          "1036723097",
          "2008434486",
          "2000099645",
          "1031240306",
          "1001732448",
          "1002051711",
          "1000006514",
          "1007274697",
          "1024182169",
          "1030409609",
          "1006475478",
          "2010461401",
          "2009443713",
          "1014130980",
          "1036364909",
          "2008559971",
          "1026386306",
          "1017863814",
          "1006484795",
          "1000339912",
          "1031219560",
          "1026410347",
          "1027262139",
          "1027941435",
          "2000231845",
          "1003416837",
          "1032303220",
          "1015761844",
          "1026275296",
          "1033058874",
          "1038315093",
          "1010564668",
          "1019951540",
          "1027866956",
          "1032653523",
          "1036397904",
          "1030457719",
          "1020525029",
          "1033778826",
          "2008756173",
          "1014786339",
          "1002000467",
          "1002988411",
          "1021972088",
          "2009531590",
          "2000130992",
          "1000287661",
          "1033618144",
          "1021584347",
          "1004171307",
          "1006167390",
          "1031462309",
          "1034023624",
          "1007779802",
          "1021405531",
          "1026206561",
          "1028113595",
          "1018602267",
          "1002390117",
          "1008011517",
          "1020548967",
          "1035653494"
        ]
      },
      {
        "lot": "5",
        "flag": 4,
        "count": 49739,
        "accounts": [
          "1026309557",
          "1024015556",
          "1031216464",
          "1022125079",
          "1016039077",
          "1012703525",
          "1012089886",
          "1030796149",
          "1027658164",
          "1031671625",
          "1029948445",
          "1028740085",
          "1012265544",
          "1011986620",
          "1028552262",
          "1026813158",
          "1023848082",
          "1024360539",
          "1027105777",
          "1019413956",
          "1025471679",
          "1029187797",
          "1018808809",
          "1012006085",
          "1023059010",
          "1022797875",
          "1025513304",
          "1031421505",
          "1032720964",
          "1017039208",
          "1023809222",
          "1028222912",
          "1025176863",
          "1019240989",
          "1033062707",
          "1032532491",
          "1021097039",
          "1030533865",
          "1034319523",
          "1018344195",
          "1031694757",
          "1011672472",
          "1021569593",
          "1031614273",
          "1036030644",
          "1026225175",
          "1020750766",
          "1033754897",
          "1021506648",
          "1027344003",
          "1013519809",
          "1016203950",
          "1032278420",
          "1028239572",
          "1023783460",
          "1034726277",
          "1029536120",
          "1032661364",
          "1026725712",
          "1033088161",
          "1027593119",
          "1011635569",
          "1023265931",
          "1029235872",
          "1024840417",
          "1033757829",
          "1032842547",
          "1026569443",
          "1033008737",
          "1031065318",
          "1025817516",
          "1016233418",
          "1017663580",
          "1031376410",
          "1032173904",
          "1034242008",
          "1015211380",
          "1029097356",
          "1032808438",
          "1015750508",
          "1017903263",
          "1015910815",
          "1034626078",
          "1015724752",
          "1020543434",
          "1024895289",
          "1026396417",
          "1032386622",
          "1027342892",
          "1037076737",
          "1022347829",
          "1022083872",
          "1031780122",
          "1034059262",
          "1030931828",
          "1034333895",
          "1016016808",
          "1028264712",
          "1012051773",
          "1023680521"
        ]
      }
    ]
  },
  "metadata": {
    "generated_at": "2025-10-02T05:24:42.032796",
    "total_accounts": 3495009,
    "total_groups": 4,
    "total_lots": 5,
    "lot5_consolidated": true,
    "has_group_flags": true
  }
};
        
        let currentColorScheme = 'pantone';
        let cellSizeValue = 50;
        let svg1 = null;
        let svg2 = null;
        
        const colorSchemes = {
            pantone: {
                scale: d3.scaleSequential()
                    .interpolator(d3.interpolateRgbBasis([
                        '#0F4C81',
                        '#6667AB',
                        '#BB2649',
                        '#FFBE98',
                        '#F5DF4D'
                    ]))
            },
            heat: {
                scale: d3.scaleSequential(d3.interpolateInferno)
            },
            cool: {
                scale: d3.scaleSequential(d3.interpolateBlues)
            },
            vibrant: {
                scale: d3.scaleSequential(d3.interpolateRainbow)
            }
        };
        
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        function switchTab(event, tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-content').classList.add('active');
        }
        
        function initializeGroupLotMatrix() {
            const data = VISUALIZATION_DATA.group_lot_matrix;
            document.getElementById('matrix-viz-1').innerHTML = '';
            
            const margin = {top: 120, right: 50, bottom: 50, left: 150};
            const cellSize = cellSizeValue;
            const width = Math.max(800, data.groups.length * cellSize + margin.left + margin.right);
            const height = Math.max(600, data.lots.length * cellSize + margin.top + margin.bottom);
            
            svg1 = d3.select('#matrix-viz-1')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMinYMin meet');
            
            const xScale = d3.scaleBand()
                .domain(data.groups)
                .range([margin.left, width - margin.right])
                .padding(0.1);
            
            const yScale = d3.scaleBand()
                .domain(data.lots)
                .range([margin.top, height - margin.bottom])
                .padding(0.1);
            
            drawMatrix(svg1, data.matrix, xScale, yScale, 'group', 'lot', false);
            drawAxes(svg1, data.groups, data.lots, xScale, yScale, 'GROUPS →', 'LOTS ↓', margin);
        }
        
        function initializeLotFlagMatrix() {
            const data = VISUALIZATION_DATA.lot_flag_matrix;
            document.getElementById('matrix-viz-2').innerHTML = '';
            
            // Calculate totals
            const lotTotals = {};
            const flagTotals = {1: 0, 2: 0, 3: 0, 4: 0};
            let grandTotal = 0;
            
            data.matrix.forEach(d => {
                if (!lotTotals[d.lot]) lotTotals[d.lot] = 0;
                lotTotals[d.lot] += d.count;
                flagTotals[d.flag] += d.count;
                grandTotal += d.count;
            });
            
            const margin = {top: 120, right: 150, bottom: 80, left: 150};
            const cellSize = cellSizeValue;
            const flagLabels = data.flags.map(f => 'FLAG_' + f);
            const lotsWithTotal = [...data.lots, 'TOTAL'];
            const flagsWithTotal = [...flagLabels, 'TOTAL'];
            
            const width = Math.max(800, flagsWithTotal.length * cellSize + margin.left + margin.right);
            const height = Math.max(600, lotsWithTotal.length * cellSize + margin.top + margin.bottom);
            
            svg2 = d3.select('#matrix-viz-2')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMinYMin meet');
            
            const xScale = d3.scaleBand()
                .domain(flagsWithTotal)
                .range([margin.left, width - margin.right])
                .padding(0.1);
            
            const yScale = d3.scaleBand()
                .domain(lotsWithTotal)
                .range([margin.top, height - margin.bottom])
                .padding(0.1);
            
            // Draw main matrix
            drawMatrix(svg2, data.matrix, xScale, yScale, 'flag', 'lot', true);
            
            // Draw row totals
            data.lots.forEach(lot => {
                const g = svg2.append('g')
                    .attr('transform', `translate(${xScale('TOTAL')}, ${yScale(lot)})`);
                
                g.append('rect')
                    .attr('width', xScale.bandwidth())
                    .attr('height', yScale.bandwidth())
                    .attr('fill', '#2a3456')
                    .attr('stroke', '#F5DF4D')
                    .attr('stroke-width', 2)
                    .attr('rx', 4)
                    .attr('ry', 4);
                
                g.append('text')
                    .attr('x', xScale.bandwidth() / 2)
                    .attr('y', yScale.bandwidth() / 2)
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'middle')
                    .attr('class', 'total-label')
                    .text(formatNumber(lotTotals[lot] || 0));
            });
            
            // Draw column totals
            data.flags.forEach(flag => {
                const g = svg2.append('g')
                    .attr('transform', `translate(${xScale('FLAG_' + flag)}, ${yScale('TOTAL')})`);
                
                g.append('rect')
                    .attr('width', xScale.bandwidth())
                    .attr('height', yScale.bandwidth())
                    .attr('fill', '#2a3456')
                    .attr('stroke', '#F5DF4D')
                    .attr('stroke-width', 2)
                    .attr('rx', 4)
                    .attr('ry', 4);
                
                g.append('text')
                    .attr('x', xScale.bandwidth() / 2)
                    .attr('y', yScale.bandwidth() / 2)
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'middle')
                    .attr('class', 'total-label')
                    .text(formatNumber(flagTotals[flag] || 0));
            });
            
            // Draw grand total
            const grandTotalG = svg2.append('g')
                .attr('transform', `translate(${xScale('TOTAL')}, ${yScale('TOTAL')})`);
            
            grandTotalG.append('rect')
                .attr('width', xScale.bandwidth())
                .attr('height', yScale.bandwidth())
                .attr('fill', '#BB2649')
                .attr('stroke', '#F5DF4D')
                .attr('stroke-width', 3)
                .attr('rx', 4)
                .attr('ry', 4);
            
            grandTotalG.append('text')
                .attr('x', xScale.bandwidth() / 2)
                .attr('y', yScale.bandwidth() / 2)
                .attr('text-anchor', 'middle')
                .attr('dominant-baseline', 'middle')
                .attr('fill', '#ffffff')
                .attr('font-size', '14px')
                .attr('font-weight', '700')
                .text(formatNumber(grandTotal));
            
            drawAxes(svg2, flagsWithTotal, lotsWithTotal, xScale, yScale, 'GROUP FLAGS →', 'LOTS ↓', margin);
        }
        
        function drawMatrix(svg, matrixData, xScale, yScale, xKey, yKey, isFlag = false) {
            const maxCount = d3.max(matrixData, d => d.count);
            const colorScale = colorSchemes[currentColorScheme].scale.domain([0, maxCount]);
            
            const cells = svg.selectAll('.cell-group')
                .data(matrixData)
                .enter()
                .append('g')
                .attr('class', 'cell-group')
                .attr('transform', d => {
                    const xVal = isFlag ? 'FLAG_' + d[xKey] : d[xKey];
                    const yVal = isFlag ? d[yKey] : d[yKey];
                    return `translate(${xScale(xVal)}, ${yScale(yVal)})`;
                });
            
            cells.append('rect')
                .attr('class', 'cell')
                .attr('width', xScale.bandwidth())
                .attr('height', yScale.bandwidth())
                .attr('fill', d => d.count > 0 ? colorScale(d.count) : '#1a1f3a')
                .attr('rx', 4)
                .attr('ry', 4)
                .on('mouseover', showTooltip)
                .on('mousemove', moveTooltip)
                .on('mouseout', hideTooltip)
                .on('click', showDetails);
            
            cells.append('text')
                .attr('x', xScale.bandwidth() / 2)
                .attr('y', yScale.bandwidth() / 2)
                .attr('text-anchor', 'middle')
                .attr('dominant-baseline', 'middle')
                .attr('fill', d => d.count > 0 ? '#ffffff' : '#a0a9c9')
                .attr('font-size', Math.min(14, xScale.bandwidth() / 3) + 'px')
                .attr('font-weight', '600')
                .attr('pointer-events', 'none')
                .text(d => d.count > 0 ? formatNumber(d.count) : '');
        }
        
        function drawAxes(svg, xLabels, yLabels, xScale, yScale, xTitle, yTitle, margin) {
            const labelTooltip = document.getElementById('labelTooltip');
            
            // X-axis labels
            svg.selectAll('.x-label')
                .data(xLabels)
                .enter()
                .append('text')
                .attr('class', d => d === 'TOTAL' ? 'axis-label x-label total-label' : 'axis-label x-label')
                .attr('x', d => xScale(d) + xScale.bandwidth() / 2)
                .attr('y', 90)
                .attr('text-anchor', 'middle')
                .attr('font-size', '11px')
                .text(d => {
                    const maxLen = 15;
                    return d.length > maxLen ? d.substring(0, maxLen) + '...' : d;
                })
                .on('mouseover', function(event, d) {
                    if (d.length > 15) {
                        labelTooltip.textContent = d;
                        labelTooltip.style.left = event.pageX + 'px';
                        labelTooltip.style.top = (event.pageY - 30) + 'px';
                        labelTooltip.classList.add('show');
                    }
                })
                .on('mouseout', function() {
                    labelTooltip.classList.remove('show');
                });
            
            // Y-axis labels
            svg.selectAll('.y-label')
                .data(yLabels)
                .enter()
                .append('text')
                .attr('class', d => d === 'TOTAL' ? 'axis-label y-label total-label' : 'axis-label y-label')
                .attr('x', 130)
                .attr('y', d => yScale(d) + yScale.bandwidth() / 2)
                .attr('text-anchor', 'end')
                .attr('dominant-baseline', 'middle')
                .attr('font-size', '11px')
                .text(d => {
                    const maxLen = 20;
                    return d.length > maxLen ? d.substring(0, maxLen) + '...' : d;
                })
                .on('mouseover', function(event, d) {
                    if (d.length > 20) {
                        labelTooltip.textContent = d;
                        labelTooltip.style.left = event.pageX + 'px';
                        labelTooltip.style.top = event.pageY + 'px';
                        labelTooltip.classList.add('show');
                    }
                })
                .on('mouseout', function() {
                    labelTooltip.classList.remove('show');
                });
            
            // Axis titles
            svg.append('text')
                .attr('x', svg.node().getBBox().width / 2)
                .attr('y', 40)
                .attr('text-anchor', 'middle')
                .attr('fill', '#F5DF4D')
                .attr('font-size', '14px')
                .attr('font-weight', '600')
                .text(xTitle);
            
            svg.append('text')
                .attr('x', -svg.node().getBBox().height / 2)
                .attr('y', 20)
                .attr('text-anchor', 'middle')
                .attr('fill', '#F5DF4D')
                .attr('font-size', '14px')
                .attr('font-weight', '600')
                .attr('transform', 'rotate(-90, 20, 0)')
                .text(yTitle);
        }
        
        function showTooltip(event, d) {
            const tooltip = document.getElementById('tooltip');
            const label1 = d.group || d.lot;
            const label2 = d.lot || ('FLAG_' + d.flag);
            
            tooltip.innerHTML = `
                <h3>${label1} × ${label2}</h3>
                <p class="count">${formatNumber(d.count)} accounts</p>
            `;
            tooltip.classList.add('show');
        }
        
        function moveTooltip(event) {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
        }
        
        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }
        
        function showDetails(event, d) {
            const label1 = d.group || d.lot;
            const label2 = d.lot || ('FLAG_' + d.flag);
            const accountList = d.accounts ? d.accounts.join('\n') : 'No accounts available';
            alert(`Details for ${label1} × ${label2}:\n\nTotal Accounts: ${formatNumber(d.count)}\n\nAccounts (showing first 100):\n${accountList.substring(0, 1000)}${accountList.length > 1000 ? '\n...' : ''}`);
        }
        
        function updateStatistics() {
            const metadata = VISUALIZATION_DATA.metadata;
            
            animateCounter('totalAccounts', metadata.total_accounts);
            animateCounter('totalGroups', metadata.total_groups);
            animateCounter('totalLots', metadata.total_lots);
        }
        
        function animateCounter(id, target) {
            const element = document.getElementById(id);
            const duration = 1000;
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                element.textContent = formatNumber(Math.round(current));
                element.classList.add('updating');
                setTimeout(() => element.classList.remove('updating'), 500);
            }, 16);
        }
        
        function setupEventListeners() {
            document.getElementById('colorScheme').addEventListener('change', (e) => {
                currentColorScheme = e.target.value;
                initializeGroupLotMatrix();
                initializeLotFlagMatrix();
            });
            
            document.getElementById('cellSize').addEventListener('input', (e) => {
                cellSizeValue = parseInt(e.target.value);
                initializeGroupLotMatrix();
                initializeLotFlagMatrix();
            });
        }
        
        function resetView() {
            document.getElementById('colorScheme').value = 'pantone';
            document.getElementById('cellSize').value = 50;
            currentColorScheme = 'pantone';
            cellSizeValue = 50;
            initializeGroupLotMatrix();
            initializeLotFlagMatrix();
        }
        
        function exportData() {
            let csv = 'Matrix,Row,Column,Count\n';
            
            VISUALIZATION_DATA.group_lot_matrix.matrix.forEach(d => {
                csv += `GROUP×LOT,${d.group},${d.lot},${d.count}\n`;
            });
            
            VISUALIZATION_DATA.lot_flag_matrix.matrix.forEach(d => {
                csv += `LOT×FLAG,${d.lot},FLAG_${d.flag},${d.count}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dual_matrix_export.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            initializeGroupLotMatrix();
            initializeLotFlagMatrix();
            updateStatistics();
            setupEventListeners();
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                resetView();
            }
        });
    </script>
</body>
</html>
