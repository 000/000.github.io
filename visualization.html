<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Analysis - Dual Matrix Visualization</title>
    
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --classic-blue: #0F4C81;
            --ultimate-gray: #939597;
            --illuminating: #F5DF4D;
            --very-peri: #6667AB;
            --viva-magenta: #BB2649;
            --peach-fuzz: #FFBE98;
            --mocha-mousse: #A47764;
            
            --bg-primary: #0a0e27;
            --bg-secondary: #151932;
            --text-primary: #ffffff;
            --text-secondary: #a0a9c9;
            --border-color: #2a3456;
            
            --gradient-primary: linear-gradient(135deg, var(--very-peri) 0%, var(--viva-magenta) 100%);
            --gradient-secondary: linear-gradient(135deg, var(--peach-fuzz) 0%, var(--mocha-mousse) 100%);
            --gradient-dark: linear-gradient(180deg, #0a0e27 0%, #151932 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.03;
            background-image: 
                radial-gradient(circle at 20% 50%, var(--very-peri) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--viva-magenta) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, var(--peach-fuzz) 0%, transparent 50%);
            animation: bgMove 20s ease-in-out infinite;
        }
        
        @keyframes bgMove {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(-20px, -20px) scale(1.1); }
            66% { transform: translate(20px, -10px) scale(0.9); }
        }
        
        .header {
            padding: 2rem 0;
            text-align: center;
            background: rgba(21, 25, 50, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { filter: drop-shadow(0 0 20px rgba(102, 103, 171, 0.5)); }
            to { filter: drop-shadow(0 0 30px rgba(187, 38, 73, 0.8)); }
        }
        
        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .controls {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .control-group {
            background: rgba(42, 52, 86, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        
        .control-group:hover {
            background: rgba(42, 52, 86, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 103, 171, 0.2);
        }
        
        .control-group label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .control-group select,
        .control-group input {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.95rem;
            min-width: 150px;
            transition: all 0.3s ease;
        }
        
        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: var(--very-peri);
            box-shadow: 0 0 0 3px rgba(102, 103, 171, 0.1);
        }
        
        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.9rem;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(187, 38, 73, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .stats-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .stat-card {
            background: rgba(42, 52, 86, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 103, 171, 0.2);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-secondary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .matrix-container {
            max-width: 1400px;
            margin: 3rem auto;
            padding: 0 2rem;
            background: rgba(21, 25, 50, 0.5);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .matrix-header {
            padding: 2rem;
            background: rgba(42, 52, 86, 0.2);
            border-bottom: 1px solid var(--border-color);
        }
        
        .matrix-header h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            background: var(--gradient-secondary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .matrix-viz {
            padding: 2rem;
            min-height: 600px;
            position: relative;
            overflow-x: auto;
        }
        
        .cell {
            stroke: var(--border-color);
            stroke-width: 1;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .cell:hover {
            stroke: var(--illuminating);
            stroke-width: 2;
            filter: brightness(1.2);
        }
        
        .axis-label {
            font-size: 12px;
            fill: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .axis-label:hover {
            fill: var(--illuminating);
        }
        
        .total-label {
            font-size: 13px;
            fill: var(--illuminating);
            font-weight: 700;
        }
        
        .tooltip {
            position: absolute;
            padding: 1rem;
            background: rgba(10, 14, 39, 0.95);
            border: 1px solid var(--very-peri);
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            max-width: 400px;
        }
        
        .tooltip.show {
            opacity: 1;
        }
        
        .tooltip h3 {
            color: var(--illuminating);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .tooltip p {
            color: var(--text-primary);
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }
        
        .tooltip .count {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--peach-fuzz);
        }
        
        .legend {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            padding: 1.5rem;
            background: rgba(42, 52, 86, 0.2);
            border-top: 1px solid var(--border-color);
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .legend-color {
            width: 30px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }
        
        .legend-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--very-peri);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .label-tooltip {
            position: absolute;
            padding: 0.5rem 1rem;
            background: rgba(10, 14, 39, 0.95);
            border: 1px solid var(--very-peri);
            border-radius: 6px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 2000;
            font-size: 0.9rem;
            color: var(--text-primary);
            white-space: nowrap;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .label-tooltip.show {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .matrix-viz {
                padding: 1rem;
            }
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        *:focus-visible {
            outline: 2px solid var(--very-peri);
            outline-offset: 2px;
        }
        
        @keyframes dataUpdate {
            0% { opacity: 0; transform: scale(0.8); }
            50% { opacity: 0.5; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .updating {
            animation: dataUpdate 0.5s ease-out;
        }
        
        .tab-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .tab {
            background: rgba(42, 52, 86, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 12px 12px 0 0;
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .tab:hover {
            background: rgba(42, 52, 86, 0.5);
            color: var(--text-primary);
        }
        
        .tab.active {
            background: var(--gradient-primary);
            color: white;
            border-bottom-color: transparent;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <header class="header">
        <h1>Account Analysis - Dual Matrix Visualization</h1>
        <p>Interactive Visualization of Account Distribution</p>
        <p style="font-size: 0.85rem; margin-top: 0.5rem; color: var(--illuminating);">
            ✨ LOT5 Sub-lots Consolidated | Generated: 2025-10-03 03:11:16
        </p>
    </header>
    
    <div class="controls">
        <div class="control-group">
            <label for="colorScheme">Color Scheme</label>
            <select id="colorScheme">
                <option value="pantone">Pantone Colors</option>
                <option value="heat">Heat Map</option>
                <option value="cool">Cool Tones</option>
                <option value="vibrant">Vibrant</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="cellSize">Cell Size</label>
            <input type="range" id="cellSize" min="30" max="80" value="50">
        </div>
        
        <div class="control-group">
            <button class="btn" onclick="resetView()">Reset View</button>
        </div>
        
        <div class="control-group">
            <button class="btn" onclick="exportData()">Export CSV</button>
        </div>
    </div>
    
    <div class="stats-container">
        <div class="stat-card">
            <div class="stat-value" id="totalAccounts">0</div>
            <div class="stat-label">Total Accounts</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalGroups">0</div>
            <div class="stat-label">Groups</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalLots">0</div>
            <div class="stat-label">Lots</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalFlags">4</div>
            <div class="stat-label">Group Flags</div>
        </div>
    </div>
    
    <div class="tab-container">
        <div class="tabs">
            <div class="tab active" onclick="switchTab(event, 'group-lot')">GROUP × LOT Matrix</div>
            <div class="tab" onclick="switchTab(event, 'lot-flag')">LOT × GROUP_FLAG Matrix</div>
        </div>
    </div>
    
    <div id="group-lot-content" class="tab-content active">
        <div class="matrix-container">
            <div class="matrix-header">
                <h2>GROUP × LOT Matrix</h2>
                <p>Click on cells to view account details • Hover for quick stats • Hover labels for full text</p>
            </div>
            
            <div id="matrix-viz-1" class="matrix-viz">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #0F4C81;"></div>
                    <span class="legend-label">0-10 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #6667AB;"></div>
                    <span class="legend-label">11-50 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #BB2649;"></div>
                    <span class="legend-label">51-100 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FFBE98;"></div>
                    <span class="legend-label">100+ Accounts</span>
                </div>
            </div>
        </div>
    </div>
    
    <div id="lot-flag-content" class="tab-content">
        <div class="matrix-container">
            <div class="matrix-header">
                <h2>LOT × GROUP_FLAG Matrix</h2>
                <p>Click on cells to view account details • Hover for quick stats • Includes row and column totals</p>
            </div>
            
            <div id="matrix-viz-2" class="matrix-viz">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #0F4C81;"></div>
                    <span class="legend-label">0-10 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #6667AB;"></div>
                    <span class="legend-label">11-50 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #BB2649;"></div>
                    <span class="legend-label">51-100 Accounts</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FFBE98;"></div>
                    <span class="legend-label">100+ Accounts</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    <div class="label-tooltip" id="labelTooltip"></div>
    
    <script>
        const VISUALIZATION_DATA = {
  "group_lot_matrix": {
    "groups": [
      "GF1",
      "GF2",
      "GF3",
      "GF4"
    ],
    "lots": [
      "1",
      "2",
      "3",
      "4",
      "5",
      "6"
    ],
    "matrix": [
      {
        "group": "GF1",
        "lot": "1",
        "count": 519938,
        "accounts": [
          "2008553930",
          "1049074629",
          "2010517083",
          "1042998434",
          "1042111057",
          "1052202624",
          "1045921416",
          "1048839656",
          "1051698278",
          "1090257509",
          "1090215571",
          "1043679839",
          "1042353735",
          "1050705904",
          "1010686771",
          "1011180014",
          "1039221653",
          "1039714501",
          "1047462257",
          "1009457543",
          "1047306409",
          "1010073648",
          "1039664989",
          "1039297870",
          "1009385127",
          "1048540715",
          "1043853707",
          "5002289789",
          "9100033052",
          "1041620705",
          "1039695957",
          "1047465272",
          "1046215817",
          "1010337718",
          "1048856380",
          "1056484263",
          "1047487837",
          "1056458319",
          "1091403479",
          "1037316703",
          "1046806564",
          "1008316245",
          "1041777345",
          "1046186329",
          "1050479610",
          "1049037014",
          "1009656848",
          "1053326815",
          "1051284201",
          "1048967441",
          "1050139844",
          "1008078514",
          "1010584383",
          "1048609588",
          "1038829127",
          "1044258047",
          "1052441440",
          "5001961211",
          "1042995524",
          "9100237210",
          "1048947971",
          "9200001872",
          "1044296666",
          "1041244398",
          "1045200352",
          "1041517467",
          "1044725923",
          "1038998271",
          "5002305695",
          "1056483041",
          "1052388922",
          "2009463129",
          "1037811607",
          "1044642297",
          "1055103635",
          "5002271960",
          "1050225007",
          "1044193034",
          "1049163222",
          "1049281675",
          "1046232916",
          "1047830655",
          "1043266267",
          "9100050211",
          "5001569907",
          "1091594622",
          "1042779457",
          "1044436514",
          "1054206821",
          "1041833040",
          "1050360540",
          "1040065198",
          "1056166584",
          "1008518387",
          "5001391822",
          "1040880401",
          "1050364481",
          "9100062434",
          "1045343102",
          "1051764726"
        ]
      },
      {
        "group": "GF1",
        "lot": "2",
        "count": 424963,
        "accounts": [
          "1043430563",
          "1044983981",
          "1051720788",
          "1090104915",
          "1055193359",
          "1056146362",
          "1005224137",
          "5001180910",
          "1052913377",
          "5090031059",
          "9100202750",
          "1053540450",
          "1004761082",
          "1042913234",
          "1037322495",
          "1050381629",
          "1055081798",
          "1004138768",
          "1006825312",
          "1045405612",
          "1038651662",
          "9100293510",
          "9100259902",
          "9100296127",
          "5000639936",
          "1047635828",
          "1049648498",
          "5000933699",
          "1051620007",
          "1055406247",
          "1049101634",
          "1005128669",
          "2000027717",
          "1091527488",
          "1045880442",
          "1054210829",
          "1048249794",
          "1053423551",
          "1056371951",
          "1048267547",
          "1037726103",
          "9100435306",
          "1044966181",
          "1054403481",
          "1050072677",
          "1042625859",
          "9100156498",
          "1038435021",
          "1010668498",
          "5000375289",
          "1053264674",
          "1045031577",
          "5000231694",
          "1039302866",
          "1091403436",
          "1045882097",
          "1090043134",
          "1045934720",
          "1008568325",
          "1001463374",
          "1090520293",
          "1039012035",
          "9100208604",
          "2009495020",
          "1051102359",
          "1054576831",
          "1002180864",
          "1008197300",
          "1050390121",
          "1047794977",
          "5000770447",
          "1091250869",
          "1004275625",
          "1091354931",
          "9100010483",
          "1044579757",
          "1055346171",
          "1002165458",
          "1040722598",
          "1053616708",
          "1008590746",
          "1007045124",
          "1091083628",
          "9100145434",
          "5002396836",
          "9100207820",
          "9100270407",
          "1091571029",
          "9100180791",
          "1053895003",
          "1043806377",
          "1005704821",
          "5002337899",
          "1054494851",
          "1010916319",
          "1037442849",
          "1091351789",
          "2000294138",
          "1046931520",
          "9100308153"
        ]
      },
      {
        "group": "GF1",
        "lot": "3",
        "count": 572364,
        "accounts": [
          "9100096767",
          "5001060184",
          "1052305687",
          "1041987986",
          "1044448423",
          "1008637793",
          "1043722408",
          "5000863917",
          "5001612020",
          "1042094241",
          "1002891892",
          "1040123260",
          "1049845668",
          "1045885371",
          "1050831314",
          "1043121102",
          "1050920341",
          "1040496695",
          "5090045173",
          "9100110264",
          "1048924548",
          "1038986966",
          "1038853311",
          "1041509367",
          "1051836395",
          "1047793784",
          "1043428666",
          "1041470959",
          "1000684911",
          "1051153891",
          "1042644551",
          "5000818717",
          "1037583388",
          "1053396147",
          "1010501607",
          "1052317316",
          "1091067088",
          "1037984617",
          "5002298753",
          "1045205362",
          "5001271983",
          "1048170098",
          "1050857038",
          "1008254789",
          "1007513357",
          "1004385447",
          "1048915824",
          "5002448046",
          "1044062797",
          "1051762138",
          "5000149963",
          "1043487298",
          "1046477021",
          "1008363316",
          "1004493681",
          "1042474095",
          "1048116379",
          "1047557258",
          "1008769444",
          "1039725368",
          "1045807028",
          "1038977649",
          "1050797035",
          "5000838920",
          "1047557061",
          "1046787470",
          "5000118197",
          "1044277238",
          "1041766068",
          "1091280695",
          "5001670063",
          "1047641178",
          "1052287956",
          "1048772535",
          "1042889414",
          "1003996930",
          "1041407696",
          "1008920622",
          "1042310521",
          "1048848507",
          "1091151275",
          "9100010406",
          "1009890492",
          "1005883106",
          "1049884191",
          "1090764141",
          "1037853474",
          "1046419706",
          "1008753092",
          "1038474221",
          "1043271376",
          "1042814112",
          "1044015551",
          "2000036546",
          "1038575826",
          "1041349815",
          "5001682355",
          "9200017799",
          "1044554924",
          "1008279447"
        ]
      },
      {
        "group": "GF1",
        "lot": "4",
        "count": 681485,
        "accounts": [
          "1008464775",
          "1021246905",
          "1006391290",
          "1036630706",
          "1029607133",
          "1003668909",
          "1006255524",
          "1036565823",
          "1002176166",
          "1033927724",
          "1000952940",
          "1004102216",
          "1053286120",
          "1007479809",
          "1091109341",
          "1090563634",
          "1051208432",
          "2011004292",
          "2008212009",
          "1035551489",
          "1033452823",
          "1004589751",
          "1031460160",
          "1050414349",
          "1043201890",
          "1026687438",
          "1049746104",
          "1006962042",
          "1003130305",
          "1054948968",
          "1005035121",
          "1001964934",
          "1026542030",
          "1034006487",
          "1002108225",
          "1005843104",
          "1048259897",
          "1025796357",
          "1037679318",
          "1027384102",
          "1007381108",
          "1009829718",
          "1031195599",
          "5002242421",
          "9100006780",
          "1024178293",
          "1052440932",
          "1006919627",
          "5000596056",
          "1034440969",
          "1055331654",
          "1035827425",
          "1005866953",
          "1002082773",
          "9100020458",
          "1037976290",
          "1036266222",
          "1049546911",
          "9100180744",
          "1038591481",
          "1028976658",
          "1000051757",
          "1001135628",
          "1005491682",
          "5001628032",
          "1001598792",
          "1001916395",
          "1007011548",
          "1001115481",
          "1008425303",
          "1039260012",
          "1001634209",
          "1051844576",
          "1002680395",
          "1002014875",
          "1005781087",
          "1052343503",
          "1030247943",
          "1090978478",
          "1005073082",
          "1051564603",
          "1037192702",
          "9200048243",
          "1033633313",
          "1047445832",
          "1007549300",
          "1000709590",
          "5000546091",
          "1004688008",
          "1019382600",
          "1028402643",
          "1027602770",
          "1029648670",
          "1006705945",
          "1043158847",
          "1036568083",
          "1002614171",
          "1049043901",
          "1035881837",
          "1051029988"
        ]
      },
      {
        "group": "GF1",
        "lot": "5",
        "count": 389451,
        "accounts": [
          "1043919341",
          "1002134277",
          "2010552237",
          "1040191851",
          "1035042908",
          "1003704794",
          "5002304826",
          "1003946992",
          "1056499326",
          "1033880302",
          "1044163348",
          "1051909953",
          "1041065620",
          "1047504847",
          "1001971183",
          "1039413633",
          "1041136242",
          "1044151358",
          "1004846991",
          "1001974743",
          "1090400794",
          "5090057902",
          "1010505114",
          "1042840199",
          "1039403972",
          "1045948411",
          "1041347456",
          "1007105526",
          "1006571655",
          "1034180584",
          "1009111906",
          "1045513563",
          "1005936102",
          "1038165458",
          "1090927962",
          "1043362347",
          "1004847408",
          "1000822524",
          "1001332113",
          "1024356051",
          "1048216039",
          "5000434617",
          "1009684876",
          "1049604806",
          "1052824951",
          "1090763609",
          "1000348695",
          "1035897636",
          "1046553615",
          "1045249335",
          "1042997934",
          "5000293665",
          "5000723406",
          "1007219009",
          "1009628739",
          "1034125958",
          "1052630146",
          "1000027384",
          "1001159950",
          "1038064163",
          "1051161231",
          "1037898451",
          "1043839208",
          "1046530860",
          "1044818875",
          "1042148295",
          "1090611132",
          "2008534502",
          "5000196724",
          "1007374187",
          "1047332019",
          "1003928307",
          "1043488375",
          "1048312755",
          "1050843908",
          "2000041973",
          "5000559355",
          "1038088356",
          "1047364913",
          "1000037606",
          "1049977181",
          "1038920914",
          "9200033851",
          "1041837348",
          "1041166516",
          "1090159183",
          "1001612299",
          "1049367073",
          "1044275065",
          "2010191455",
          "1038476348",
          "1045567426",
          "1041113374",
          "1040178979",
          "1045987565",
          "1042788898",
          "1038489253",
          "1052730884",
          "1039243649",
          "1005508496"
        ]
      },
      {
        "group": "GF1",
        "lot": "6",
        "count": 517517,
        "accounts": [
          "1050945956",
          "1025929799",
          "1003545939",
          "5001433916",
          "1056497959",
          "1029282234",
          "5001545811",
          "9100006924",
          "1006223754",
          "1051304393",
          "1044065362",
          "1049741382",
          "1053365071",
          "1056505075",
          "1050096401",
          "5000226674",
          "1008974056",
          "1050270878",
          "1040185304",
          "1054499985",
          "1037393066",
          "1034154265",
          "1028308817",
          "5001751640",
          "9200060287",
          "1008347760",
          "5002259146",
          "1006095551",
          "1038812151",
          "9100173161",
          "1001943775",
          "1022216368",
          "5001325072",
          "1043558322",
          "1028373651",
          "5002120938",
          "1029753776",
          "1049190114",
          "5090106709",
          "1055013334",
          "1054452881",
          "1042122288",
          "1052582222",
          "5000078020",
          "1023028492",
          "9200069282",
          "1055330186",
          "1015788629",
          "1023058324",
          "1025612019",
          "1056505466",
          "1054509336",
          "1002672295",
          "2010812271",
          "1000738566",
          "1007475196",
          "5000411749",
          "9200216806",
          "2000149537",
          "1039130003",
          "1052074758",
          "1023872625",
          "1042062811",
          "5000055810",
          "1009440780",
          "5000178300",
          "9100134994",
          "1035439077",
          "1046675354",
          "1008819735",
          "9200122126",
          "1053514980",
          "1055716335",
          "1091192850",
          "1010315587",
          "1054084017",
          "9200157793",
          "1022071416",
          "1024115828",
          "1048531104",
          "5000252322",
          "1028340583",
          "1029724423",
          "5001924030",
          "1003671985",
          "9100059016",
          "1054971161",
          "1000041522",
          "1056507430",
          "1009461788",
          "1002306361",
          "1033165913",
          "1032480343",
          "1052014208",
          "1020238232",
          "1052828310",
          "1050922913",
          "1007270292",
          "9100093156",
          "1007023694"
        ]
      },
      {
        "group": "GF2",
        "lot": "1",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF2",
        "lot": "2",
        "count": 1,
        "accounts": [
          "1042888175"
        ]
      },
      {
        "group": "GF2",
        "lot": "3",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF2",
        "lot": "4",
        "count": 913,
        "accounts": [
          "1028642709",
          "1028343698",
          "1024944387",
          "1016724616",
          "1013565355",
          "1026704499",
          "1029674507",
          "1016942427",
          "1022536508",
          "1022750399",
          "1015581870",
          "1026684838",
          "1011389770",
          "1019941154",
          "1021213675",
          "1016432429",
          "1023207834",
          "1017678502",
          "1030550646",
          "1016197055",
          "1035750791",
          "1021510742",
          "1030665818",
          "1017799016",
          "1032395109",
          "1017220654",
          "1027842984",
          "1016426925",
          "1023388596",
          "1023064413",
          "1035573938",
          "1013809459",
          "1031225048",
          "1023248409",
          "1020466529",
          "1025594282",
          "1034963716",
          "1025556852",
          "1019065761",
          "1021225703",
          "1026935598",
          "1015895824",
          "1013407733",
          "1023732033",
          "1012858480",
          "1018640436",
          "1031805311",
          "1022306847",
          "1035441349",
          "1027834779",
          "1028328532",
          "1017189102",
          "1024809439",
          "1024968723",
          "1024617009",
          "1029503559",
          "1014012619",
          "1032553898",
          "1013907833",
          "1030499047",
          "1028626096",
          "1031394036",
          "1037200144",
          "1012799654",
          "1022603825",
          "1028195052",
          "1026614309",
          "1011301938",
          "1017157367",
          "1011746603",
          "1018241795",
          "1029813728",
          "1024830098",
          "1018526447",
          "1021999296",
          "1030732264",
          "1019603518",
          "1020204540",
          "1013574249",
          "1019108762",
          "1012467856",
          "1017770301",
          "1015395171",
          "1028913990",
          "1021644501",
          "1022680447",
          "1017686076",
          "1019387157",
          "1018470425",
          "1025502760",
          "1014816661",
          "1019852313",
          "1027806600",
          "1021707414",
          "1036925218",
          "1016106815",
          "1021952672",
          "1019167556",
          "1024531783",
          "1013029232"
        ]
      },
      {
        "group": "GF2",
        "lot": "5",
        "count": 116,
        "accounts": [
          "1026945356",
          "1025257758",
          "1016289065",
          "1011404044",
          "1023016990",
          "1026496306",
          "1012533034",
          "1014629616",
          "1018241469",
          "1029672652",
          "1026358221",
          "1031414657",
          "1023089599",
          "1020498528",
          "1027314449",
          "1020765933",
          "1030370168",
          "1017503362",
          "1025586778",
          "1013110188",
          "1029864993",
          "1033125318",
          "1025630750",
          "1019471093",
          "1029932360",
          "1022769359",
          "1014796970",
          "1016389620",
          "1016244320",
          "1015249515",
          "1027655025",
          "1025322967",
          "1025619048",
          "1025614852",
          "1015285791",
          "1030554994",
          "1025520211",
          "1023835770",
          "1021439630",
          "1029156182",
          "1022921266",
          "1029449155",
          "1025640802",
          "1019761830",
          "1032947543",
          "1021815020",
          "1020472308",
          "1025931491",
          "1028498594",
          "1013020634",
          "1021474134",
          "1027567215",
          "1018729569",
          "1027780768",
          "1021530859",
          "1023353083",
          "1025978463",
          "1020599944",
          "1028070438",
          "1022966588",
          "1024833194",
          "1017265615",
          "1028670354",
          "1031376143",
          "1029395349",
          "1022912445",
          "1020729767",
          "1019538600",
          "1020891912",
          "1017096031",
          "1019655259",
          "1028319800",
          "1020347341",
          "1030224366",
          "1028372019",
          "1012539989",
          "1028683502",
          "1021192945",
          "1019437480",
          "1029138141",
          "1020831359",
          "1014426375",
          "1026009839",
          "1025183983",
          "1020701757",
          "1032821264",
          "1014992893",
          "1022606387",
          "1018841644",
          "1015791875",
          "1037261054",
          "1021219967",
          "1011412772",
          "1020361239",
          "1022714724",
          "1022336959",
          "1016318995",
          "1017527504",
          "1028978413",
          "1015791883"
        ]
      },
      {
        "group": "GF2",
        "lot": "6",
        "count": 591,
        "accounts": [
          "1019998334",
          "1012141632",
          "1031205977",
          "1013367472",
          "1026392535",
          "1018782931",
          "1025731840",
          "1019631503",
          "1028216033",
          "1015843662",
          "1013706633",
          "1019189746",
          "1016284217",
          "1022953680",
          "1015564860",
          "1012816966",
          "1024825590",
          "1027864422",
          "1022100874",
          "1021291315",
          "1020265299",
          "1027214002",
          "1015199569",
          "1016898703",
          "1022471740",
          "1024712141",
          "1011317141",
          "1027621325",
          "1016215355",
          "1013234251",
          "1016314736",
          "1022714899",
          "1014931274",
          "1021995142",
          "1021869090",
          "1017547394",
          "1023209608",
          "1015843182",
          "1016455410",
          "1034882341",
          "1014914779",
          "1017233985",
          "1025347471",
          "1031316728",
          "1028588380",
          "1017211736",
          "1017080208",
          "1011414937",
          "1028586191",
          "1012506762",
          "1016633009",
          "1013602439",
          "1037198484",
          "1023546949",
          "1013367499",
          "1020469269",
          "1013022882",
          "1012646602",
          "1023243490",
          "1012466930",
          "1011677121",
          "1011788764",
          "1017016275",
          "1020984392",
          "1016261985",
          "1020237848",
          "1025583655",
          "1019485906",
          "1017301360",
          "1030475571",
          "1017600732",
          "1021508209",
          "1028525451",
          "1025789946",
          "1023736047",
          "1018674969",
          "1029864950",
          "1017616272",
          "1018016732",
          "1022582259",
          "1014862655",
          "1026262119",
          "1020144440",
          "1024075575",
          "1027144896",
          "1016378572",
          "1027067344",
          "1020601116",
          "1021881260",
          "1012908003",
          "1025909968",
          "1013656121",
          "1021870498",
          "1011500396",
          "1015909574",
          "1012357597",
          "1012713318",
          "1036779769",
          "1032464135",
          "1022215264"
        ]
      },
      {
        "group": "GF3",
        "lot": "1",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF3",
        "lot": "2",
        "count": 3695,
        "accounts": [
          "2008283003",
          "2009716647",
          "2010800818",
          "1042874123",
          "2009723910",
          "2008530000",
          "1042244820",
          "1039122205",
          "2008982122",
          "2008959082",
          "2010997840",
          "2009700732",
          "2008984095",
          "2000128106",
          "1008555916",
          "2008877728",
          "2009997387",
          "2008993698",
          "2010761928",
          "2010829867",
          "2009575318",
          "2009770749",
          "2010827279",
          "2009652681",
          "2010786831",
          "2008903745",
          "2008234541",
          "1006577971",
          "2009660250",
          "1042043817",
          "2009485319",
          "2009110110",
          "2008902218",
          "2010982436",
          "2010605853",
          "2008981169",
          "1008284823",
          "2008967735",
          "2010074823",
          "2010232305",
          "2009719735",
          "2010783190",
          "2000311733",
          "2010960858",
          "2009511794",
          "2008947734",
          "2008427234",
          "2008967131",
          "2008574806",
          "2009614461",
          "2010271807",
          "2008789934",
          "2009652703",
          "2009622898",
          "2008874176",
          "2008683095",
          "1009663119",
          "2011013763",
          "2008970221",
          "1009718487",
          "2009809254",
          "2010600193",
          "2009765427",
          "2010982517",
          "2009856147",
          "1008867357",
          "2010618017",
          "2010989910",
          "2009615859",
          "2010799348",
          "2010604520",
          "2000400523",
          "2000270999",
          "2008818624",
          "2008957578",
          "1003924719",
          "2008620395",
          "2009483731",
          "2000363644",
          "2008761207",
          "2010819667",
          "2000246923",
          "2007980525",
          "2008974588",
          "2010854853",
          "2009209923",
          "1039664849",
          "2008381595",
          "2008975916",
          "2008729583",
          "2009114892",
          "2010883314",
          "2008974790",
          "2009002008",
          "2008961168",
          "1037741722",
          "2008776255",
          "2009407458",
          "2010448111",
          "2008882659"
        ]
      },
      {
        "group": "GF3",
        "lot": "3",
        "count": 42,
        "accounts": [
          "2000105750",
          "1001894561",
          "1000232301",
          "2000164048",
          "2000117406",
          "2000197159",
          "1004482434",
          "2000079148",
          "2000295274",
          "2000096107",
          "2000216625",
          "2000102077",
          "2000135471",
          "2000001580",
          "1000590445",
          "2000271103",
          "2000178030",
          "2000272967",
          "2000256465",
          "1040982581",
          "2000350038",
          "2000242626",
          "2000030750",
          "2000228313",
          "2000102018",
          "2000120334",
          "2000372791",
          "2007898926",
          "1000055566",
          "2000111920",
          "2000131654",
          "2000366112",
          "2007900815",
          "2000303285",
          "2000349226",
          "2000051944",
          "2000374123",
          "1010054708",
          "1040082572",
          "1008167797",
          "1040782191",
          "2000125905"
        ]
      },
      {
        "group": "GF3",
        "lot": "4",
        "count": 196935,
        "accounts": [
          "1037643453",
          "1015034683",
          "1022485342",
          "1019749423",
          "1037257286",
          "1020133295",
          "1026467144",
          "1032843284",
          "1021322709",
          "1003946569",
          "1017508658",
          "1031526552",
          "1032820942",
          "2010479262",
          "1031525718",
          "1030312109",
          "1034232657",
          "1036860116",
          "1019007281",
          "1016302932",
          "1017359989",
          "1001846524",
          "1020504501",
          "1006887113",
          "1027868908",
          "1029365237",
          "1016498004",
          "2010777913",
          "1000186679",
          "1033918741",
          "1014000556",
          "1034592009",
          "1000038181",
          "1005357102",
          "1030001790",
          "1003609279",
          "1001676939",
          "1011851369",
          "1037046641",
          "1014498473",
          "1022352695",
          "1013633407",
          "1004268440",
          "2009475062",
          "1007316403",
          "1029059144",
          "1033386235",
          "1031623299",
          "1031554890",
          "1039141870",
          "2010675819",
          "2008376745",
          "1000024504",
          "1032397152",
          "1033920770",
          "1018143009",
          "2000363210",
          "1022913565",
          "1017741123",
          "1033479748",
          "1011718537",
          "1018517618",
          "1005588961",
          "1027183956",
          "1021662836",
          "1007526505",
          "1005216991",
          "1035275406",
          "1015219403",
          "1036168034",
          "1024012484",
          "1018240004",
          "1033388173",
          "1002271746",
          "1029826277",
          "1026535522",
          "1005781125",
          "1034384821",
          "2000255302",
          "1016838638",
          "1004545541",
          "1007537639",
          "1036131025",
          "1016435894",
          "1006197788",
          "1010324349",
          "1015602363",
          "1014366070",
          "1019579099",
          "1004268947",
          "1034906283",
          "1001991168",
          "1001436911",
          "1018148183",
          "1007781629",
          "1034483447",
          "1012083160",
          "1023759578",
          "1028084609",
          "1015562132"
        ]
      },
      {
        "group": "GF3",
        "lot": "5",
        "count": 193017,
        "accounts": [
          "2008837335",
          "2008262537",
          "1001006194",
          "1005561281",
          "1014571383",
          "1017060347",
          "1004922957",
          "1007451181",
          "1000803759",
          "2010820703",
          "1031390480",
          "1039599699",
          "1014310482",
          "1010650009",
          "1019244097",
          "1026987458",
          "1026867223",
          "1026469058",
          "1030327750",
          "1021368695",
          "1005792305",
          "1022471104",
          "1024587282",
          "1017706107",
          "2008912345",
          "1004742916",
          "1004626401",
          "1023973480",
          "2009904060",
          "1019594748",
          "1027749283",
          "1019603569",
          "1025354486",
          "1025367197",
          "1001857437",
          "1003839282",
          "1016140592",
          "1017414548",
          "1006909575",
          "1027291228",
          "1029789789",
          "1026694248",
          "1002175003",
          "1012217043",
          "1031878181",
          "1003431755",
          "1019495936",
          "1007475811",
          "1001230191",
          "1001675177",
          "1007647434",
          "1037894464",
          "1037018346",
          "1016482930",
          "1034965867",
          "1013631420",
          "1033849707",
          "1027283632",
          "1002661196",
          "1011679302",
          "2008878775",
          "1030601941",
          "1006948619",
          "1017542872",
          "1024254437",
          "1012557847",
          "2008684938",
          "2010918983",
          "1001049942",
          "1027325319",
          "1000124703",
          "1024980391",
          "1013842111",
          "1005590664",
          "1012623718",
          "1027591426",
          "1022064746",
          "1030097402",
          "1000320995",
          "1007252413",
          "1003901484",
          "1004406533",
          "1024721671",
          "1039819613",
          "1035615592",
          "1033210242",
          "2008973093",
          "1002360331",
          "2000273084",
          "1033350559",
          "1029044635",
          "1031976930",
          "1006677747",
          "1027042368",
          "1001077644",
          "1000285472",
          "1005190011",
          "1029707006",
          "1021314072",
          "1033142077"
        ]
      },
      {
        "group": "GF3",
        "lot": "6",
        "count": 158067,
        "accounts": [
          "1016476787",
          "1018473785",
          "1014109752",
          "1028148712",
          "1029863377",
          "2009435125",
          "2008427692",
          "2000346359",
          "1019575433",
          "1023376458",
          "2000124933",
          "1000110672",
          "1014202795",
          "1041880065",
          "1016380399",
          "1003300170",
          "1019420146",
          "2009607678",
          "1023888769",
          "1022328964",
          "1024799751",
          "2000145337",
          "2009538498",
          "1023027305",
          "1005544328",
          "1018398805",
          "1011689707",
          "1023182203",
          "1018628738",
          "1026117984",
          "1090111423",
          "1021633976",
          "1026058538",
          "1027879101",
          "1022797719",
          "1025584031",
          "1018889175",
          "1017650276",
          "2010374797",
          "2007960575",
          "1005968993",
          "1022132709",
          "1005914877",
          "1028487363",
          "1030575967",
          "1002079748",
          "1003636284",
          "1015367070",
          "1016962606",
          "1026591678",
          "1021523674",
          "1006003541",
          "1024311317",
          "1004428537",
          "1026114616",
          "1031596038",
          "1029396795",
          "1005482195",
          "1014983673",
          "1033663980",
          "1026127610",
          "1020036710",
          "1032321466",
          "1027501788",
          "1029714134",
          "2000296394",
          "2008792544",
          "1010153056",
          "1018940537",
          "1015836127",
          "1034241621",
          "2000092888",
          "1015140785",
          "1029553459",
          "1036805794",
          "2008725146",
          "1029063591",
          "1003422624",
          "1017703612",
          "1023471345",
          "1037352734",
          "1025683579",
          "1012925986",
          "1020904011",
          "1027650716",
          "1024112136",
          "1021408018",
          "1013276191",
          "1021719994",
          "1026388287",
          "1016243839",
          "1025012399",
          "1023216264",
          "2008592448",
          "1020730447",
          "2007990261",
          "1000991148",
          "1034829432",
          "1027020461",
          "2008903974"
        ]
      },
      {
        "group": "GF4",
        "lot": "1",
        "count": 0,
        "accounts": []
      },
      {
        "group": "GF4",
        "lot": "2",
        "count": 4,
        "accounts": [
          "1007688149",
          "1010937820",
          "1008485055",
          "1007695935"
        ]
      },
      {
        "group": "GF4",
        "lot": "3",
        "count": 202061,
        "accounts": [
          "1023009021",
          "1038228018",
          "1090082237",
          "1009802909",
          "1013651421",
          "1036691829",
          "2011004578",
          "1032649313",
          "1039196659",
          "1007162465",
          "1008322490",
          "1002657725",
          "1036518558",
          "1002499976",
          "1022896601",
          "1023437422",
          "1034767542",
          "2009678249",
          "1001677714",
          "1018588191",
          "1006198644",
          "1002758351",
          "1034417649",
          "1035034352",
          "1013494032",
          "1002171369",
          "1016411286",
          "1024132013",
          "1020902132",
          "1015907717",
          "1033103403",
          "1016195907",
          "1002907128",
          "1003268323",
          "1005511551",
          "2010480457",
          "2010066057",
          "2010445694",
          "1035616068",
          "1007043180",
          "1009204572",
          "1016941269",
          "1022899511",
          "1036637166",
          "1005520100",
          "1090068730",
          "1034976869",
          "1038128951",
          "1021494658",
          "2010849469",
          "2008434079",
          "1007667761",
          "1013587464",
          "1000023605",
          "1002421233",
          "1031284931",
          "1037321375",
          "1035538717",
          "2000296351",
          "2010825780",
          "1005640122",
          "2008555887",
          "1030165548",
          "1036482960",
          "2010670809",
          "1023611082",
          "1032318368",
          "1005804109",
          "1036071006",
          "1036017273",
          "1011498065",
          "1024513971",
          "1000699579",
          "1007945516",
          "2000323162",
          "1016208006",
          "1024613771",
          "1034817833",
          "1001267680",
          "1008910899",
          "1023466031",
          "2010814762",
          "1037108671",
          "1031390596",
          "1035045885",
          "1026385008",
          "1024321339",
          "1029418713",
          "1000463818",
          "1036312062",
          "1004059132",
          "1040299784",
          "2008514684",
          "1020928719",
          "1033110728",
          "1001542258",
          "1019147539",
          "1035857774",
          "1009998285",
          "2010816862"
        ]
      },
      {
        "group": "GF4",
        "lot": "4",
        "count": 260285,
        "accounts": [
          "1024808955",
          "1037217616",
          "1023132478",
          "1017694176",
          "1026966655",
          "1016734964",
          "1032892714",
          "1023321564",
          "1032724668",
          "1034041797",
          "1013258045",
          "1014381800",
          "1034607502",
          "1013084357",
          "1023368633",
          "1013256409",
          "1031245383",
          "1033195871",
          "1032147768",
          "1028570929",
          "1011402599",
          "1015750516",
          "1011393727",
          "1012172481",
          "1014121213",
          "1013599217",
          "1027050298",
          "1016386850",
          "1013206126",
          "1032333820",
          "1022690221",
          "1032996064",
          "1017647798",
          "1018792503",
          "1029540322",
          "1024770079",
          "1013921313",
          "1029712670",
          "1017524637",
          "1016880480",
          "1032518162",
          "1031606467",
          "1024684725",
          "1015782647",
          "1017095825",
          "1025970748",
          "1032076402",
          "1019790105",
          "1016913400",
          "1016305842",
          "1029553394",
          "1017507864",
          "1034508555",
          "1019527005",
          "1030138680",
          "1031439676",
          "1011586819",
          "1014165008",
          "1030981973",
          "1015659888",
          "1015377009",
          "1029567468",
          "1011253690",
          "1030240701",
          "1011840634",
          "1017306206",
          "1019379634",
          "1022269658",
          "1014510325",
          "1037171411",
          "1011729555",
          "1014325013",
          "1011705656",
          "1014578027",
          "1012278638",
          "1019619643",
          "1017092419",
          "1021721913",
          "1036751074",
          "1034711369",
          "1025588916",
          "1029069050",
          "1012490580",
          "1020579501",
          "1019935251",
          "1032642459",
          "1030391254",
          "1031971386",
          "1015954146",
          "1030762589",
          "1018696369",
          "1022710397",
          "1031591249",
          "1032725931",
          "1031363831",
          "1012617270",
          "1029733953",
          "1033800597",
          "1016501870",
          "1014646421"
        ]
      },
      {
        "group": "GF4",
        "lot": "5",
        "count": 49739,
        "accounts": [
          "1015816630",
          "1020777206",
          "1023994992",
          "1035309432",
          "1021128139",
          "1018401350",
          "1017767777",
          "1014792037",
          "1033178063",
          "1019958235",
          "1023911248",
          "1019287675",
          "1019902426",
          "1015485162",
          "1028276028",
          "1017195579",
          "1027687849",
          "1018586113",
          "1018678328",
          "1019866136",
          "1027270506",
          "1015556647",
          "1022499068",
          "1029615551",
          "1035037688",
          "1034956817",
          "1015680658",
          "1022167561",
          "1013291506",
          "1024903192",
          "1034825151",
          "1014688736",
          "1026863422",
          "1026180430",
          "1016769059",
          "1034570056",
          "1032435631",
          "1023170337",
          "1021075612",
          "1018247181",
          "1025210166",
          "1012690725",
          "1026896193",
          "1019704772",
          "1031100253",
          "1021814539",
          "1031022317",
          "1014684552",
          "1018505032",
          "1024707024",
          "1026763770",
          "1027674100",
          "1024339955",
          "1027521746",
          "1023563592",
          "1026674344",
          "1023515075",
          "1032996722",
          "1035260697",
          "1024625516",
          "1035567059",
          "1029879109",
          "1017813906",
          "1014474957",
          "1024827976",
          "1018858644",
          "1033417106",
          "1030562717",
          "1014079810",
          "1032812621",
          "1029947279",
          "1021512591",
          "1013557166",
          "1025367499",
          "1020515899",
          "1027694950",
          "1012075133",
          "1025565894",
          "1033169773",
          "1024026329",
          "1034974645",
          "1025403266",
          "1013052951",
          "1026606802",
          "1027418929",
          "1033560731",
          "1029451842",
          "1020126620",
          "1013722566",
          "1014093589",
          "1028236816",
          "1028833520",
          "1018649794",
          "1030820430",
          "1026173604",
          "1026507901",
          "1034137700",
          "1026947588",
          "1026917093",
          "1029894167"
        ]
      },
      {
        "group": "GF4",
        "lot": "6",
        "count": 39328,
        "accounts": [
          "1035950499",
          "1021463906",
          "1030640696",
          "1022489569",
          "1031111611",
          "1033248622",
          "1033223085",
          "1011324318",
          "1034329219",
          "1032822090",
          "1030073457",
          "1033349364",
          "1034311999",
          "1013361482",
          "1029309639",
          "1032872632",
          "1014325870",
          "1029733694",
          "1018527494",
          "1029008248",
          "1023015471",
          "1022479962",
          "1011312751",
          "1028077718",
          "1029313490",
          "1027672612",
          "1024481034",
          "1026343852",
          "1015492320",
          "1031525734",
          "1016547501",
          "1028636725",
          "1012176444",
          "1013332970",
          "1034484656",
          "1014411955",
          "1033200948",
          "1013993241",
          "1021500275",
          "1034713434",
          "1019402407",
          "1024329437",
          "1030338566",
          "1026304253",
          "1032905972",
          "1020593636",
          "1025154827",
          "1021894540",
          "1031152431",
          "1024694283",
          "1025994361",
          "1022968467",
          "1024300544",
          "1027199208",
          "1029220247",
          "1034427512",
          "1035343304",
          "1034171046",
          "1013635892",
          "1034641212",
          "1036031063",
          "1026077397",
          "1026959446",
          "1031391843",
          "1033782912",
          "1012729982",
          "1025186990",
          "1031769501",
          "1018564462",
          "1007606282",
          "1033354724",
          "1020260718",
          "1024824721",
          "1024375315",
          "1026530474",
          "1015770975",
          "1015018122",
          "1028495846",
          "1023877058",
          "1019928190",
          "1035368420",
          "1018842896",
          "1019035595",
          "1032792434",
          "1028918909",
          "1023052067",
          "1033953067",
          "1021135526",
          "1020818808",
          "1018822607",
          "1028122888",
          "1023708671",
          "1025424131",
          "1032384581",
          "1030400784",
          "1025082095",
          "1025114981",
          "1033281425",
          "1027108717",
          "1033611123"
        ]
      }
    ]
  },
  "lot_flag_matrix": {
    "lots": [
      "1",
      "2",
      "3",
      "4",
      "5",
      "6"
    ],
    "flags": [
      1,
      2,
      3,
      4
    ],
    "matrix": [
      {
        "lot": "1",
        "flag": 1,
        "count": 519938,
        "accounts": [
          "2008553930",
          "1049074629",
          "2010517083",
          "1042998434",
          "1042111057",
          "1052202624",
          "1045921416",
          "1048839656",
          "1051698278",
          "1090257509",
          "1090215571",
          "1043679839",
          "1042353735",
          "1050705904",
          "1010686771",
          "1011180014",
          "1039221653",
          "1039714501",
          "1047462257",
          "1009457543",
          "1047306409",
          "1010073648",
          "1039664989",
          "1039297870",
          "1009385127",
          "1048540715",
          "1043853707",
          "5002289789",
          "9100033052",
          "1041620705",
          "1039695957",
          "1047465272",
          "1046215817",
          "1010337718",
          "1048856380",
          "1056484263",
          "1047487837",
          "1056458319",
          "1091403479",
          "1037316703",
          "1046806564",
          "1008316245",
          "1041777345",
          "1046186329",
          "1050479610",
          "1049037014",
          "1009656848",
          "1053326815",
          "1051284201",
          "1048967441",
          "1050139844",
          "1008078514",
          "1010584383",
          "1048609588",
          "1038829127",
          "1044258047",
          "1052441440",
          "5001961211",
          "1042995524",
          "9100237210",
          "1048947971",
          "9200001872",
          "1044296666",
          "1041244398",
          "1045200352",
          "1041517467",
          "1044725923",
          "1038998271",
          "5002305695",
          "1056483041",
          "1052388922",
          "2009463129",
          "1037811607",
          "1044642297",
          "1055103635",
          "5002271960",
          "1050225007",
          "1044193034",
          "1049163222",
          "1049281675",
          "1046232916",
          "1047830655",
          "1043266267",
          "9100050211",
          "5001569907",
          "1091594622",
          "1042779457",
          "1044436514",
          "1054206821",
          "1041833040",
          "1050360540",
          "1040065198",
          "1056166584",
          "1008518387",
          "5001391822",
          "1040880401",
          "1050364481",
          "9100062434",
          "1045343102",
          "1051764726"
        ]
      },
      {
        "lot": "1",
        "flag": 2,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "1",
        "flag": 3,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "1",
        "flag": 4,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "2",
        "flag": 1,
        "count": 424963,
        "accounts": [
          "1043430563",
          "1044983981",
          "1051720788",
          "1090104915",
          "1055193359",
          "1056146362",
          "1005224137",
          "5001180910",
          "1052913377",
          "5090031059",
          "9100202750",
          "1053540450",
          "1004761082",
          "1042913234",
          "1037322495",
          "1050381629",
          "1055081798",
          "1004138768",
          "1006825312",
          "1045405612",
          "1038651662",
          "9100293510",
          "9100259902",
          "9100296127",
          "5000639936",
          "1047635828",
          "1049648498",
          "5000933699",
          "1051620007",
          "1055406247",
          "1049101634",
          "1005128669",
          "2000027717",
          "1091527488",
          "1045880442",
          "1054210829",
          "1048249794",
          "1053423551",
          "1056371951",
          "1048267547",
          "1037726103",
          "9100435306",
          "1044966181",
          "1054403481",
          "1050072677",
          "1042625859",
          "9100156498",
          "1038435021",
          "1010668498",
          "5000375289",
          "1053264674",
          "1045031577",
          "5000231694",
          "1039302866",
          "1091403436",
          "1045882097",
          "1090043134",
          "1045934720",
          "1008568325",
          "1001463374",
          "1090520293",
          "1039012035",
          "9100208604",
          "2009495020",
          "1051102359",
          "1054576831",
          "1002180864",
          "1008197300",
          "1050390121",
          "1047794977",
          "5000770447",
          "1091250869",
          "1004275625",
          "1091354931",
          "9100010483",
          "1044579757",
          "1055346171",
          "1002165458",
          "1040722598",
          "1053616708",
          "1008590746",
          "1007045124",
          "1091083628",
          "9100145434",
          "5002396836",
          "9100207820",
          "9100270407",
          "1091571029",
          "9100180791",
          "1053895003",
          "1043806377",
          "1005704821",
          "5002337899",
          "1054494851",
          "1010916319",
          "1037442849",
          "1091351789",
          "2000294138",
          "1046931520",
          "9100308153"
        ]
      },
      {
        "lot": "2",
        "flag": 2,
        "count": 1,
        "accounts": [
          "1042888175"
        ]
      },
      {
        "lot": "2",
        "flag": 3,
        "count": 3695,
        "accounts": [
          "2008283003",
          "2009716647",
          "2010800818",
          "1042874123",
          "2009723910",
          "2008530000",
          "1042244820",
          "1039122205",
          "2008982122",
          "2008959082",
          "2010997840",
          "2009700732",
          "2008984095",
          "2000128106",
          "1008555916",
          "2008877728",
          "2009997387",
          "2008993698",
          "2010761928",
          "2010829867",
          "2009575318",
          "2009770749",
          "2010827279",
          "2009652681",
          "2010786831",
          "2008903745",
          "2008234541",
          "1006577971",
          "2009660250",
          "1042043817",
          "2009485319",
          "2009110110",
          "2008902218",
          "2010982436",
          "2010605853",
          "2008981169",
          "1008284823",
          "2008967735",
          "2010074823",
          "2010232305",
          "2009719735",
          "2010783190",
          "2000311733",
          "2010960858",
          "2009511794",
          "2008947734",
          "2008427234",
          "2008967131",
          "2008574806",
          "2009614461",
          "2010271807",
          "2008789934",
          "2009652703",
          "2009622898",
          "2008874176",
          "2008683095",
          "1009663119",
          "2011013763",
          "2008970221",
          "1009718487",
          "2009809254",
          "2010600193",
          "2009765427",
          "2010982517",
          "2009856147",
          "1008867357",
          "2010618017",
          "2010989910",
          "2009615859",
          "2010799348",
          "2010604520",
          "2000400523",
          "2000270999",
          "2008818624",
          "2008957578",
          "1003924719",
          "2008620395",
          "2009483731",
          "2000363644",
          "2008761207",
          "2010819667",
          "2000246923",
          "2007980525",
          "2008974588",
          "2010854853",
          "2009209923",
          "1039664849",
          "2008381595",
          "2008975916",
          "2008729583",
          "2009114892",
          "2010883314",
          "2008974790",
          "2009002008",
          "2008961168",
          "1037741722",
          "2008776255",
          "2009407458",
          "2010448111",
          "2008882659"
        ]
      },
      {
        "lot": "2",
        "flag": 4,
        "count": 4,
        "accounts": [
          "1007688149",
          "1010937820",
          "1008485055",
          "1007695935"
        ]
      },
      {
        "lot": "3",
        "flag": 1,
        "count": 572364,
        "accounts": [
          "9100096767",
          "5001060184",
          "1052305687",
          "1041987986",
          "1044448423",
          "1008637793",
          "1043722408",
          "5000863917",
          "5001612020",
          "1042094241",
          "1002891892",
          "1040123260",
          "1049845668",
          "1045885371",
          "1050831314",
          "1043121102",
          "1050920341",
          "1040496695",
          "5090045173",
          "9100110264",
          "1048924548",
          "1038986966",
          "1038853311",
          "1041509367",
          "1051836395",
          "1047793784",
          "1043428666",
          "1041470959",
          "1000684911",
          "1051153891",
          "1042644551",
          "5000818717",
          "1037583388",
          "1053396147",
          "1010501607",
          "1052317316",
          "1091067088",
          "1037984617",
          "5002298753",
          "1045205362",
          "5001271983",
          "1048170098",
          "1050857038",
          "1008254789",
          "1007513357",
          "1004385447",
          "1048915824",
          "5002448046",
          "1044062797",
          "1051762138",
          "5000149963",
          "1043487298",
          "1046477021",
          "1008363316",
          "1004493681",
          "1042474095",
          "1048116379",
          "1047557258",
          "1008769444",
          "1039725368",
          "1045807028",
          "1038977649",
          "1050797035",
          "5000838920",
          "1047557061",
          "1046787470",
          "5000118197",
          "1044277238",
          "1041766068",
          "1091280695",
          "5001670063",
          "1047641178",
          "1052287956",
          "1048772535",
          "1042889414",
          "1003996930",
          "1041407696",
          "1008920622",
          "1042310521",
          "1048848507",
          "1091151275",
          "9100010406",
          "1009890492",
          "1005883106",
          "1049884191",
          "1090764141",
          "1037853474",
          "1046419706",
          "1008753092",
          "1038474221",
          "1043271376",
          "1042814112",
          "1044015551",
          "2000036546",
          "1038575826",
          "1041349815",
          "5001682355",
          "9200017799",
          "1044554924",
          "1008279447"
        ]
      },
      {
        "lot": "3",
        "flag": 2,
        "count": 0,
        "accounts": []
      },
      {
        "lot": "3",
        "flag": 3,
        "count": 42,
        "accounts": [
          "2000105750",
          "1001894561",
          "1000232301",
          "2000164048",
          "2000117406",
          "2000197159",
          "1004482434",
          "2000079148",
          "2000295274",
          "2000096107",
          "2000216625",
          "2000102077",
          "2000135471",
          "2000001580",
          "1000590445",
          "2000271103",
          "2000178030",
          "2000272967",
          "2000256465",
          "1040982581",
          "2000350038",
          "2000242626",
          "2000030750",
          "2000228313",
          "2000102018",
          "2000120334",
          "2000372791",
          "2007898926",
          "1000055566",
          "2000111920",
          "2000131654",
          "2000366112",
          "2007900815",
          "2000303285",
          "2000349226",
          "2000051944",
          "2000374123",
          "1010054708",
          "1040082572",
          "1008167797",
          "1040782191",
          "2000125905"
        ]
      },
      {
        "lot": "3",
        "flag": 4,
        "count": 202061,
        "accounts": [
          "1023009021",
          "1038228018",
          "1090082237",
          "1009802909",
          "1013651421",
          "1036691829",
          "2011004578",
          "1032649313",
          "1039196659",
          "1007162465",
          "1008322490",
          "1002657725",
          "1036518558",
          "1002499976",
          "1022896601",
          "1023437422",
          "1034767542",
          "2009678249",
          "1001677714",
          "1018588191",
          "1006198644",
          "1002758351",
          "1034417649",
          "1035034352",
          "1013494032",
          "1002171369",
          "1016411286",
          "1024132013",
          "1020902132",
          "1015907717",
          "1033103403",
          "1016195907",
          "1002907128",
          "1003268323",
          "1005511551",
          "2010480457",
          "2010066057",
          "2010445694",
          "1035616068",
          "1007043180",
          "1009204572",
          "1016941269",
          "1022899511",
          "1036637166",
          "1005520100",
          "1090068730",
          "1034976869",
          "1038128951",
          "1021494658",
          "2010849469",
          "2008434079",
          "1007667761",
          "1013587464",
          "1000023605",
          "1002421233",
          "1031284931",
          "1037321375",
          "1035538717",
          "2000296351",
          "2010825780",
          "1005640122",
          "2008555887",
          "1030165548",
          "1036482960",
          "2010670809",
          "1023611082",
          "1032318368",
          "1005804109",
          "1036071006",
          "1036017273",
          "1011498065",
          "1024513971",
          "1000699579",
          "1007945516",
          "2000323162",
          "1016208006",
          "1024613771",
          "1034817833",
          "1001267680",
          "1008910899",
          "1023466031",
          "2010814762",
          "1037108671",
          "1031390596",
          "1035045885",
          "1026385008",
          "1024321339",
          "1029418713",
          "1000463818",
          "1036312062",
          "1004059132",
          "1040299784",
          "2008514684",
          "1020928719",
          "1033110728",
          "1001542258",
          "1019147539",
          "1035857774",
          "1009998285",
          "2010816862"
        ]
      },
      {
        "lot": "4",
        "flag": 1,
        "count": 681485,
        "accounts": [
          "1008464775",
          "1021246905",
          "1006391290",
          "1036630706",
          "1029607133",
          "1003668909",
          "1006255524",
          "1036565823",
          "1002176166",
          "1033927724",
          "1000952940",
          "1004102216",
          "1053286120",
          "1007479809",
          "1091109341",
          "1090563634",
          "1051208432",
          "2011004292",
          "2008212009",
          "1035551489",
          "1033452823",
          "1004589751",
          "1031460160",
          "1050414349",
          "1043201890",
          "1026687438",
          "1049746104",
          "1006962042",
          "1003130305",
          "1054948968",
          "1005035121",
          "1001964934",
          "1026542030",
          "1034006487",
          "1002108225",
          "1005843104",
          "1048259897",
          "1025796357",
          "1037679318",
          "1027384102",
          "1007381108",
          "1009829718",
          "1031195599",
          "5002242421",
          "9100006780",
          "1024178293",
          "1052440932",
          "1006919627",
          "5000596056",
          "1034440969",
          "1055331654",
          "1035827425",
          "1005866953",
          "1002082773",
          "9100020458",
          "1037976290",
          "1036266222",
          "1049546911",
          "9100180744",
          "1038591481",
          "1028976658",
          "1000051757",
          "1001135628",
          "1005491682",
          "5001628032",
          "1001598792",
          "1001916395",
          "1007011548",
          "1001115481",
          "1008425303",
          "1039260012",
          "1001634209",
          "1051844576",
          "1002680395",
          "1002014875",
          "1005781087",
          "1052343503",
          "1030247943",
          "1090978478",
          "1005073082",
          "1051564603",
          "1037192702",
          "9200048243",
          "1033633313",
          "1047445832",
          "1007549300",
          "1000709590",
          "5000546091",
          "1004688008",
          "1019382600",
          "1028402643",
          "1027602770",
          "1029648670",
          "1006705945",
          "1043158847",
          "1036568083",
          "1002614171",
          "1049043901",
          "1035881837",
          "1051029988"
        ]
      },
      {
        "lot": "4",
        "flag": 2,
        "count": 913,
        "accounts": [
          "1028642709",
          "1028343698",
          "1024944387",
          "1016724616",
          "1013565355",
          "1026704499",
          "1029674507",
          "1016942427",
          "1022536508",
          "1022750399",
          "1015581870",
          "1026684838",
          "1011389770",
          "1019941154",
          "1021213675",
          "1016432429",
          "1023207834",
          "1017678502",
          "1030550646",
          "1016197055",
          "1035750791",
          "1021510742",
          "1030665818",
          "1017799016",
          "1032395109",
          "1017220654",
          "1027842984",
          "1016426925",
          "1023388596",
          "1023064413",
          "1035573938",
          "1013809459",
          "1031225048",
          "1023248409",
          "1020466529",
          "1025594282",
          "1034963716",
          "1025556852",
          "1019065761",
          "1021225703",
          "1026935598",
          "1015895824",
          "1013407733",
          "1023732033",
          "1012858480",
          "1018640436",
          "1031805311",
          "1022306847",
          "1035441349",
          "1027834779",
          "1028328532",
          "1017189102",
          "1024809439",
          "1024968723",
          "1024617009",
          "1029503559",
          "1014012619",
          "1032553898",
          "1013907833",
          "1030499047",
          "1028626096",
          "1031394036",
          "1037200144",
          "1012799654",
          "1022603825",
          "1028195052",
          "1026614309",
          "1011301938",
          "1017157367",
          "1011746603",
          "1018241795",
          "1029813728",
          "1024830098",
          "1018526447",
          "1021999296",
          "1030732264",
          "1019603518",
          "1020204540",
          "1013574249",
          "1019108762",
          "1012467856",
          "1017770301",
          "1015395171",
          "1028913990",
          "1021644501",
          "1022680447",
          "1017686076",
          "1019387157",
          "1018470425",
          "1025502760",
          "1014816661",
          "1019852313",
          "1027806600",
          "1021707414",
          "1036925218",
          "1016106815",
          "1021952672",
          "1019167556",
          "1024531783",
          "1013029232"
        ]
      },
      {
        "lot": "4",
        "flag": 3,
        "count": 196935,
        "accounts": [
          "1037643453",
          "1015034683",
          "1022485342",
          "1019749423",
          "1037257286",
          "1020133295",
          "1026467144",
          "1032843284",
          "1021322709",
          "1003946569",
          "1017508658",
          "1031526552",
          "1032820942",
          "2010479262",
          "1031525718",
          "1030312109",
          "1034232657",
          "1036860116",
          "1019007281",
          "1016302932",
          "1017359989",
          "1001846524",
          "1020504501",
          "1006887113",
          "1027868908",
          "1029365237",
          "1016498004",
          "2010777913",
          "1000186679",
          "1033918741",
          "1014000556",
          "1034592009",
          "1000038181",
          "1005357102",
          "1030001790",
          "1003609279",
          "1001676939",
          "1011851369",
          "1037046641",
          "1014498473",
          "1022352695",
          "1013633407",
          "1004268440",
          "2009475062",
          "1007316403",
          "1029059144",
          "1033386235",
          "1031623299",
          "1031554890",
          "1039141870",
          "2010675819",
          "2008376745",
          "1000024504",
          "1032397152",
          "1033920770",
          "1018143009",
          "2000363210",
          "1022913565",
          "1017741123",
          "1033479748",
          "1011718537",
          "1018517618",
          "1005588961",
          "1027183956",
          "1021662836",
          "1007526505",
          "1005216991",
          "1035275406",
          "1015219403",
          "1036168034",
          "1024012484",
          "1018240004",
          "1033388173",
          "1002271746",
          "1029826277",
          "1026535522",
          "1005781125",
          "1034384821",
          "2000255302",
          "1016838638",
          "1004545541",
          "1007537639",
          "1036131025",
          "1016435894",
          "1006197788",
          "1010324349",
          "1015602363",
          "1014366070",
          "1019579099",
          "1004268947",
          "1034906283",
          "1001991168",
          "1001436911",
          "1018148183",
          "1007781629",
          "1034483447",
          "1012083160",
          "1023759578",
          "1028084609",
          "1015562132"
        ]
      },
      {
        "lot": "4",
        "flag": 4,
        "count": 260285,
        "accounts": [
          "1024808955",
          "1037217616",
          "1023132478",
          "1017694176",
          "1026966655",
          "1016734964",
          "1032892714",
          "1023321564",
          "1032724668",
          "1034041797",
          "1013258045",
          "1014381800",
          "1034607502",
          "1013084357",
          "1023368633",
          "1013256409",
          "1031245383",
          "1033195871",
          "1032147768",
          "1028570929",
          "1011402599",
          "1015750516",
          "1011393727",
          "1012172481",
          "1014121213",
          "1013599217",
          "1027050298",
          "1016386850",
          "1013206126",
          "1032333820",
          "1022690221",
          "1032996064",
          "1017647798",
          "1018792503",
          "1029540322",
          "1024770079",
          "1013921313",
          "1029712670",
          "1017524637",
          "1016880480",
          "1032518162",
          "1031606467",
          "1024684725",
          "1015782647",
          "1017095825",
          "1025970748",
          "1032076402",
          "1019790105",
          "1016913400",
          "1016305842",
          "1029553394",
          "1017507864",
          "1034508555",
          "1019527005",
          "1030138680",
          "1031439676",
          "1011586819",
          "1014165008",
          "1030981973",
          "1015659888",
          "1015377009",
          "1029567468",
          "1011253690",
          "1030240701",
          "1011840634",
          "1017306206",
          "1019379634",
          "1022269658",
          "1014510325",
          "1037171411",
          "1011729555",
          "1014325013",
          "1011705656",
          "1014578027",
          "1012278638",
          "1019619643",
          "1017092419",
          "1021721913",
          "1036751074",
          "1034711369",
          "1025588916",
          "1029069050",
          "1012490580",
          "1020579501",
          "1019935251",
          "1032642459",
          "1030391254",
          "1031971386",
          "1015954146",
          "1030762589",
          "1018696369",
          "1022710397",
          "1031591249",
          "1032725931",
          "1031363831",
          "1012617270",
          "1029733953",
          "1033800597",
          "1016501870",
          "1014646421"
        ]
      },
      {
        "lot": "5",
        "flag": 1,
        "count": 389451,
        "accounts": [
          "1043919341",
          "1002134277",
          "2010552237",
          "1040191851",
          "1035042908",
          "1003704794",
          "5002304826",
          "1003946992",
          "1056499326",
          "1033880302",
          "1044163348",
          "1051909953",
          "1041065620",
          "1047504847",
          "1001971183",
          "1039413633",
          "1041136242",
          "1044151358",
          "1004846991",
          "1001974743",
          "1090400794",
          "5090057902",
          "1010505114",
          "1042840199",
          "1039403972",
          "1045948411",
          "1041347456",
          "1007105526",
          "1006571655",
          "1034180584",
          "1009111906",
          "1045513563",
          "1005936102",
          "1038165458",
          "1090927962",
          "1043362347",
          "1004847408",
          "1000822524",
          "1001332113",
          "1024356051",
          "1048216039",
          "5000434617",
          "1009684876",
          "1049604806",
          "1052824951",
          "1090763609",
          "1000348695",
          "1035897636",
          "1046553615",
          "1045249335",
          "1042997934",
          "5000293665",
          "5000723406",
          "1007219009",
          "1009628739",
          "1034125958",
          "1052630146",
          "1000027384",
          "1001159950",
          "1038064163",
          "1051161231",
          "1037898451",
          "1043839208",
          "1046530860",
          "1044818875",
          "1042148295",
          "1090611132",
          "2008534502",
          "5000196724",
          "1007374187",
          "1047332019",
          "1003928307",
          "1043488375",
          "1048312755",
          "1050843908",
          "2000041973",
          "5000559355",
          "1038088356",
          "1047364913",
          "1000037606",
          "1049977181",
          "1038920914",
          "9200033851",
          "1041837348",
          "1041166516",
          "1090159183",
          "1001612299",
          "1049367073",
          "1044275065",
          "2010191455",
          "1038476348",
          "1045567426",
          "1041113374",
          "1040178979",
          "1045987565",
          "1042788898",
          "1038489253",
          "1052730884",
          "1039243649",
          "1005508496"
        ]
      },
      {
        "lot": "5",
        "flag": 2,
        "count": 116,
        "accounts": [
          "1026945356",
          "1025257758",
          "1016289065",
          "1011404044",
          "1023016990",
          "1026496306",
          "1012533034",
          "1014629616",
          "1018241469",
          "1029672652",
          "1026358221",
          "1031414657",
          "1023089599",
          "1020498528",
          "1027314449",
          "1020765933",
          "1030370168",
          "1017503362",
          "1025586778",
          "1013110188",
          "1029864993",
          "1033125318",
          "1025630750",
          "1019471093",
          "1029932360",
          "1022769359",
          "1014796970",
          "1016389620",
          "1016244320",
          "1015249515",
          "1027655025",
          "1025322967",
          "1025619048",
          "1025614852",
          "1015285791",
          "1030554994",
          "1025520211",
          "1023835770",
          "1021439630",
          "1029156182",
          "1022921266",
          "1029449155",
          "1025640802",
          "1019761830",
          "1032947543",
          "1021815020",
          "1020472308",
          "1025931491",
          "1028498594",
          "1013020634",
          "1021474134",
          "1027567215",
          "1018729569",
          "1027780768",
          "1021530859",
          "1023353083",
          "1025978463",
          "1020599944",
          "1028070438",
          "1022966588",
          "1024833194",
          "1017265615",
          "1028670354",
          "1031376143",
          "1029395349",
          "1022912445",
          "1020729767",
          "1019538600",
          "1020891912",
          "1017096031",
          "1019655259",
          "1028319800",
          "1020347341",
          "1030224366",
          "1028372019",
          "1012539989",
          "1028683502",
          "1021192945",
          "1019437480",
          "1029138141",
          "1020831359",
          "1014426375",
          "1026009839",
          "1025183983",
          "1020701757",
          "1032821264",
          "1014992893",
          "1022606387",
          "1018841644",
          "1015791875",
          "1037261054",
          "1021219967",
          "1011412772",
          "1020361239",
          "1022714724",
          "1022336959",
          "1016318995",
          "1017527504",
          "1028978413",
          "1015791883"
        ]
      },
      {
        "lot": "5",
        "flag": 3,
        "count": 193017,
        "accounts": [
          "2008837335",
          "2008262537",
          "1001006194",
          "1005561281",
          "1014571383",
          "1017060347",
          "1004922957",
          "1007451181",
          "1000803759",
          "2010820703",
          "1031390480",
          "1039599699",
          "1014310482",
          "1010650009",
          "1019244097",
          "1026987458",
          "1026867223",
          "1026469058",
          "1030327750",
          "1021368695",
          "1005792305",
          "1022471104",
          "1024587282",
          "1017706107",
          "2008912345",
          "1004742916",
          "1004626401",
          "1023973480",
          "2009904060",
          "1019594748",
          "1027749283",
          "1019603569",
          "1025354486",
          "1025367197",
          "1001857437",
          "1003839282",
          "1016140592",
          "1017414548",
          "1006909575",
          "1027291228",
          "1029789789",
          "1026694248",
          "1002175003",
          "1012217043",
          "1031878181",
          "1003431755",
          "1019495936",
          "1007475811",
          "1001230191",
          "1001675177",
          "1007647434",
          "1037894464",
          "1037018346",
          "1016482930",
          "1034965867",
          "1013631420",
          "1033849707",
          "1027283632",
          "1002661196",
          "1011679302",
          "2008878775",
          "1030601941",
          "1006948619",
          "1017542872",
          "1024254437",
          "1012557847",
          "2008684938",
          "2010918983",
          "1001049942",
          "1027325319",
          "1000124703",
          "1024980391",
          "1013842111",
          "1005590664",
          "1012623718",
          "1027591426",
          "1022064746",
          "1030097402",
          "1000320995",
          "1007252413",
          "1003901484",
          "1004406533",
          "1024721671",
          "1039819613",
          "1035615592",
          "1033210242",
          "2008973093",
          "1002360331",
          "2000273084",
          "1033350559",
          "1029044635",
          "1031976930",
          "1006677747",
          "1027042368",
          "1001077644",
          "1000285472",
          "1005190011",
          "1029707006",
          "1021314072",
          "1033142077"
        ]
      },
      {
        "lot": "5",
        "flag": 4,
        "count": 49739,
        "accounts": [
          "1015816630",
          "1020777206",
          "1023994992",
          "1035309432",
          "1021128139",
          "1018401350",
          "1017767777",
          "1014792037",
          "1033178063",
          "1019958235",
          "1023911248",
          "1019287675",
          "1019902426",
          "1015485162",
          "1028276028",
          "1017195579",
          "1027687849",
          "1018586113",
          "1018678328",
          "1019866136",
          "1027270506",
          "1015556647",
          "1022499068",
          "1029615551",
          "1035037688",
          "1034956817",
          "1015680658",
          "1022167561",
          "1013291506",
          "1024903192",
          "1034825151",
          "1014688736",
          "1026863422",
          "1026180430",
          "1016769059",
          "1034570056",
          "1032435631",
          "1023170337",
          "1021075612",
          "1018247181",
          "1025210166",
          "1012690725",
          "1026896193",
          "1019704772",
          "1031100253",
          "1021814539",
          "1031022317",
          "1014684552",
          "1018505032",
          "1024707024",
          "1026763770",
          "1027674100",
          "1024339955",
          "1027521746",
          "1023563592",
          "1026674344",
          "1023515075",
          "1032996722",
          "1035260697",
          "1024625516",
          "1035567059",
          "1029879109",
          "1017813906",
          "1014474957",
          "1024827976",
          "1018858644",
          "1033417106",
          "1030562717",
          "1014079810",
          "1032812621",
          "1029947279",
          "1021512591",
          "1013557166",
          "1025367499",
          "1020515899",
          "1027694950",
          "1012075133",
          "1025565894",
          "1033169773",
          "1024026329",
          "1034974645",
          "1025403266",
          "1013052951",
          "1026606802",
          "1027418929",
          "1033560731",
          "1029451842",
          "1020126620",
          "1013722566",
          "1014093589",
          "1028236816",
          "1028833520",
          "1018649794",
          "1030820430",
          "1026173604",
          "1026507901",
          "1034137700",
          "1026947588",
          "1026917093",
          "1029894167"
        ]
      },
      {
        "lot": "6",
        "flag": 1,
        "count": 517517,
        "accounts": [
          "1050945956",
          "1025929799",
          "1003545939",
          "5001433916",
          "1056497959",
          "1029282234",
          "5001545811",
          "9100006924",
          "1006223754",
          "1051304393",
          "1044065362",
          "1049741382",
          "1053365071",
          "1056505075",
          "1050096401",
          "5000226674",
          "1008974056",
          "1050270878",
          "1040185304",
          "1054499985",
          "1037393066",
          "1034154265",
          "1028308817",
          "5001751640",
          "9200060287",
          "1008347760",
          "5002259146",
          "1006095551",
          "1038812151",
          "9100173161",
          "1001943775",
          "1022216368",
          "5001325072",
          "1043558322",
          "1028373651",
          "5002120938",
          "1029753776",
          "1049190114",
          "5090106709",
          "1055013334",
          "1054452881",
          "1042122288",
          "1052582222",
          "5000078020",
          "1023028492",
          "9200069282",
          "1055330186",
          "1015788629",
          "1023058324",
          "1025612019",
          "1056505466",
          "1054509336",
          "1002672295",
          "2010812271",
          "1000738566",
          "1007475196",
          "5000411749",
          "9200216806",
          "2000149537",
          "1039130003",
          "1052074758",
          "1023872625",
          "1042062811",
          "5000055810",
          "1009440780",
          "5000178300",
          "9100134994",
          "1035439077",
          "1046675354",
          "1008819735",
          "9200122126",
          "1053514980",
          "1055716335",
          "1091192850",
          "1010315587",
          "1054084017",
          "9200157793",
          "1022071416",
          "1024115828",
          "1048531104",
          "5000252322",
          "1028340583",
          "1029724423",
          "5001924030",
          "1003671985",
          "9100059016",
          "1054971161",
          "1000041522",
          "1056507430",
          "1009461788",
          "1002306361",
          "1033165913",
          "1032480343",
          "1052014208",
          "1020238232",
          "1052828310",
          "1050922913",
          "1007270292",
          "9100093156",
          "1007023694"
        ]
      },
      {
        "lot": "6",
        "flag": 2,
        "count": 591,
        "accounts": [
          "1019998334",
          "1012141632",
          "1031205977",
          "1013367472",
          "1026392535",
          "1018782931",
          "1025731840",
          "1019631503",
          "1028216033",
          "1015843662",
          "1013706633",
          "1019189746",
          "1016284217",
          "1022953680",
          "1015564860",
          "1012816966",
          "1024825590",
          "1027864422",
          "1022100874",
          "1021291315",
          "1020265299",
          "1027214002",
          "1015199569",
          "1016898703",
          "1022471740",
          "1024712141",
          "1011317141",
          "1027621325",
          "1016215355",
          "1013234251",
          "1016314736",
          "1022714899",
          "1014931274",
          "1021995142",
          "1021869090",
          "1017547394",
          "1023209608",
          "1015843182",
          "1016455410",
          "1034882341",
          "1014914779",
          "1017233985",
          "1025347471",
          "1031316728",
          "1028588380",
          "1017211736",
          "1017080208",
          "1011414937",
          "1028586191",
          "1012506762",
          "1016633009",
          "1013602439",
          "1037198484",
          "1023546949",
          "1013367499",
          "1020469269",
          "1013022882",
          "1012646602",
          "1023243490",
          "1012466930",
          "1011677121",
          "1011788764",
          "1017016275",
          "1020984392",
          "1016261985",
          "1020237848",
          "1025583655",
          "1019485906",
          "1017301360",
          "1030475571",
          "1017600732",
          "1021508209",
          "1028525451",
          "1025789946",
          "1023736047",
          "1018674969",
          "1029864950",
          "1017616272",
          "1018016732",
          "1022582259",
          "1014862655",
          "1026262119",
          "1020144440",
          "1024075575",
          "1027144896",
          "1016378572",
          "1027067344",
          "1020601116",
          "1021881260",
          "1012908003",
          "1025909968",
          "1013656121",
          "1021870498",
          "1011500396",
          "1015909574",
          "1012357597",
          "1012713318",
          "1036779769",
          "1032464135",
          "1022215264"
        ]
      },
      {
        "lot": "6",
        "flag": 3,
        "count": 158067,
        "accounts": [
          "1016476787",
          "1018473785",
          "1014109752",
          "1028148712",
          "1029863377",
          "2009435125",
          "2008427692",
          "2000346359",
          "1019575433",
          "1023376458",
          "2000124933",
          "1000110672",
          "1014202795",
          "1041880065",
          "1016380399",
          "1003300170",
          "1019420146",
          "2009607678",
          "1023888769",
          "1022328964",
          "1024799751",
          "2000145337",
          "2009538498",
          "1023027305",
          "1005544328",
          "1018398805",
          "1011689707",
          "1023182203",
          "1018628738",
          "1026117984",
          "1090111423",
          "1021633976",
          "1026058538",
          "1027879101",
          "1022797719",
          "1025584031",
          "1018889175",
          "1017650276",
          "2010374797",
          "2007960575",
          "1005968993",
          "1022132709",
          "1005914877",
          "1028487363",
          "1030575967",
          "1002079748",
          "1003636284",
          "1015367070",
          "1016962606",
          "1026591678",
          "1021523674",
          "1006003541",
          "1024311317",
          "1004428537",
          "1026114616",
          "1031596038",
          "1029396795",
          "1005482195",
          "1014983673",
          "1033663980",
          "1026127610",
          "1020036710",
          "1032321466",
          "1027501788",
          "1029714134",
          "2000296394",
          "2008792544",
          "1010153056",
          "1018940537",
          "1015836127",
          "1034241621",
          "2000092888",
          "1015140785",
          "1029553459",
          "1036805794",
          "2008725146",
          "1029063591",
          "1003422624",
          "1017703612",
          "1023471345",
          "1037352734",
          "1025683579",
          "1012925986",
          "1020904011",
          "1027650716",
          "1024112136",
          "1021408018",
          "1013276191",
          "1021719994",
          "1026388287",
          "1016243839",
          "1025012399",
          "1023216264",
          "2008592448",
          "1020730447",
          "2007990261",
          "1000991148",
          "1034829432",
          "1027020461",
          "2008903974"
        ]
      },
      {
        "lot": "6",
        "flag": 4,
        "count": 39328,
        "accounts": [
          "1035950499",
          "1021463906",
          "1030640696",
          "1022489569",
          "1031111611",
          "1033248622",
          "1033223085",
          "1011324318",
          "1034329219",
          "1032822090",
          "1030073457",
          "1033349364",
          "1034311999",
          "1013361482",
          "1029309639",
          "1032872632",
          "1014325870",
          "1029733694",
          "1018527494",
          "1029008248",
          "1023015471",
          "1022479962",
          "1011312751",
          "1028077718",
          "1029313490",
          "1027672612",
          "1024481034",
          "1026343852",
          "1015492320",
          "1031525734",
          "1016547501",
          "1028636725",
          "1012176444",
          "1013332970",
          "1034484656",
          "1014411955",
          "1033200948",
          "1013993241",
          "1021500275",
          "1034713434",
          "1019402407",
          "1024329437",
          "1030338566",
          "1026304253",
          "1032905972",
          "1020593636",
          "1025154827",
          "1021894540",
          "1031152431",
          "1024694283",
          "1025994361",
          "1022968467",
          "1024300544",
          "1027199208",
          "1029220247",
          "1034427512",
          "1035343304",
          "1034171046",
          "1013635892",
          "1034641212",
          "1036031063",
          "1026077397",
          "1026959446",
          "1031391843",
          "1033782912",
          "1012729982",
          "1025186990",
          "1031769501",
          "1018564462",
          "1007606282",
          "1033354724",
          "1020260718",
          "1024824721",
          "1024375315",
          "1026530474",
          "1015770975",
          "1015018122",
          "1028495846",
          "1023877058",
          "1019928190",
          "1035368420",
          "1018842896",
          "1019035595",
          "1032792434",
          "1028918909",
          "1023052067",
          "1033953067",
          "1021135526",
          "1020818808",
          "1018822607",
          "1028122888",
          "1023708671",
          "1025424131",
          "1032384581",
          "1030400784",
          "1025082095",
          "1025114981",
          "1033281425",
          "1027108717",
          "1033611123"
        ]
      }
    ]
  },
  "metadata": {
    "generated_at": "2025-10-03T03:11:16.170015",
    "total_accounts": 4210512,
    "total_groups": 4,
    "total_lots": 6,
    "lot5_consolidated": true,
    "has_group_flags": true
  }
};
        
        let currentColorScheme = 'pantone';
        let cellSizeValue = 50;
        let svg1 = null;
        let svg2 = null;
        
        const colorSchemes = {
            pantone: {
                scale: d3.scaleSequential()
                    .interpolator(d3.interpolateRgbBasis([
                        '#0F4C81',
                        '#6667AB',
                        '#BB2649',
                        '#FFBE98',
                        '#F5DF4D'
                    ]))
            },
            heat: {
                scale: d3.scaleSequential(d3.interpolateInferno)
            },
            cool: {
                scale: d3.scaleSequential(d3.interpolateBlues)
            },
            vibrant: {
                scale: d3.scaleSequential(d3.interpolateRainbow)
            }
        };
        
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        function switchTab(event, tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-content').classList.add('active');
        }
        
        function initializeGroupLotMatrix() {
            const data = VISUALIZATION_DATA.group_lot_matrix;
            document.getElementById('matrix-viz-1').innerHTML = '';
            
            const margin = {top: 120, right: 50, bottom: 50, left: 150};
            const cellSize = cellSizeValue;
            const width = Math.max(800, data.groups.length * cellSize + margin.left + margin.right);
            const height = Math.max(600, data.lots.length * cellSize + margin.top + margin.bottom);
            
            svg1 = d3.select('#matrix-viz-1')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMinYMin meet');
            
            const xScale = d3.scaleBand()
                .domain(data.groups)
                .range([margin.left, width - margin.right])
                .padding(0.1);
            
            const yScale = d3.scaleBand()
                .domain(data.lots)
                .range([margin.top, height - margin.bottom])
                .padding(0.1);
            
            drawMatrix(svg1, data.matrix, xScale, yScale, 'group', 'lot', false);
            drawAxes(svg1, data.groups, data.lots, xScale, yScale, 'GROUPS →', 'LOTS ↓', margin);
        }
        
        function initializeLotFlagMatrix() {
            const data = VISUALIZATION_DATA.lot_flag_matrix;
            document.getElementById('matrix-viz-2').innerHTML = '';
            
            // Calculate totals
            const lotTotals = {};
            const flagTotals = {1: 0, 2: 0, 3: 0, 4: 0};
            let grandTotal = 0;
            
            data.matrix.forEach(d => {
                if (!lotTotals[d.lot]) lotTotals[d.lot] = 0;
                lotTotals[d.lot] += d.count;
                flagTotals[d.flag] += d.count;
                grandTotal += d.count;
            });
            
            const margin = {top: 120, right: 150, bottom: 80, left: 150};
            const cellSize = cellSizeValue;
            const flagLabels = data.flags.map(f => 'FLAG_' + f);
            const lotsWithTotal = [...data.lots, 'TOTAL'];
            const flagsWithTotal = [...flagLabels, 'TOTAL'];
            
            const width = Math.max(800, flagsWithTotal.length * cellSize + margin.left + margin.right);
            const height = Math.max(600, lotsWithTotal.length * cellSize + margin.top + margin.bottom);
            
            svg2 = d3.select('#matrix-viz-2')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMinYMin meet');
            
            const xScale = d3.scaleBand()
                .domain(flagsWithTotal)
                .range([margin.left, width - margin.right])
                .padding(0.1);
            
            const yScale = d3.scaleBand()
                .domain(lotsWithTotal)
                .range([margin.top, height - margin.bottom])
                .padding(0.1);
            
            // Draw main matrix
            drawMatrix(svg2, data.matrix, xScale, yScale, 'flag', 'lot', true);
            
            // Draw row totals
            data.lots.forEach(lot => {
                const g = svg2.append('g')
                    .attr('transform', `translate(${xScale('TOTAL')}, ${yScale(lot)})`);
                
                g.append('rect')
                    .attr('width', xScale.bandwidth())
                    .attr('height', yScale.bandwidth())
                    .attr('fill', '#2a3456')
                    .attr('stroke', '#F5DF4D')
                    .attr('stroke-width', 2)
                    .attr('rx', 4)
                    .attr('ry', 4);
                
                g.append('text')
                    .attr('x', xScale.bandwidth() / 2)
                    .attr('y', yScale.bandwidth() / 2)
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'middle')
                    .attr('class', 'total-label')
                    .text(formatNumber(lotTotals[lot] || 0));
            });
            
            // Draw column totals
            data.flags.forEach(flag => {
                const g = svg2.append('g')
                    .attr('transform', `translate(${xScale('FLAG_' + flag)}, ${yScale('TOTAL')})`);
                
                g.append('rect')
                    .attr('width', xScale.bandwidth())
                    .attr('height', yScale.bandwidth())
                    .attr('fill', '#2a3456')
                    .attr('stroke', '#F5DF4D')
                    .attr('stroke-width', 2)
                    .attr('rx', 4)
                    .attr('ry', 4);
                
                g.append('text')
                    .attr('x', xScale.bandwidth() / 2)
                    .attr('y', yScale.bandwidth() / 2)
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'middle')
                    .attr('class', 'total-label')
                    .text(formatNumber(flagTotals[flag] || 0));
            });
            
            // Draw grand total
            const grandTotalG = svg2.append('g')
                .attr('transform', `translate(${xScale('TOTAL')}, ${yScale('TOTAL')})`);
            
            grandTotalG.append('rect')
                .attr('width', xScale.bandwidth())
                .attr('height', yScale.bandwidth())
                .attr('fill', '#BB2649')
                .attr('stroke', '#F5DF4D')
                .attr('stroke-width', 3)
                .attr('rx', 4)
                .attr('ry', 4);
            
            grandTotalG.append('text')
                .attr('x', xScale.bandwidth() / 2)
                .attr('y', yScale.bandwidth() / 2)
                .attr('text-anchor', 'middle')
                .attr('dominant-baseline', 'middle')
                .attr('fill', '#ffffff')
                .attr('font-size', '14px')
                .attr('font-weight', '700')
                .text(formatNumber(grandTotal));
            
            drawAxes(svg2, flagsWithTotal, lotsWithTotal, xScale, yScale, 'GROUP FLAGS →', 'LOTS ↓', margin);
        }
        
        function drawMatrix(svg, matrixData, xScale, yScale, xKey, yKey, isFlag = false) {
            const maxCount = d3.max(matrixData, d => d.count);
            const colorScale = colorSchemes[currentColorScheme].scale.domain([0, maxCount]);
            
            const cells = svg.selectAll('.cell-group')
                .data(matrixData)
                .enter()
                .append('g')
                .attr('class', 'cell-group')
                .attr('transform', d => {
                    const xVal = isFlag ? 'FLAG_' + d[xKey] : d[xKey];
                    const yVal = isFlag ? d[yKey] : d[yKey];
                    return `translate(${xScale(xVal)}, ${yScale(yVal)})`;
                });
            
            cells.append('rect')
                .attr('class', 'cell')
                .attr('width', xScale.bandwidth())
                .attr('height', yScale.bandwidth())
                .attr('fill', d => d.count > 0 ? colorScale(d.count) : '#1a1f3a')
                .attr('rx', 4)
                .attr('ry', 4)
                .on('mouseover', showTooltip)
                .on('mousemove', moveTooltip)
                .on('mouseout', hideTooltip)
                .on('click', showDetails);
            
            cells.append('text')
                .attr('x', xScale.bandwidth() / 2)
                .attr('y', yScale.bandwidth() / 2)
                .attr('text-anchor', 'middle')
                .attr('dominant-baseline', 'middle')
                .attr('fill', d => d.count > 0 ? '#ffffff' : '#a0a9c9')
                .attr('font-size', Math.min(14, xScale.bandwidth() / 3) + 'px')
                .attr('font-weight', '600')
                .attr('pointer-events', 'none')
                .text(d => d.count > 0 ? formatNumber(d.count) : '');
        }
        
        function drawAxes(svg, xLabels, yLabels, xScale, yScale, xTitle, yTitle, margin) {
            const labelTooltip = document.getElementById('labelTooltip');
            
            // X-axis labels
            svg.selectAll('.x-label')
                .data(xLabels)
                .enter()
                .append('text')
                .attr('class', d => d === 'TOTAL' ? 'axis-label x-label total-label' : 'axis-label x-label')
                .attr('x', d => xScale(d) + xScale.bandwidth() / 2)
                .attr('y', 90)
                .attr('text-anchor', 'middle')
                .attr('font-size', '11px')
                .text(d => {
                    const maxLen = 15;
                    return d.length > maxLen ? d.substring(0, maxLen) + '...' : d;
                })
                .on('mouseover', function(event, d) {
                    if (d.length > 15) {
                        labelTooltip.textContent = d;
                        labelTooltip.style.left = event.pageX + 'px';
                        labelTooltip.style.top = (event.pageY - 30) + 'px';
                        labelTooltip.classList.add('show');
                    }
                })
                .on('mouseout', function() {
                    labelTooltip.classList.remove('show');
                });
            
            // Y-axis labels
            svg.selectAll('.y-label')
                .data(yLabels)
                .enter()
                .append('text')
                .attr('class', d => d === 'TOTAL' ? 'axis-label y-label total-label' : 'axis-label y-label')
                .attr('x', 130)
                .attr('y', d => yScale(d) + yScale.bandwidth() / 2)
                .attr('text-anchor', 'end')
                .attr('dominant-baseline', 'middle')
                .attr('font-size', '11px')
                .text(d => {
                    const maxLen = 20;
                    return d.length > maxLen ? d.substring(0, maxLen) + '...' : d;
                })
                .on('mouseover', function(event, d) {
                    if (d.length > 20) {
                        labelTooltip.textContent = d;
                        labelTooltip.style.left = event.pageX + 'px';
                        labelTooltip.style.top = event.pageY + 'px';
                        labelTooltip.classList.add('show');
                    }
                })
                .on('mouseout', function() {
                    labelTooltip.classList.remove('show');
                });
            
            // Axis titles
            svg.append('text')
                .attr('x', svg.node().getBBox().width / 2)
                .attr('y', 40)
                .attr('text-anchor', 'middle')
                .attr('fill', '#F5DF4D')
                .attr('font-size', '14px')
                .attr('font-weight', '600')
                .text(xTitle);
            
            svg.append('text')
                .attr('x', -svg.node().getBBox().height / 2)
                .attr('y', 20)
                .attr('text-anchor', 'middle')
                .attr('fill', '#F5DF4D')
                .attr('font-size', '14px')
                .attr('font-weight', '600')
                .attr('transform', 'rotate(-90, 20, 0)')
                .text(yTitle);
        }
        
        function showTooltip(event, d) {
            const tooltip = document.getElementById('tooltip');
            const label1 = d.group || d.lot;
            const label2 = d.lot || ('FLAG_' + d.flag);
            
            tooltip.innerHTML = `
                <h3>${label1} × ${label2}</h3>
                <p class="count">${formatNumber(d.count)} accounts</p>
            `;
            tooltip.classList.add('show');
        }
        
        function moveTooltip(event) {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
        }
        
        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }
        
        function showDetails(event, d) {
            const label1 = d.group || d.lot;
            const label2 = d.lot || ('FLAG_' + d.flag);
            const accountList = d.accounts ? d.accounts.join('\n') : 'No accounts available';
            alert(`Details for ${label1} × ${label2}:\n\nTotal Accounts: ${formatNumber(d.count)}\n\nAccounts (showing first 100):\n${accountList.substring(0, 1000)}${accountList.length > 1000 ? '\n...' : ''}`);
        }
        
        function updateStatistics() {
            const metadata = VISUALIZATION_DATA.metadata;
            
            animateCounter('totalAccounts', metadata.total_accounts);
            animateCounter('totalGroups', metadata.total_groups);
            animateCounter('totalLots', metadata.total_lots);
        }
        
        function animateCounter(id, target) {
            const element = document.getElementById(id);
            const duration = 1000;
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                element.textContent = formatNumber(Math.round(current));
                element.classList.add('updating');
                setTimeout(() => element.classList.remove('updating'), 500);
            }, 16);
        }
        
        function setupEventListeners() {
            document.getElementById('colorScheme').addEventListener('change', (e) => {
                currentColorScheme = e.target.value;
                initializeGroupLotMatrix();
                initializeLotFlagMatrix();
            });
            
            document.getElementById('cellSize').addEventListener('input', (e) => {
                cellSizeValue = parseInt(e.target.value);
                initializeGroupLotMatrix();
                initializeLotFlagMatrix();
            });
        }
        
        function resetView() {
            document.getElementById('colorScheme').value = 'pantone';
            document.getElementById('cellSize').value = 50;
            currentColorScheme = 'pantone';
            cellSizeValue = 50;
            initializeGroupLotMatrix();
            initializeLotFlagMatrix();
        }
        
        function exportData() {
            let csv = 'Matrix,Row,Column,Count\n';
            
            VISUALIZATION_DATA.group_lot_matrix.matrix.forEach(d => {
                csv += `GROUP×LOT,${d.group},${d.lot},${d.count}\n`;
            });
            
            VISUALIZATION_DATA.lot_flag_matrix.matrix.forEach(d => {
                csv += `LOT×FLAG,${d.lot},FLAG_${d.flag},${d.count}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dual_matrix_export.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            initializeGroupLotMatrix();
            initializeLotFlagMatrix();
            updateStatistics();
            setupEventListeners();
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                resetView();
            }
        });
    </script>
</body>
</html>
