<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>อานุภาพของนอแรด | จักรพรรดิแห่งเครื่องรางทนสิทธิ์</title>
    
    <!-- Favicon: SVG Rhino Horn -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='hornGrad' x1='0%25' y1='100%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' style='stop-color:%23654321'/%3E%3Cstop offset='50%25' style='stop-color:%23D4A574'/%3E%3Cstop offset='100%25' style='stop-color:%23F5DEB3'/%3E%3C/linearGradient%3E%3Cfilter id='glow'%3E%3CfeGaussianBlur stdDeviation='2' result='coloredBlur'/%3E%3CfeMerge%3E%3CfeMergeNode in='coloredBlur'/%3E%3CfeMergeNode in='SourceGraphic'/%3E%3C/feMerge%3E%3C/filter%3E%3C/defs%3E%3Cellipse cx='32' cy='58' rx='18' ry='4' fill='%23FFD700' opacity='0.3'/%3E%3Cpath d='M32 8 C28 8 24 20 22 35 C20 50 24 58 32 58 C40 58 44 50 42 35 C40 20 36 8 32 8 Z' fill='url(%23hornGrad)' stroke='%23FFD700' stroke-width='1' filter='url(%23glow)'/%3E%3Cellipse cx='32' cy='10' rx='4' ry='2' fill='%23F5DEB3' opacity='0.8'/%3E%3Cpath d='M26 25 Q32 22 38 25' stroke='%23654321' stroke-width='0.5' fill='none' opacity='0.4'/%3E%3Cpath d='M25 35 Q32 32 39 35' stroke='%23654321' stroke-width='0.5' fill='none' opacity='0.3'/%3E%3Cpath d='M24 45 Q32 42 40 45' stroke='%23654321' stroke-width='0.5' fill='none' opacity='0.2'/%3E%3C/svg%3E">
    
    <!-- External Libraries -->
    <!-- Background animation now uses native Canvas 2D for better performance -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Sarabun:wght@300;400;500;600;700&family=Noto+Serif+Thai:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        @layer base, layout, components, utilities, animations;

        :root {
            /* Pantone 2024-2025 Inspired: Peach Fuzz, Mocha Mousse, Mystical Gold */
            --peach-fuzz: #FFBE98;
            --mocha-mousse: #A47764;
            --mystical-gold: #C9A227;
            --sacred-amber: #D4A574;
            --deep-burgundy: #722F37;
            --temple-bronze: #8B4513;
            --void-black: #0A0A0F;
            --space-deep: #12121A;
            --incense-smoke: rgba(255, 190, 152, 0.1);
            --lotus-pink: #E8B4B8;
            --jade-green: #00A86B;
            --silver-mist: #C0C0C0;
            
            /* Glass Effects */
            --glass-bg: rgba(18, 18, 26, 0.85);
            --glass-border: rgba(201, 162, 39, 0.2);
            --glass-glow: rgba(255, 190, 152, 0.15);
            
            /* Typography */
            --font-thai: 'Sarabun', 'Noto Serif Thai', sans-serif;
            --font-display: 'Cinzel', serif;
            --font-body: 'Inter', sans-serif;
            
            /* Transitions */
            --ease-sacred: cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        @layer base {
            *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
            
            html { scroll-behavior: smooth; }
            
            body {
                background: var(--void-black);
                color: var(--peach-fuzz);
                font-family: var(--font-thai);
                line-height: 1.8;
                overflow-x: hidden;
                min-height: 100vh;
            }
            
            /* i18n Toggle System */
            [lang="en"] { display: none; }
            body[data-lang="en"] [lang="th"] { display: none; }
            body[data-lang="en"] [lang="en"] { display: block; }
            body[data-lang="en"] span[lang="en"],
            body[data-lang="en"] p[lang="en"],
            body[data-lang="en"] h1[lang="en"],
            body[data-lang="en"] h2[lang="en"],
            body[data-lang="en"] h3[lang="en"] { display: inline; }
            
            h1, h2, h3, h4 { 
                font-family: var(--font-thai);
                font-weight: 600;
                letter-spacing: 0.02em;
            }
            
            a { color: var(--mystical-gold); text-decoration: none; transition: color 0.3s; }
            a:hover { color: var(--peach-fuzz); }
            
            ::selection {
                background: var(--mystical-gold);
                color: var(--void-black);
            }
            
            ::-webkit-scrollbar { width: 8px; }
            ::-webkit-scrollbar-track { background: var(--space-deep); }
            ::-webkit-scrollbar-thumb { 
                background: linear-gradient(180deg, var(--mystical-gold), var(--mocha-mousse));
                border-radius: 4px;
            }
        }

        @layer layout {
            .container { max-width: 1440px; margin: 0 auto; padding: 0 1.5rem; position: relative; z-index: 10; }
            .grid { display: grid; gap: 1.5rem; }
            .flex { display: flex; }
            .flex-col { flex-direction: column; }
            .items-center { align-items: center; }
            .justify-center { justify-content: center; }
            .justify-between { justify-content: space-between; }
            .text-center { text-align: center; }
            .relative { position: relative; }
            .absolute { position: absolute; }
            .fixed { position: fixed; }
            .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
            .w-full { width: 100%; }
            .h-screen { height: 100vh; }
            .min-h-screen { min-height: 100vh; }
            .overflow-hidden { overflow: hidden; }
            .z-0 { z-index: 0; }
            .z-10 { z-index: 10; }
            .z-50 { z-index: 50; }
            
            .grid-cols-1 { grid-template-columns: 1fr; }
            .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
            .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
            .col-span-2 { grid-column: span 2; }
            
            @media (max-width: 1024px) {
                .lg-grid-cols-1 { grid-template-columns: 1fr; }
                .lg-col-span-1 { grid-column: span 1; }
            }
            
            @media (max-width: 768px) {
                .md-grid-cols-1 { grid-template-columns: 1fr; }
            }
        }

        @layer components {
            /* Sacred Glass Panels */
            .glass-panel {
                background: var(--glass-bg);
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
                border: 1px solid var(--glass-border);
                border-radius: 16px;
                box-shadow: 
                    0 8px 32px rgba(0, 0, 0, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
                transition: all 0.4s var(--ease-sacred);
            }
            
            .glass-panel:hover {
                border-color: var(--mystical-gold);
                box-shadow: 
                    0 12px 48px rgba(201, 162, 39, 0.15),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
                transform: translateY(-4px);
            }
            
            /* Sacred Header Style */
            .header-sacred {
                border-left: 4px solid var(--mystical-gold);
                padding-left: 1.5rem;
                background: linear-gradient(90deg, var(--glass-glow) 0%, transparent 100%);
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }
            
            /* Mystical Buttons */
            .btn-sacred {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.75rem 1.5rem;
                background: linear-gradient(135deg, var(--mocha-mousse), var(--temple-bronze));
                color: var(--peach-fuzz);
                border: 1px solid var(--mystical-gold);
                border-radius: 8px;
                font-family: var(--font-thai);
                font-weight: 500;
                cursor: pointer;
                transition: all 0.3s var(--ease-sacred);
            }
            
            .btn-sacred:hover {
                background: linear-gradient(135deg, var(--mystical-gold), var(--sacred-amber));
                color: var(--void-black);
                box-shadow: 0 0 30px rgba(201, 162, 39, 0.4);
                transform: translateY(-2px);
            }
            
            /* Data Tables */
            .data-table {
                width: 100%;
                border-collapse: collapse;
                font-size: 0.95rem;
            }
            
            .data-table th {
                text-align: left;
                padding: 1rem;
                background: rgba(201, 162, 39, 0.1);
                color: var(--mystical-gold);
                font-weight: 600;
                border-bottom: 2px solid var(--glass-border);
                position: sticky;
                top: 0;
            }
            
            .data-table td {
                padding: 1rem;
                border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                vertical-align: top;
            }
            
            .data-table tr:nth-child(even) { background: rgba(255, 255, 255, 0.02); }
            .data-table tr:hover { background: rgba(201, 162, 39, 0.05); }
            
            /* Sentiment Badges */
            .badge {
                display: inline-block;
                padding: 4px 12px;
                border-radius: 20px;
                font-size: 0.75rem;
                font-weight: 600;
            }
            
            .badge-elite { 
                background: rgba(201, 162, 39, 0.2); 
                color: var(--mystical-gold); 
                border: 1px solid var(--mystical-gold); 
            }
            .badge-high { 
                background: rgba(0, 168, 107, 0.2); 
                color: var(--jade-green); 
                border: 1px solid var(--jade-green); 
            }
            .badge-rare { 
                background: rgba(232, 180, 184, 0.2); 
                color: var(--lotus-pink); 
                border: 1px solid var(--lotus-pink); 
            }
            
            /* Hero Artifact Display */
            .artifact-showcase {
                position: relative;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 2rem;
            }
            
            .artifact-image {
                max-width: 300px;
                height: auto;
                border-radius: 16px;
                box-shadow: 
                    0 0 60px rgba(201, 162, 39, 0.3),
                    0 0 120px rgba(255, 190, 152, 0.1);
                transition: all 0.5s var(--ease-sacred);
            }
            
            .artifact-image:hover {
                transform: scale(1.05) rotate(2deg);
                box-shadow: 
                    0 0 80px rgba(201, 162, 39, 0.5),
                    0 0 160px rgba(255, 190, 152, 0.2);
            }
            
            /* Aura Ring Effect */
            .aura-ring {
                position: absolute;
                border-radius: 50%;
                border: 2px solid var(--mystical-gold);
                opacity: 0.3;
                animation: pulse-ring 3s ease-out infinite;
            }
            
            @keyframes pulse-ring {
                0% { transform: scale(0.8); opacity: 0.5; }
                100% { transform: scale(2); opacity: 0; }
            }
            
            /* Loading Overlay */
            .loading-overlay {
                position: fixed;
                inset: 0;
                background: var(--void-black);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                transition: opacity 0.8s, visibility 0.8s;
            }
            
            .loading-overlay.hidden {
                opacity: 0;
                visibility: hidden;
                pointer-events: none;
            }
            
            .lotus-spinner {
                width: 80px;
                height: 80px;
                animation: lotus-bloom 2s ease-in-out infinite;
            }
            
            @keyframes lotus-bloom {
                0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
                50% { transform: scale(1.2) rotate(180deg); opacity: 0.7; }
            }
        }

        @layer utilities {
            .p-4 { padding: 1rem; }
            .p-6 { padding: 1.5rem; }
            .p-8 { padding: 2rem; }
            .px-4 { padding-left: 1rem; padding-right: 1rem; }
            .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
            .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
            .py-16 { padding-top: 4rem; padding-bottom: 4rem; }
            .m-4 { margin: 1rem; }
            .mb-2 { margin-bottom: 0.5rem; }
            .mb-4 { margin-bottom: 1rem; }
            .mb-6 { margin-bottom: 1.5rem; }
            .mb-8 { margin-bottom: 2rem; }
            .mt-4 { margin-top: 1rem; }
            .mt-8 { margin-top: 2rem; }
            .gap-4 { gap: 1rem; }
            .gap-6 { gap: 1.5rem; }
            .gap-8 { gap: 2rem; }
            
            .text-xs { font-size: 0.75rem; }
            .text-sm { font-size: 0.875rem; }
            .text-base { font-size: 1rem; }
            .text-lg { font-size: 1.125rem; }
            .text-xl { font-size: 1.25rem; }
            .text-2xl { font-size: 1.5rem; }
            .text-3xl { font-size: 2rem; }
            .text-4xl { font-size: 2.5rem; }
            .text-5xl { font-size: 3rem; }
            
            .font-light { font-weight: 300; }
            .font-normal { font-weight: 400; }
            .font-medium { font-weight: 500; }
            .font-semibold { font-weight: 600; }
            .font-bold { font-weight: 700; }
            
            .text-gold { color: var(--mystical-gold); }
            .text-peach { color: var(--peach-fuzz); }
            .text-mocha { color: var(--mocha-mousse); }
            .text-muted { color: rgba(255, 190, 152, 0.6); }
            .text-jade { color: var(--jade-green); }
            
            .leading-relaxed { line-height: 1.8; }
            .tracking-wide { letter-spacing: 0.05em; }
            
            .rounded { border-radius: 8px; }
            .rounded-lg { border-radius: 12px; }
            .rounded-xl { border-radius: 16px; }
            .rounded-full { border-radius: 9999px; }
            
            .opacity-50 { opacity: 0.5; }
            .opacity-70 { opacity: 0.7; }
            
            .pointer-events-none { pointer-events: none; }
            .cursor-pointer { cursor: pointer; }
            
            .transition-all { transition: all 0.3s var(--ease-sacred); }
        }

        @layer animations {
            .reveal {
                opacity: 0;
                transform: translateY(40px);
                transition: all 0.8s var(--ease-sacred);
            }
            
            .reveal.active {
                opacity: 1;
                transform: translateY(0);
            }
            
            .float {
                animation: float 6s ease-in-out infinite;
            }
            
            @keyframes float {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-20px); }
            }
            
            .glow-pulse {
                animation: glow-pulse 3s ease-in-out infinite;
            }
            
            @keyframes glow-pulse {
                0%, 100% { filter: drop-shadow(0 0 20px rgba(201, 162, 39, 0.3)); }
                50% { filter: drop-shadow(0 0 40px rgba(201, 162, 39, 0.6)); }
            }
            
            .incense-drift {
                animation: incense-drift 8s ease-in-out infinite;
            }
            
            @keyframes incense-drift {
                0%, 100% { transform: translateX(0) translateY(0); opacity: 0.3; }
                25% { transform: translateX(10px) translateY(-20px); opacity: 0.5; }
                50% { transform: translateX(-5px) translateY(-40px); opacity: 0.3; }
                75% { transform: translateX(15px) translateY(-60px); opacity: 0.1; }
            }
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }
        
        .chart-container canvas {
            width: 100% !important;
            height: 100% !important;
        }
        
        /* D3 Network Container */
        #d3-network {
            width: 100%;
            height: 450px;
            background: radial-gradient(ellipse at center, rgba(201, 162, 39, 0.05) 0%, transparent 70%);
            border-radius: 12px;
            overflow: hidden;
        }
        
        #d3-network svg {
            width: 100%;
            height: 100%;
        }
        
        /* Sacred Background Canvas - Antigravity Style Animation */
        #sacred-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: var(--void-black);
        }
        
        /* Cosmic Fog Overlay */
        .cosmic-fog {
            position: fixed;
            inset: 0;
            background: radial-gradient(ellipse at 50% 50%, transparent 0%, var(--void-black) 85%);
            pointer-events: none;
            z-index: 1;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .text-5xl { font-size: 2rem; }
            .text-4xl { font-size: 1.75rem; }
            .text-3xl { font-size: 1.5rem; }
            .p-8 { padding: 1rem; }
            .py-16 { padding-top: 2rem; padding-bottom: 2rem; }
            .artifact-image { max-width: 200px; }
            .grid-cols-2, .grid-cols-3 { grid-template-columns: 1fr; }
            .col-span-2 { grid-column: span 1; }
        }
    </style>
</head>
<body data-lang="th">

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <svg class="lotus-spinner" viewBox="0 0 100 100">
            <defs>
                <linearGradient id="lotusGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#C9A227"/>
                    <stop offset="100%" style="stop-color:#FFBE98"/>
                </linearGradient>
            </defs>
            <circle cx="50" cy="50" r="40" fill="none" stroke="url(#lotusGrad)" stroke-width="3" stroke-dasharray="60 200" stroke-linecap="round"/>
            <circle cx="50" cy="50" r="25" fill="none" stroke="url(#lotusGrad)" stroke-width="2" stroke-dasharray="40 160" stroke-linecap="round" transform="rotate(60 50 50)"/>
            <circle cx="50" cy="50" r="10" fill="url(#lotusGrad)"/>
        </svg>
        <p class="mt-4 text-gold tracking-wide" style="font-family: var(--font-thai);">
            <span lang="th">กำลังเปิดประตูสู่โลกแห่งทนสิทธิ์...</span>
            <span lang="en">Opening the gates to the Thonnasit realm...</span>
        </p>
    </div>

    <!-- Antigravity-Style Interactive Background -->
    <canvas id="sacred-canvas"></canvas>
    <div class="cosmic-fog"></div>

    <!-- Main Content -->
    <div class="relative z-10">
        
        <!-- Navigation Header -->
        <header class="fixed w-full z-50 p-4">
            <nav class="container glass-panel p-4 flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <svg width="40" height="40" viewBox="0 0 64 64" class="glow-pulse">
                        <defs>
                            <linearGradient id="navHornGrad" x1="0%" y1="100%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#654321"/>
                                <stop offset="50%" style="stop-color:#D4A574"/>
                                <stop offset="100%" style="stop-color:#F5DEB3"/>
                            </linearGradient>
                        </defs>
                        <path d="M32 8 C28 8 24 20 22 35 C20 50 24 58 32 58 C40 58 44 50 42 35 C40 20 36 8 32 8 Z" fill="url(#navHornGrad)" stroke="#C9A227" stroke-width="1"/>
                    </svg>
                    <div>
                        <h1 class="text-lg font-semibold text-gold" lang="th">นอแรดทนสิทธิ์</h1>
                        <h1 class="text-lg font-semibold text-gold" lang="en">Thonnasit Rhino Horn</h1>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button id="lang-toggle" class="btn-sacred text-sm">
                        <span lang="th">EN</span>
                        <span lang="en">ไทย</span>
                    </button>
                </div>
            </nav>
        </header>

        <!-- Hero Section -->
        <section class="min-h-screen flex items-center justify-center py-16" style="padding-top: 120px;">
            <div class="container">
                <div class="grid grid-cols-2 md-grid-cols-1 gap-8 items-center">
                    
                    <!-- Hero Text -->
                    <div class="reveal">
                        <p class="text-mocha mb-4 tracking-wide">
                            <span lang="th">จักรพรรดิแห่งเครื่องรางทนสิทธิ์</span>
                            <span lang="en">The Emperor of Thonnasit Amulets</span>
                        </p>
                        <h1 class="text-5xl font-bold text-gold mb-6 leading-relaxed">
                            <span lang="th">อานุภาพของนอแรด</span>
                            <span lang="en">The Mystical Powers of Rhinoceros Horn</span>
                        </h1>
                        <p class="text-lg text-peach leading-relaxed mb-8">
                            <span lang="th">
                                นอแรดจัดเป็น <strong class="text-gold">"ทนสิทธิ์"</strong> (ทน-สิด) หมายถึงวัตถุที่มีฤทธิ์ในตัวเอง 
                                มีเทพสถิตอยู่ภายใน ไม่ต้องผ่านพิธีปลุกเสกจากพระสงฆ์ก็สามารถใช้งานได้ทันที 
                                เป็นสุดยอดเครื่องรางที่หายากและทรงพลังที่สุดในโลกแห่งไสยเวทย์ไทย
                            </span>
                            <span lang="en">
                                Rhinoceros horn is classified as <strong class="text-gold">"Thonnasit"</strong> (Ton-Sit)—an object possessing inherent magical power 
                                with a resident deity dwelling within. It requires no consecration ritual from monks and is immediately potent upon acquisition, 
                                making it the supreme talisman in Thai occult tradition.
                            </span>
                        </p>
                        <div class="flex gap-4">
                            <a href="#powers" class="btn-sacred">
                                <span lang="th">สำรวจอานุภาพ</span>
                                <span lang="en">Explore Powers</span>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M5 12h14M12 5l7 7-7 7"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Artifact Display -->
                    <div class="artifact-showcase reveal">
                        <div class="aura-ring" style="width: 200px; height: 200px; animation-delay: 0s;"></div>
                        <div class="aura-ring" style="width: 280px; height: 280px; animation-delay: 1s;"></div>
                        <div class="aura-ring" style="width: 360px; height: 360px; animation-delay: 2s;"></div>
                        <img 
                            src="https://defense.engineer/RhinoHorn/RhinoHorn.jpg" 
                            alt="นอแรดทนสิทธิ์ - Sacred Rhinoceros Horn Artifact" 
                            class="artifact-image float"
                            loading="eager"
                        >
                    </div>
                </div>
            </div>
        </section>

        <!-- Taxonomy Section -->
        <section id="taxonomy" class="py-16">
            <div class="container">
                <div class="text-center mb-8 reveal">
                    <h2 class="text-3xl font-bold text-gold mb-4">
                        <span lang="th">การจำแนกประเภทนอแรด</span>
                        <span lang="en">Taxonomy of Rhinoceros Horns</span>
                    </h2>
                    <p class="text-muted">
                        <span lang="th">แต่ละประเภทมีคุณสมบัติและอานุภาพเฉพาะตัว</span>
                        <span lang="en">Each variety possesses unique properties and powers</span>
                    </p>
                </div>
                
                <div class="grid grid-cols-2 md-grid-cols-1 gap-8">
                    <!-- Radar Chart -->
                    <div class="glass-panel p-6 reveal">
                        <div class="header-sacred mb-4">
                            <h3 class="text-xl font-semibold text-gold">
                                <span lang="th">การวิเคราะห์เปรียบเทียบ</span>
                                <span lang="en">Comparative Analysis</span>
                            </h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="radarChart"></canvas>
                        </div>
                        <p class="text-xs text-muted text-center mt-4">
                            <span lang="th">เปรียบเทียบพลังระหว่างนอนิล (ดำ) และนอน้ำผึ้ง (ทอง)</span>
                            <span lang="en">Comparing powers between Black Horn and Honey Horn</span>
                        </p>
                    </div>
                    
                    <!-- Type Cards -->
                    <div class="flex flex-col gap-4 reveal">
                        <!-- Nor Nin -->
                        <div class="glass-panel p-4">
                            <div class="flex items-center gap-4 mb-2">
                                <div class="w-12 h-12 rounded-full" style="background: linear-gradient(135deg, #1a1a1a, #333);"></div>
                                <div>
                                    <h4 class="font-semibold text-gold">
                                        <span lang="th">นอนิล (นอดำ)</span>
                                        <span lang="en">Nor Nin (Black Horn)</span>
                                    </h4>
                                    <span class="badge badge-elite">
                                        <span lang="th">มหาอำนาจ</span>
                                        <span lang="en">Authority</span>
                                    </span>
                                </div>
                            </div>
                            <p class="text-sm text-muted">
                                <span lang="th">เน้นด้านอำนาจบารมี การปกป้องคุ้มครอง และการกันคุณไสย เหมาะสำหรับผู้นำและผู้มีตำแหน่งสูง</span>
                                <span lang="en">Focuses on authority, protection, and anti-black magic. Ideal for leaders and those in high positions.</span>
                            </p>
                        </div>
                        
                        <!-- Nor Nam Phueng -->
                        <div class="glass-panel p-4">
                            <div class="flex items-center gap-4 mb-2">
                                <div class="w-12 h-12 rounded-full" style="background: linear-gradient(135deg, #D4A574, #FFD700);"></div>
                                <div>
                                    <h4 class="font-semibold text-gold">
                                        <span lang="th">นอน้ำผึ้ง (นอทอง)</span>
                                        <span lang="en">Nor Nam Phueng (Honey Horn)</span>
                                    </h4>
                                    <span class="badge badge-high">
                                        <span lang="th">เมตตา/โชคลาภ</span>
                                        <span lang="en">Charm/Fortune</span>
                                    </span>
                                </div>
                            </div>
                            <p class="text-sm text-muted">
                                <span lang="th">เน้นด้านเมตตามหานิยม โชคลาภ และการค้าขาย สีใสเหมือนน้ำผึ้ง มองทะลุได้ ช่วยให้มองเห็นอุปสรรคล่วงหน้า</span>
                                <span lang="en">Focuses on charm, fortune, and trade. Honey-colored and translucent, helps foresee obstacles.</span>
                            </p>
                        </div>
                        
                        <!-- Nor Men -->
                        <div class="glass-panel p-4">
                            <div class="flex items-center gap-4 mb-2">
                                <div class="w-12 h-12 rounded-full" style="background: linear-gradient(135deg, #4a4a4a, #666); border: 2px dashed var(--lotus-pink);"></div>
                                <div>
                                    <h4 class="font-semibold text-gold">
                                        <span lang="th">นอเหม็น</span>
                                        <span lang="en">Nor Men (Foul-Smelling Horn)</span>
                                    </h4>
                                    <span class="badge badge-rare">
                                        <span lang="th">หายากมาก</span>
                                        <span lang="en">Extremely Rare</span>
                                    </span>
                                </div>
                            </div>
                            <p class="text-sm text-muted">
                                <span lang="th">หายากที่สุด มีกลิ่นเฉพาะตัว ทรงพลังในการป้องกันคุณไสยและเสน่ห์ร้าย กลิ่นนั้นเองเป็นตัวส่งผ่านพลัง</span>
                                <span lang="en">Rarest variety with distinctive scent. Powerful protection against black magic. The scent itself transmits blessings.</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 11 Powers Section -->
        <section id="powers" class="py-16">
            <div class="container">
                <div class="text-center mb-8 reveal">
                    <h2 class="text-3xl font-bold text-gold mb-4">
                        <span lang="th">อานุภาพ ๑๑ ประการ</span>
                        <span lang="en">The 11 Mystical Powers</span>
                    </h2>
                    <p class="text-muted">
                        <span lang="th">แผนผังความสัมพันธ์ของพลังแห่งนอแรด - คลิกลากเพื่อสำรวจ</span>
                        <span lang="en">Interactive topology of Rhino Horn powers - Click and drag to explore</span>
                    </p>
                </div>
                
                <div class="grid grid-cols-3 md-grid-cols-1 gap-6">
                    <!-- D3 Network Graph -->
                    <div class="glass-panel p-4 col-span-2 lg-col-span-1 reveal">
                        <div class="header-sacred mb-4">
                            <h3 class="text-xl font-semibold text-gold">
                                <span lang="th">แผนผังพลังทนสิทธิ์</span>
                                <span lang="en">Thonnasit Power Network</span>
                            </h3>
                        </div>
                        <div id="d3-network"></div>
                    </div>
                    
                    <!-- Powers Table -->
                    <div class="glass-panel p-4 reveal" style="max-height: 550px; overflow-y: auto;">
                        <div class="header-sacred mb-4">
                            <h3 class="text-xl font-semibold text-gold">
                                <span lang="th">รายละเอียดอานุภาพ</span>
                                <span lang="en">Power Details</span>
                            </h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>
                                        <span lang="th">อานุภาพ</span>
                                        <span lang="en">Power</span>
                                    </th>
                                    <th>
                                        <span lang="th">ระดับ</span>
                                        <span lang="en">Level</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">มหาอำนาจ</span>
                                            <span lang="en">Maha Amnaj</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">สร้างบารมี เป็นเจ้าคนนายคน</span>
                                            <span lang="en">Authority & Leadership</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-elite">Elite</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">เมตตามหานิยม</span>
                                            <span lang="en">Metta Mahaniyom</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">เสน่ห์ดึงดูด การค้าขาย</span>
                                            <span lang="en">Charm & Trade Success</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-elite">Elite</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">แก้อาถรรพ์/กันคุณไสย</span>
                                            <span lang="en">Gae Aathan</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">ป้องกันและสะท้อนคุณไสย</span>
                                            <span lang="en">Anti-Black Magic</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-elite">Elite</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">โชคลาภ/ค้ำคูณ</span>
                                            <span lang="en">Choke Lap</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">ทวีคูณโชคลาภ กันความจน</span>
                                            <span lang="en">Luck Multiplier</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-high">High</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">กันภูตผี</span>
                                            <span lang="en">Kan Phut Phi</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">ป้องกันวิญญาณร้าย</span>
                                            <span lang="en">Spirit Protection</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-high">High</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">กันไฟ</span>
                                            <span lang="en">Kan Fai</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">ป้องกันอัคคีภัยและฟ้าผ่า</span>
                                            <span lang="en">Fire & Lightning Protection</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-rare">Rare</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">แคล้วคลาด</span>
                                            <span lang="en">Klaew Klaad</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">หลบหลีกอันตราย อุบัติเหตุ</span>
                                            <span lang="en">Danger Evasion</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-high">High</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong class="text-gold">
                                            <span lang="th">มหาอุด</span>
                                            <span lang="en">Maha Ud</span>
                                        </strong>
                                        <p class="text-xs text-muted mt-1">
                                            <span lang="th">อุดทรัพย์ กันอาวุธ</span>
                                            <span lang="en">Wealth Containment</span>
                                        </p>
                                    </td>
                                    <td><span class="badge badge-high">High</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Market Intelligence Section -->
        <section id="market" class="py-16">
            <div class="container">
                <div class="text-center mb-8 reveal">
                    <h2 class="text-3xl font-bold text-gold mb-4">
                        <span lang="th">การวิเคราะห์มูลค่าและความหายาก</span>
                        <span lang="en">Value & Rarity Analysis</span>
                    </h2>
                    <p class="text-muted">
                        <span lang="th">เปรียบเทียบกับ "ทองคำดำ" และอัญมณีล้ำค่า</span>
                        <span lang="en">Compared to "Black Gold" and precious gems</span>
                    </p>
                </div>
                
                <div class="grid grid-cols-2 md-grid-cols-1 gap-8">
                    <!-- Scatter Plot -->
                    <div class="glass-panel p-6 reveal">
                        <div class="header-sacred mb-4">
                            <h3 class="text-xl font-semibold text-gold">
                                <span lang="th">แผนภูมิมูลค่า vs ความหายาก</span>
                                <span lang="en">Value vs Rarity Matrix</span>
                            </h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="scatterChart"></canvas>
                        </div>
                        <p class="text-xs text-muted text-center mt-4">
                            <span lang="th">แกน Y: พลังทางจิตวิญญาณ | แกน X: ดัชนีความหายาก</span>
                            <span lang="en">Y: Mystical Potency | X: Rarity Index</span>
                        </p>
                    </div>
                    
                    <!-- Comparative Info -->
                    <div class="glass-panel p-6 reveal">
                        <div class="header-sacred mb-4">
                            <h3 class="text-xl font-semibold text-gold">
                                <span lang="th">เปรียบเทียบกับวัตถุมงคลอื่น</span>
                                <span lang="en">Comparison with Other Talismans</span>
                            </h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="comparisonChart"></canvas>
                        </div>
                        <div class="mt-4 p-4 rounded" style="background: rgba(201, 162, 39, 0.1); border: 1px dashed var(--mystical-gold);">
                            <h4 class="text-sm font-semibold text-gold mb-2">
                                <span lang="th">เกร็ดความรู้: ยาวาสนาจินดามณี</span>
                                <span lang="en">Note: Ya Wasana Jindamanee</span>
                            </h4>
                            <p class="text-xs text-muted">
                                <span lang="th">
                                    แม้ตำราโบราณจะกล่าวถึงการบดนอแรดเพื่อทำยาวาสนาจินดามณี แต่นักสะสมที่แท้จริงนิยมเก็บรักษานอแรดไว้ในสภาพเดิม 
                                    เพื่อรักษา "เทพสถิต" ที่สถิตอยู่ภายใน เพราะการบดทำลายจะทำให้สูญเสียรูปแบบทนสิทธิ์
                                </span>
                                <span lang="en">
                                    While ancient texts mention grinding horn for Ya Wasana Jindamanee medicine, true collectors prefer keeping the horn intact 
                                    to preserve the "Living Deity" (Thep Sadit) inside, as grinding destroys the Thonnasit form.
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Environmental Blessings Section -->
        <section id="blessings" class="py-16">
            <div class="container">
                <div class="glass-panel p-8 reveal">
                    <div class="grid grid-cols-2 md-grid-cols-1 gap-8 items-center">
                        <div>
                            <div class="header-sacred mb-6">
                                <h2 class="text-2xl font-bold text-gold">
                                    <span lang="th">พรจากสิ่งแวดล้อม</span>
                                    <span lang="en">Environmental Blessings</span>
                                </h2>
                            </div>
                            <p class="text-peach leading-relaxed mb-4">
                                <span lang="th">
                                    ความเชื่อโบราณกล่าวว่า <strong class="text-gold">น้ำฝนที่ชะชายคา</strong> ของบ้านที่มีนอแรดประดิษฐาน 
                                    จะนำความเจริญรุ่งเรืองมาสู่ผืนดินและผู้อยู่อาศัย พลังของนอแรดจะแผ่ซ่านไปทั่วทั้งบริเวณ 
                                    สร้างสนามพลังบวกที่ปกป้องและอำนวยพรแก่ทุกสิ่งที่อยู่ภายใน
                                </span>
                                <span lang="en">
                                    Ancient belief states that <strong class="text-gold">rainwater dripping from the eaves</strong> of a home housing a rhino horn 
                                    brings prosperity to the land and its inhabitants. The horn's power radiates throughout the area, 
                                    creating a positive energy field that protects and blesses everything within.
                                </span>
                            </p>
                            <ul class="space-y-2 text-sm text-muted">
                                <li class="flex items-center gap-2">
                                    <span class="text-jade">✦</span>
                                    <span lang="th">ป้องกันอัคคีภัยและฟ้าผ่า</span>
                                    <span lang="en">Protection from fire and lightning</span>
                                </li>
                                <li class="flex items-center gap-2">
                                    <span class="text-jade">✦</span>
                                    <span lang="th">ขับไล่วิญญาณร้ายและพลังลบ</span>
                                    <span lang="en">Repels evil spirits and negative energy</span>
                                </li>
                                <li class="flex items-center gap-2">
                                    <span class="text-jade">✦</span>
                                    <span lang="th">ดึงดูดความมั่งคั่งและโชคลาภ</span>
                                    <span lang="en">Attracts wealth and fortune</span>
                                </li>
                            </ul>
                        </div>
                        <div class="text-center">
                            <img 
                                src="https://defense.engineer/RhinoHorn/RhinoHorn.jpg" 
                                alt="นอแรดศักดิ์สิทธิ์" 
                                class="artifact-image mx-auto glow-pulse"
                                style="max-width: 250px;"
                            >
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="py-8 mt-8" style="background: rgba(0,0,0,0.5);">
            <div class="container text-center">
                <p class="text-muted text-sm mb-2">
                    <span lang="th">ข้อมูลจากตำราโบราณและความเชื่อพื้นบ้านไทย-ลาว</span>
                    <span lang="en">Information from ancient texts and Thai-Lao folk beliefs</span>
                </p>
                <p class="text-xs text-muted opacity-50">
                    <span lang="th">สร้างด้วย Canvas 2D, D3.js และ Chart.js | มกราคม ๒๕๖๙</span>
                    <span lang="en">Built with Canvas 2D, D3.js & Chart.js | January 2026</span>
                </p>
            </div>
        </footer>
    </div>

    <!-- JavaScript Core -->
    <script>
        /**
         * NEXUS THONNASIT ARCHIVE
         * Sacred Visualization Engine
         */

        // ============================================
        // 1. SACRED ATMOSPHERE ENGINE - Antigravity Style
        // ============================================

        // Simplex Noise for organic movement
        class SimplexNoise {
            constructor(seed = Math.random()) {
                this.p = new Uint8Array(256);
                for (let i = 0; i < 256; i++) this.p[i] = i;
                for (let i = 255; i > 0; i--) {
                    seed = (seed * 16807) % 2147483647;
                    const j = seed % (i + 1);
                    [this.p[i], this.p[j]] = [this.p[j], this.p[i]];
                }
                this.perm = new Uint8Array(512);
                for (let i = 0; i < 512; i++) this.perm[i] = this.p[i & 255];
            }

            noise2D(x, y) {
                const F2 = 0.5 * (Math.sqrt(3) - 1);
                const G2 = (3 - Math.sqrt(3)) / 6;
                const s = (x + y) * F2;
                const i = Math.floor(x + s);
                const j = Math.floor(y + s);
                const t = (i + j) * G2;
                const X0 = i - t, Y0 = j - t;
                const x0 = x - X0, y0 = y - Y0;
                const [i1, j1] = x0 > y0 ? [1, 0] : [0, 1];
                const x1 = x0 - i1 + G2, y1 = y0 - j1 + G2;
                const x2 = x0 - 1 + 2 * G2, y2 = y0 - 1 + 2 * G2;
                const ii = i & 255, jj = j & 255;
                const grad = [[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];
                const dot = (g, x, y) => g[0] * x + g[1] * y;
                const gi0 = this.perm[ii + this.perm[jj]] % 8;
                const gi1 = this.perm[ii + i1 + this.perm[jj + j1]] % 8;
                const gi2 = this.perm[ii + 1 + this.perm[jj + 1]] % 8;
                let n0 = 0, n1 = 0, n2 = 0;
                let t0 = 0.5 - x0*x0 - y0*y0;
                if (t0 >= 0) { t0 *= t0; n0 = t0 * t0 * dot(grad[gi0], x0, y0); }
                let t1 = 0.5 - x1*x1 - y1*y1;
                if (t1 >= 0) { t1 *= t1; n1 = t1 * t1 * dot(grad[gi1], x1, y1); }
                let t2 = 0.5 - x2*x2 - y2*y2;
                if (t2 >= 0) { t2 *= t2; n2 = t2 * t2 * dot(grad[gi2], x2, y2); }
                return 70 * (n0 + n1 + n2);
            }

            noise3D(x, y, z) {
                return (this.noise2D(x, y) + this.noise2D(y, z) + this.noise2D(x, z)) / 3;
            }
        }

        class SacredAtmosphere {
            constructor() {
                this.canvas = document.getElementById('sacred-canvas');
                this.ctx = null;
                this.particles = [];
                this.orbs = [];
                this.mouse = { x: window.innerWidth / 2, y: window.innerHeight / 2, vx: 0, vy: 0 };
                this.targetMouse = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
                this.time = 0;
                this.noise = new SimplexNoise();
                this.dpr = Math.min(window.devicePixelRatio, 2);

                // Color palette from theme
                this.colors = {
                    gold: { r: 201, g: 162, b: 39 },
                    peach: { r: 255, g: 190, b: 152 },
                    mocha: { r: 164, g: 119, b: 100 },
                    amber: { r: 212, g: 165, b: 116 },
                    lotus: { r: 232, g: 180, b: 184 }
                };

                this.init();
            }

            init() {
                if (!this.canvas) return;

                this.ctx = this.canvas.getContext('2d');
                this.resize();

                // Create particle layers
                this.createParticles();
                this.createOrbs();

                // Event listeners
                window.addEventListener('resize', () => this.resize());
                window.addEventListener('mousemove', (e) => this.handleMouseMove(e));
                window.addEventListener('touchmove', (e) => this.handleTouchMove(e), { passive: true });

                // Start animation
                this.animate();
            }

            resize() {
                this.width = window.innerWidth;
                this.height = window.innerHeight;
                this.canvas.width = this.width * this.dpr;
                this.canvas.height = this.height * this.dpr;
                this.canvas.style.width = this.width + 'px';
                this.canvas.style.height = this.height + 'px';
                this.ctx.scale(this.dpr, this.dpr);
            }

            handleMouseMove(e) {
                this.targetMouse.x = e.clientX;
                this.targetMouse.y = e.clientY;
            }

            handleTouchMove(e) {
                if (e.touches.length > 0) {
                    this.targetMouse.x = e.touches[0].clientX;
                    this.targetMouse.y = e.touches[0].clientY;
                }
            }

            createParticles() {
                const count = Math.min(180, Math.floor((this.width * this.height) / 12000));
                this.particles = [];

                for (let i = 0; i < count; i++) {
                    const colorKeys = Object.keys(this.colors);
                    const colorKey = colorKeys[Math.floor(Math.random() * colorKeys.length)];
                    const color = this.colors[colorKey];
                    const layer = Math.floor(Math.random() * 3); // 0=back, 1=mid, 2=front

                    this.particles.push({
                        x: Math.random() * this.width,
                        y: Math.random() * this.height,
                        baseX: Math.random() * this.width,
                        baseY: Math.random() * this.height,
                        vx: 0,
                        vy: 0,
                        size: (Math.random() * 4 + 2) * (layer * 0.3 + 0.7),
                        color: color,
                        alpha: Math.random() * 0.5 + 0.3,
                        layer: layer,
                        noiseOffsetX: Math.random() * 1000,
                        noiseOffsetY: Math.random() * 1000,
                        speed: Math.random() * 0.5 + 0.2,
                        pulsePhase: Math.random() * Math.PI * 2
                    });
                }
            }

            createOrbs() {
                // Larger flowing orbs for depth
                const orbCount = 8;
                this.orbs = [];

                for (let i = 0; i < orbCount; i++) {
                    const colorKeys = Object.keys(this.colors);
                    const colorKey = colorKeys[Math.floor(Math.random() * colorKeys.length)];

                    this.orbs.push({
                        x: Math.random() * this.width,
                        y: Math.random() * this.height,
                        baseX: Math.random() * this.width,
                        baseY: Math.random() * this.height,
                        radius: Math.random() * 80 + 40,
                        color: this.colors[colorKey],
                        alpha: Math.random() * 0.08 + 0.02,
                        noiseOffset: Math.random() * 1000,
                        speed: Math.random() * 0.3 + 0.1,
                        morphPhase: Math.random() * Math.PI * 2
                    });
                }
            }

            updateMouse() {
                // Smooth mouse following with velocity
                const ease = 0.08;
                const prevX = this.mouse.x;
                const prevY = this.mouse.y;

                this.mouse.x += (this.targetMouse.x - this.mouse.x) * ease;
                this.mouse.y += (this.targetMouse.y - this.mouse.y) * ease;
                this.mouse.vx = this.mouse.x - prevX;
                this.mouse.vy = this.mouse.y - prevY;
            }

            updateParticles() {
                const mouseInfluenceRadius = 200;
                const mouseForce = 0.15;

                for (const p of this.particles) {
                    // Noise-based organic movement
                    const noiseX = this.noise.noise2D(
                        p.noiseOffsetX + this.time * p.speed * 0.0003,
                        this.time * 0.0001
                    );
                    const noiseY = this.noise.noise2D(
                        p.noiseOffsetY + this.time * p.speed * 0.0003,
                        this.time * 0.0001 + 100
                    );

                    // Target position with noise offset
                    const amplitude = 100 + p.layer * 30;
                    const targetX = p.baseX + noiseX * amplitude;
                    const targetY = p.baseY + noiseY * amplitude;

                    // Mouse interaction - repel or attract based on layer
                    const dx = p.x - this.mouse.x;
                    const dy = p.y - this.mouse.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < mouseInfluenceRadius && dist > 0) {
                        const force = (1 - dist / mouseInfluenceRadius) * mouseForce;
                        const angle = Math.atan2(dy, dx);

                        // Front layer particles attract, others repel
                        const direction = p.layer === 2 ? -1 : 1;
                        p.vx += Math.cos(angle) * force * direction * 3;
                        p.vy += Math.sin(angle) * force * direction * 3;

                        // Add some of the mouse velocity
                        p.vx += this.mouse.vx * 0.05 * (1 - dist / mouseInfluenceRadius);
                        p.vy += this.mouse.vy * 0.05 * (1 - dist / mouseInfluenceRadius);
                    }

                    // Move towards target with velocity
                    p.vx += (targetX - p.x) * 0.01;
                    p.vy += (targetY - p.y) * 0.01;

                    // Apply velocity with damping
                    p.vx *= 0.95;
                    p.vy *= 0.95;
                    p.x += p.vx;
                    p.y += p.vy;

                    // Wrap around edges smoothly
                    if (p.x < -50) { p.x = this.width + 50; p.baseX = p.x; }
                    if (p.x > this.width + 50) { p.x = -50; p.baseX = p.x; }
                    if (p.y < -50) { p.y = this.height + 50; p.baseY = p.y; }
                    if (p.y > this.height + 50) { p.y = -50; p.baseY = p.y; }
                }
            }

            updateOrbs() {
                for (const orb of this.orbs) {
                    // Slow flowing movement
                    const noiseX = this.noise.noise2D(
                        orb.noiseOffset + this.time * 0.00008,
                        this.time * 0.00005
                    );
                    const noiseY = this.noise.noise2D(
                        orb.noiseOffset + 500 + this.time * 0.00008,
                        this.time * 0.00005 + 500
                    );

                    orb.x = orb.baseX + noiseX * 200;
                    orb.y = orb.baseY + noiseY * 200;

                    // Morphing radius
                    orb.morphPhase += 0.005;
                    orb.currentRadius = orb.radius + Math.sin(orb.morphPhase) * 20;

                    // Subtle mouse influence
                    const dx = orb.x - this.mouse.x;
                    const dy = orb.y - this.mouse.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < 400) {
                        const push = (1 - dist / 400) * 30;
                        orb.x += (dx / dist) * push;
                        orb.y += (dy / dist) * push;
                    }
                }
            }

            drawOrbs() {
                for (const orb of this.orbs) {
                    const gradient = this.ctx.createRadialGradient(
                        orb.x, orb.y, 0,
                        orb.x, orb.y, orb.currentRadius
                    );
                    gradient.addColorStop(0, `rgba(${orb.color.r}, ${orb.color.g}, ${orb.color.b}, ${orb.alpha})`);
                    gradient.addColorStop(0.5, `rgba(${orb.color.r}, ${orb.color.g}, ${orb.color.b}, ${orb.alpha * 0.5})`);
                    gradient.addColorStop(1, `rgba(${orb.color.r}, ${orb.color.g}, ${orb.color.b}, 0)`);

                    this.ctx.fillStyle = gradient;
                    this.ctx.beginPath();
                    this.ctx.arc(orb.x, orb.y, orb.currentRadius, 0, Math.PI * 2);
                    this.ctx.fill();
                }
            }

            drawConnections() {
                const connectionRadius = 150;
                const maxConnections = 3;

                this.ctx.lineWidth = 1;

                for (let i = 0; i < this.particles.length; i++) {
                    const p1 = this.particles[i];
                    let connections = 0;

                    for (let j = i + 1; j < this.particles.length && connections < maxConnections; j++) {
                        const p2 = this.particles[j];

                        // Only connect same or adjacent layers
                        if (Math.abs(p1.layer - p2.layer) > 1) continue;

                        const dx = p1.x - p2.x;
                        const dy = p1.y - p2.y;
                        const dist = Math.sqrt(dx * dx + dy * dy);

                        if (dist < connectionRadius) {
                            const alpha = (1 - dist / connectionRadius) * 0.3 * Math.min(p1.alpha, p2.alpha);

                            // Blend colors
                            const r = Math.floor((p1.color.r + p2.color.r) / 2);
                            const g = Math.floor((p1.color.g + p2.color.g) / 2);
                            const b = Math.floor((p1.color.b + p2.color.b) / 2);

                            this.ctx.strokeStyle = `rgba(${r}, ${g}, ${b}, ${alpha})`;
                            this.ctx.beginPath();
                            this.ctx.moveTo(p1.x, p1.y);
                            this.ctx.lineTo(p2.x, p2.y);
                            this.ctx.stroke();

                            connections++;
                        }
                    }
                }
            }

            drawMouseGlow() {
                // Subtle glow following mouse
                const gradient = this.ctx.createRadialGradient(
                    this.mouse.x, this.mouse.y, 0,
                    this.mouse.x, this.mouse.y, 250
                );
                gradient.addColorStop(0, 'rgba(201, 162, 39, 0.08)');
                gradient.addColorStop(0.4, 'rgba(255, 190, 152, 0.04)');
                gradient.addColorStop(1, 'rgba(255, 190, 152, 0)');

                this.ctx.fillStyle = gradient;
                this.ctx.fillRect(0, 0, this.width, this.height);
            }

            drawParticles() {
                // Sort by layer for proper depth
                const sorted = [...this.particles].sort((a, b) => a.layer - b.layer);

                for (const p of sorted) {
                    // Pulsing alpha
                    const pulse = Math.sin(this.time * 0.002 + p.pulsePhase) * 0.2 + 0.8;
                    const alpha = p.alpha * pulse;

                    // Draw particle with glow
                    const gradient = this.ctx.createRadialGradient(
                        p.x, p.y, 0,
                        p.x, p.y, p.size * 3
                    );
                    gradient.addColorStop(0, `rgba(${p.color.r}, ${p.color.g}, ${p.color.b}, ${alpha})`);
                    gradient.addColorStop(0.3, `rgba(${p.color.r}, ${p.color.g}, ${p.color.b}, ${alpha * 0.5})`);
                    gradient.addColorStop(1, `rgba(${p.color.r}, ${p.color.g}, ${p.color.b}, 0)`);

                    this.ctx.fillStyle = gradient;
                    this.ctx.beginPath();
                    this.ctx.arc(p.x, p.y, p.size * 3, 0, Math.PI * 2);
                    this.ctx.fill();

                    // Core particle
                    this.ctx.fillStyle = `rgba(${p.color.r}, ${p.color.g}, ${p.color.b}, ${alpha})`;
                    this.ctx.beginPath();
                    this.ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    this.ctx.fill();
                }
            }

            drawCentralAura() {
                // Central mystical aura
                const centerX = this.width / 2;
                const centerY = this.height / 2;
                const baseRadius = Math.min(this.width, this.height) * 0.25;

                // Morphing effect
                const morph1 = Math.sin(this.time * 0.001) * 30;
                const morph2 = Math.cos(this.time * 0.0015) * 20;

                // Mouse influence on aura
                const mouseDist = Math.sqrt(
                    Math.pow(this.mouse.x - centerX, 2) +
                    Math.pow(this.mouse.y - centerY, 2)
                );
                const mouseInfluence = Math.max(0, 1 - mouseDist / 400) * 0.03;

                // Outer glow
                const gradient = this.ctx.createRadialGradient(
                    centerX, centerY, 0,
                    centerX, centerY, baseRadius + morph1
                );
                gradient.addColorStop(0, `rgba(201, 162, 39, ${0.05 + mouseInfluence})`);
                gradient.addColorStop(0.5, `rgba(255, 190, 152, ${0.03 + mouseInfluence * 0.5})`);
                gradient.addColorStop(1, 'rgba(255, 190, 152, 0)');

                this.ctx.fillStyle = gradient;
                this.ctx.beginPath();
                this.ctx.arc(centerX, centerY, baseRadius + morph1, 0, Math.PI * 2);
                this.ctx.fill();

                // Inner ring
                const innerGradient = this.ctx.createRadialGradient(
                    centerX, centerY, baseRadius * 0.3 + morph2,
                    centerX, centerY, baseRadius * 0.5 + morph2
                );
                innerGradient.addColorStop(0, 'rgba(201, 162, 39, 0)');
                innerGradient.addColorStop(0.5, `rgba(201, 162, 39, ${0.08 + mouseInfluence})`);
                innerGradient.addColorStop(1, 'rgba(201, 162, 39, 0)');

                this.ctx.fillStyle = innerGradient;
                this.ctx.beginPath();
                this.ctx.arc(centerX, centerY, baseRadius * 0.5 + morph2, 0, Math.PI * 2);
                this.ctx.fill();
            }

            drawRings() {
                const centerX = this.width / 2;
                const centerY = this.height / 2;
                const ringCount = 5;

                for (let i = 0; i < ringCount; i++) {
                    const baseRadius = 80 + i * 60;
                    const rotation = this.time * 0.0002 * (i % 2 === 0 ? 1 : -1);
                    const pulse = Math.sin(this.time * 0.001 + i * 0.5) * 10;
                    const radius = baseRadius + pulse;

                    // Calculate alpha based on mouse distance
                    const mouseDist = Math.sqrt(
                        Math.pow(this.mouse.x - centerX, 2) +
                        Math.pow(this.mouse.y - centerY, 2)
                    );
                    const mouseAlpha = Math.max(0, 1 - mouseDist / 500) * 0.05;
                    const alpha = 0.05 + i * 0.02 + mouseAlpha;

                    this.ctx.save();
                    this.ctx.translate(centerX, centerY);
                    this.ctx.rotate(rotation);

                    // Draw dashed ring
                    this.ctx.strokeStyle = `rgba(201, 162, 39, ${alpha})`;
                    this.ctx.lineWidth = 1;
                    this.ctx.setLineDash([20, 30]);
                    this.ctx.lineDashOffset = this.time * 0.02 * (i % 2 === 0 ? 1 : -1);

                    this.ctx.beginPath();
                    this.ctx.arc(0, 0, radius, 0, Math.PI * 2);
                    this.ctx.stroke();

                    this.ctx.restore();
                }

                this.ctx.setLineDash([]);
            }

            animate() {
                this.time++;

                // Clear with slight fade for trail effect
                this.ctx.fillStyle = 'rgba(10, 10, 15, 0.15)';
                this.ctx.fillRect(0, 0, this.width, this.height);

                // Update
                this.updateMouse();
                this.updateOrbs();
                this.updateParticles();

                // Draw layers (back to front)
                this.drawOrbs();
                this.drawCentralAura();
                this.drawRings();
                this.drawConnections();
                this.drawMouseGlow();
                this.drawParticles();

                requestAnimationFrame(() => this.animate());
            }
        }

        // ============================================
        // 2. CHART MANAGER (Chart.js)
        // ============================================
        class ChartManager {
            constructor() {
                this.charts = {};
                this.colors = {
                    gold: '#C9A227',
                    peach: '#FFBE98',
                    mocha: '#A47764',
                    jade: '#00A86B',
                    lotus: '#E8B4B8',
                    amber: '#D4A574'
                };
            }
            
            init() {
                Chart.defaults.color = '#FFBE98';
                Chart.defaults.font.family = "'Sarabun', sans-serif";
                
                this.createRadarChart();
                this.createScatterChart();
                this.createComparisonChart();
            }
            
            createRadarChart() {
                const ctx = document.getElementById('radarChart');
                if (!ctx) return;
                
                this.charts.radar = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['เมตตา (Charm)', 'อำนาจ (Authority)', 'กันคุณไสย (Protection)', 'โชคลาภ (Luck)', 'ความหายาก (Rarity)'],
                        datasets: [
                            {
                                label: 'นอน้ำผึ้ง (Honey Horn)',
                                data: [95, 70, 75, 98, 90],
                                borderColor: this.colors.gold,
                                backgroundColor: 'rgba(201, 162, 39, 0.2)',
                                borderWidth: 2,
                                pointBackgroundColor: this.colors.gold
                            },
                            {
                                label: 'นอนิล (Black Horn)',
                                data: [65, 95, 98, 75, 85],
                                borderColor: this.colors.peach,
                                backgroundColor: 'rgba(255, 190, 152, 0.2)',
                                borderWidth: 2,
                                pointBackgroundColor: this.colors.peach
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                grid: { color: 'rgba(255, 190, 152, 0.1)' },
                                angleLines: { color: 'rgba(255, 190, 152, 0.1)' },
                                pointLabels: { 
                                    color: this.colors.peach,
                                    font: { size: 11 }
                                },
                                ticks: { display: false },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { 
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }
            
            createScatterChart() {
                const ctx = document.getElementById('scatterChart');
                if (!ctx) return;
                
                this.charts.scatter = new Chart(ctx, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'วัตถุมงคล',
                            data: [
                                { x: 95, y: 98, label: 'นอน้ำผึ้งโบราณ' },
                                { x: 85, y: 92, label: 'นอนิล' },
                                { x: 75, y: 80, label: 'ขนาย (ปลายนอ)' },
                                { x: 60, y: 70, label: 'งาช้าง' },
                                { x: 70, y: 85, label: 'เขี้ยวเสือ' },
                                { x: 40, y: 30, label: 'กระดูกเลียนแบบ' }
                            ],
                            backgroundColor: (ctx) => {
                                const val = ctx.raw?.y || 0;
                                if (val > 90) return this.colors.gold;
                                if (val > 70) return this.colors.peach;
                                return this.colors.mocha;
                            },
                            pointRadius: 10,
                            pointHoverRadius: 14
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: { 
                                    display: true, 
                                    text: 'ความหายาก (Rarity)',
                                    color: this.colors.peach
                                },
                                grid: { color: 'rgba(255, 190, 152, 0.05)' },
                                min: 0,
                                max: 100
                            },
                            y: {
                                title: { 
                                    display: true, 
                                    text: 'พลังทางจิตวิญญาณ (Potency)',
                                    color: this.colors.peach
                                },
                                grid: { color: 'rgba(255, 190, 152, 0.05)' },
                                min: 0,
                                max: 100
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => `${ctx.raw.label}: พลัง ${ctx.raw.y}, หายาก ${ctx.raw.x}`
                                }
                            }
                        }
                    }
                });
            }
            
            createComparisonChart() {
                const ctx = document.getElementById('comparisonChart');
                if (!ctx) return;
                
                this.charts.comparison = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['นอแรด', 'เขี้ยวเสือ', 'งาช้าง'],
                        datasets: [
                            {
                                label: 'แก้คุณไสย',
                                data: [95, 30, 40],
                                backgroundColor: this.colors.gold
                            },
                            {
                                label: 'อำนาจ',
                                data: [85, 95, 50],
                                backgroundColor: this.colors.peach
                            },
                            {
                                label: 'เมตตา',
                                data: [75, 40, 90],
                                backgroundColor: this.colors.lotus
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { 
                                grid: { display: false },
                                ticks: { color: this.colors.peach }
                            },
                            y: { 
                                grid: { color: 'rgba(255, 190, 152, 0.05)' },
                                max: 100,
                                ticks: { color: this.colors.peach }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { 
                                    padding: 15,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }
        }

        // ============================================
        // 3. D3 NETWORK TOPOLOGY
        // ============================================
        class TopologyEngine {
            constructor() {
                this.container = document.getElementById('d3-network');
                this.width = 0;
                this.height = 0;
                this.simulation = null;
            }
            
            init() {
                if (!this.container || !window.d3) return;
                
                this.width = this.container.clientWidth;
                this.height = this.container.clientHeight;
                
                // Node Data: The 11 Powers
                const nodes = [
                    { id: 'นอแรด', group: 0, r: 35, label: 'Rhino Horn' },
                    { id: 'มหาอำนาจ', group: 1, r: 22, label: 'Authority' },
                    { id: 'เมตตามหานิยม', group: 1, r: 22, label: 'Charm' },
                    { id: 'แก้อาถรรพ์', group: 1, r: 22, label: 'Anti-Curse' },
                    { id: 'โชคลาภ', group: 1, r: 20, label: 'Fortune' },
                    { id: 'กันภูตผี', group: 2, r: 16, label: 'Spirit Ward' },
                    { id: 'กันไฟ', group: 2, r: 14, label: 'Fire Protection' },
                    { id: 'แคล้วคลาด', group: 2, r: 16, label: 'Evasion' },
                    { id: 'มหาอุด', group: 2, r: 16, label: 'Wealth Lock' },
                    { id: 'ค้ำคูณ', group: 2, r: 14, label: 'Multiplier' },
                    { id: 'เทพสถิต', group: 3, r: 18, label: 'Deity' }
                ];
                
                const links = [
                    { source: 'นอแรด', target: 'มหาอำนาจ' },
                    { source: 'นอแรด', target: 'เมตตามหานิยม' },
                    { source: 'นอแรด', target: 'แก้อาถรรพ์' },
                    { source: 'นอแรด', target: 'โชคลาภ' },
                    { source: 'นอแรด', target: 'เทพสถิต' },
                    { source: 'แก้อาถรรพ์', target: 'กันภูตผี' },
                    { source: 'แก้อาถรรพ์', target: 'กันไฟ' },
                    { source: 'มหาอำนาจ', target: 'แคล้วคลาด' },
                    { source: 'โชคลาภ', target: 'มหาอุด' },
                    { source: 'โชคลาภ', target: 'ค้ำคูณ' },
                    { source: 'เมตตามหานิยม', target: 'ค้ำคูณ' }
                ];
                
                // Color Scale
                const colorScale = d3.scaleOrdinal()
                    .domain([0, 1, 2, 3])
                    .range(['#C9A227', '#FFBE98', '#A47764', '#00A86B']);
                
                // Create SVG
                const svg = d3.select(this.container)
                    .append('svg')
                    .attr('width', this.width)
                    .attr('height', this.height);
                
                // Gradient Definitions
                const defs = svg.append('defs');
                
                // Glow Filter
                const filter = defs.append('filter')
                    .attr('id', 'glow')
                    .attr('x', '-50%')
                    .attr('y', '-50%')
                    .attr('width', '200%')
                    .attr('height', '200%');
                
                filter.append('feGaussianBlur')
                    .attr('stdDeviation', '3')
                    .attr('result', 'coloredBlur');
                
                const feMerge = filter.append('feMerge');
                feMerge.append('feMergeNode').attr('in', 'coloredBlur');
                feMerge.append('feMergeNode').attr('in', 'SourceGraphic');
                
                // Force Simulation
                this.simulation = d3.forceSimulation(nodes)
                    .force('link', d3.forceLink(links).id(d => d.id).distance(80))
                    .force('charge', d3.forceManyBody().strength(-300))
                    .force('center', d3.forceCenter(this.width / 2, this.height / 2))
                    .force('collision', d3.forceCollide().radius(d => d.r + 10));
                
                // Links
                const link = svg.append('g')
                    .selectAll('line')
                    .data(links)
                    .join('line')
                    .attr('stroke', 'rgba(201, 162, 39, 0.3)')
                    .attr('stroke-width', 2);
                
                // Nodes
                const node = svg.append('g')
                    .selectAll('circle')
                    .data(nodes)
                    .join('circle')
                    .attr('r', d => d.r)
                    .attr('fill', d => colorScale(d.group))
                    .attr('fill-opacity', 0.8)
                    .attr('stroke', '#C9A227')
                    .attr('stroke-width', 2)
                    .attr('filter', 'url(#glow)')
                    .style('cursor', 'grab')
                    .call(this.drag(this.simulation));
                
                // Labels
                const labels = svg.append('g')
                    .selectAll('text')
                    .data(nodes)
                    .join('text')
                    .text(d => d.id)
                    .attr('font-family', 'Sarabun, sans-serif')
                    .attr('font-size', d => d.group === 0 ? '12px' : '10px')
                    .attr('fill', '#FFBE98')
                    .attr('text-anchor', 'middle')
                    .attr('dy', d => d.r + 15)
                    .style('pointer-events', 'none');
                
                // Tick Function
                this.simulation.on('tick', () => {
                    link
                        .attr('x1', d => d.source.x)
                        .attr('y1', d => d.source.y)
                        .attr('x2', d => d.target.x)
                        .attr('y2', d => d.target.y);
                    
                    node
                        .attr('cx', d => d.x = Math.max(d.r, Math.min(this.width - d.r, d.x)))
                        .attr('cy', d => d.y = Math.max(d.r, Math.min(this.height - d.r, d.y)));
                    
                    labels
                        .attr('x', d => d.x)
                        .attr('y', d => d.y);
                });
            }
            
            drag(simulation) {
                function dragstarted(event) {
                    if (!event.active) simulation.alphaTarget(0.3).restart();
                    event.subject.fx = event.subject.x;
                    event.subject.fy = event.subject.y;
                }
                
                function dragged(event) {
                    event.subject.fx = event.x;
                    event.subject.fy = event.y;
                }
                
                function dragended(event) {
                    if (!event.active) simulation.alphaTarget(0);
                    event.subject.fx = null;
                    event.subject.fy = null;
                }
                
                return d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended);
            }
        }

        // ============================================
        // 4. APPLICATION CORE
        // ============================================
        const APP = {
            lang: 'th',
            
            init() {
                // Hide loading overlay
                setTimeout(() => {
                    document.getElementById('loading-overlay').classList.add('hidden');
                }, 1500);
                
                // Initialize modules
                new SacredAtmosphere();
                
                const charts = new ChartManager();
                charts.init();
                
                const topology = new TopologyEngine();
                topology.init();
                
                // Setup observers
                this.initScrollReveal();
                this.initLanguageToggle();
            },
            
            initScrollReveal() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('active');
                        }
                    });
                }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
                
                document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
            },
            
            initLanguageToggle() {
                const toggle = document.getElementById('lang-toggle');
                if (toggle) {
                    toggle.addEventListener('click', () => {
                        this.lang = this.lang === 'th' ? 'en' : 'th';
                        document.body.dataset.lang = this.lang;
                    });
                }
            }
        };

        // ============================================
        // 5. RESILIENT LOADER
        // ============================================
        function waitForLibs(retries = 0) {
            // Background animation uses Canvas 2D now, only need D3 and Chart.js
            const ready = typeof d3 !== 'undefined' &&
                          typeof Chart !== 'undefined';

            if (ready) {
                console.log(`[NEXUS] All libraries loaded (${retries * 100}ms)`);
                APP.init();
            } else if (retries < 50) {
                setTimeout(() => waitForLibs(retries + 1), 100);
            } else {
                console.warn('[NEXUS] Some libraries failed to load, initializing anyway');
                APP.init();
            }
        }

        document.addEventListener('DOMContentLoaded', () => waitForLibs());
    </script>
</body>
</html>
