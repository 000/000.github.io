<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Doctoral Research Viability Report: The Cognitive SOAR Framework</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&amp;family=Inter:wght@300;400;500;600&amp;display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#8B5A3C',
                        secondary: '#D4A574',
                        accent: '#E8D5B7',
                        neutral: '#F5F1EB',
                        dark: '#2C1810'
                    },
                    fontFamily: {
                        'serif': ['Playfair Display', 'serif'],
                        'sans': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .hero-overlay {
            background: linear-gradient(135deg, rgba(139, 90, 60, 0.8) 0%, rgba(44, 24, 16, 0.9) 100%);
        }
        .toc-fixed {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100vh;
            background: rgba(245, 241, 235, 0.98);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(139, 90, 60, 0.2);
            z-index: 1000;
            overflow-y: auto;
            padding: 2rem 1.5rem;
        }
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
        }
        .citation-link {
            color: #8B5A3C;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px dotted #8B5A3C;
        }
        .citation-link:hover {
            background-color: rgba(139, 90, 60, 0.1);
            border-bottom: 1px solid #8B5A3C;
        }
        .section-divider {
            height: 2px;
            background: linear-gradient(90deg, #8B5A3C 0%, transparent 100%);
            margin: 3rem 0;
        }
        .highlight-box {
            background: linear-gradient(135deg, rgba(212, 165, 116, 0.1) 0%, rgba(232, 213, 183, 0.2) 100%);
            border-left: 4px solid #8B5A3C;
        }
        
        /* Mermaid diagram styling */
        .mermaid-container {
            display: flex;
            justify-content: center;
            min-height: 300px;
            max-height: 800px;
            background: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }
        
        .mermaid-container .mermaid {
            width: 100%;
            max-width: 100%;
            height: 100%;
            cursor: grab;
            transition: transform 0.3s ease;
            transform-origin: center center;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        .mermaid-container .mermaid svg {
            max-width: 100%;
            height: 100%;
            display: block;
            margin: 0 auto;
        }
        
        .mermaid-container .mermaid:active {
            cursor: grabbing;
        }
        
        .mermaid-container.zoomed .mermaid {
            height: 100%;
            width: 100%;
            cursor: grab;
        }
        
        .mermaid-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            z-index: 20;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .mermaid-control-btn {
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #374151;
            font-size: 14px;
            min-width: 36px;
            height: 36px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .mermaid-control-btn:hover {
            background: #f8fafc;
            border-color: #3b82f6;
            color: #3b82f6;
            transform: translateY(-1px);
        }
        
        .mermaid-control-btn:active {
            transform: scale(0.95);
        }
        
        /* Enhanced contrast for mermaid elements */
        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node ellipse,
        .mermaid .node polygon {
            stroke-width: 2px !important;
            stroke: #2C1810 !important;
        }
        
        .mermaid .node .label {
            color: #2C1810 !important;
            font-weight: 600 !important;
            font-size: 13px !important;
            font-family: 'Inter', sans-serif !important;
        }
        
        .mermaid .edgePath .path {
            stroke: #8B5A3C !important;
            stroke-width: 2px !important;
        }
        
        .mermaid .edgeLabel {
            background-color: rgba(245, 241, 235, 0.95) !important;
            color: #2C1810 !important;
            font-weight: 500 !important;
            font-size: 11px !important;
            font-family: 'Inter', sans-serif !important;
            padding: 2px 6px !important;
            border-radius: 4px !important;
            border: 1px solid #8B5A3C !important;
        }
        
        .mermaid .cluster rect {
            fill: rgba(139, 90, 60, 0.1) !important;
            stroke: #8B5A3C !important;
            stroke-width: 2px !important;
            stroke-dasharray: 5,5 !important;
        }
        
        /* Ensure text readability on all node colors */
        .mermaid .node[style*="fill:#8B5A3C"] .label,
        .mermaid .node[style*="fill:#2C1810"] .label {
            color: #F5F1EB !important;
            font-weight: 600 !important;
        }
        
        .mermaid .node[style*="fill:#D4A574"] .label,
        .mermaid .node[style*="fill:#E8D5B7"] .label {
            color: #2C1810 !important;
            font-weight: 600 !important;
        }

        @media (max-width: 1024px) {
            .toc-fixed {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            .toc-fixed.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .mermaid-control-btn:not(.reset-zoom) {
                display: none;
            }
            .mermaid-controls {
                top: auto;
                bottom: 15px;
                right: 15px;
            }
        }
    </style>
  <base target="_blank">
</head>

  <body class="bg-neutral font-sans text-dark">
    <!-- Table of Contents -->
    <nav id="toc" class="toc-fixed">
      <div class="mb-8">
        <h3 class="font-serif text-lg font-semibold text-primary mb-4">Contents</h3>
        <div class="space-y-2 text-sm">
          <a href="#executive-summary" class="block py-2 px-3 rounded-md hover:bg-accent transition-colors">Executive Summary</a>
          <a href="#originality" class="block py-2 px-3 rounded-md hover:bg-accent transition-colors">1. Originality Verification</a>
          <a href="#feasibility" class="block py-2 px-3 rounded-md hover:bg-accent transition-colors">2. Feasibility Confirmation</a>
          <a href="#roadmap" class="block py-2 px-3 rounded-md hover:bg-accent transition-colors">3. Six-Semester Roadmap</a>
          <a href="#risk-analysis" class="block py-2 px-3 rounded-md hover:bg-accent transition-colors">4. Risk Analysis</a>
          <a href="#commercial-comparison" class="block py-2 px-3 rounded-md hover:bg-accent transition-colors">5. Commercial SOAR Comparison</a>
        </div>
      </div>
      <div class="border-t border-primary/20 pt-4">
        <p class="text-xs text-primary/70">Research Viability Report</p>
        <p class="text-xs text-primary/50 mt-1">Capitol Technology University</p>
      </div>
    </nav>

    <!-- Mobile TOC Toggle -->
    <button id="toc-toggle" class="lg:hidden fixed top-4 left-4 z-50 bg-primary text-white p-3 rounded-full shadow-lg">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Hero Section -->
      <section class="relative min-h-screen flex items-center">
        <div class="absolute inset-0">
          <img src="https://fixedplaceholder" alt="Abstract visualization of AI neural network protecting financial infrastructure" class="w-full h-full object-cover" size="wallpaper" aspect="wide" query="AI neural network protecting financial data" referrerpolicy="no-referrer" data-modified="1" data-score="0.00"/>
          <div class="hero-overlay absolute inset-0"></div>
        </div>

        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 md:px-8 py-20">
          <!-- Bento Grid Layout -->
          <div class="grid grid-cols-12 gap-6 items-center">
            <!-- Title Block -->
            <div class="col-span-12 lg:col-span-8">
              <h1 class="font-serif text-3xl sm:text-4xl md:text-6xl font-bold text-white leading-tight mb-6">
                <em class="italic">The Cognitive SOAR Framework:</em>
                <br/>
                Vectorized Case-Based Reasoning for Adaptive Threat Response
              </h1>
              <p class="text-base sm:text-lg md:text-xl text-white/90 mb-8 leading-relaxed">
                A Doctoral Research Viability Report examining the synthesis of Soar Cognitive Architecture,
                Vectorized Case-Based Reasoning, and Formal Verification for Financial Critical Infrastructure protection.
              </p>
            </div>

            <!-- Executive Summary Card -->
            <div class="col-span-12 lg:col-span-4 mt-8 lg:mt-0">
              <div id="executive-summary" class="bg-white/95 backdrop-blur-sm rounded-lg p-4 sm:p-6 shadow-2xl">
                <h2 class="font-serif text-xl font-semibold text-primary mb-4">Executive Summary</h2>
                <div class="space-y-4 text-sm">
                  <div>
                    <h3 class="font-semibold text-dark mb-2">Originality</h3>
                    <p class="text-dark/80">Unprecedented synthesis of neuro-symbolic AI with formal verification, addressing critical gaps in FCI protection.</p>
                  </div>
                  <div>
                    <h3 class="font-semibold text-dark mb-2">Feasibility</h3>
                    <p class="text-dark/80">Technically viable within 6-semester timeline, contingent on hardware performance optimization.</p>
                  </div>
                  <div>
                    <h3 class="font-semibold text-dark mb-2">Impact</h3>
                    <p class="text-dark/80">Potential to reduce threat response time from 47 minutes to under 5 minutes while maintaining mathematical safety guarantees.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 1: Originality Verification -->
      <section id="originality" class="py-20 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8">
          <h2 class="font-serif text-4xl font-bold text-primary mb-12">1. Originality Verification Statement</h2>

          <div class="highlight-box p-8 rounded-lg mb-12">
            <h3 class="font-serif text-2xl font-semibold mb-6">Novel Integration of Core Concepts</h3>
            <p class="text-lg leading-relaxed mb-6">
              The Cognitive SOAR Framework represents an <strong>unprecedented synthesis</strong> of three distinct computational paradigms:
              the <a href="https://sbp-brims.org/2025/papers/working-papers/2025_SBP-BRiMS_paper_18.pdf" class="citation-link">Soar Cognitive Architecture</a>,
              <strong>Vectorized Case-Based Reasoning</strong>, and
              <strong>Formal Verification using Linear Temporal Logic (LTL)</strong>.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
              <div class="bg-white p-6 rounded-lg shadow-sm border border-primary/20">
                <div class="w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mb-4">
                  <i class="fas fa-brain text-primary text-xl"></i>
                </div>
                <h4 class="font-semibold mb-3">Soar Architecture</h4>
                <p class="text-sm text-dark/80">Symbolic reasoning engine for structured decision-making and goal-oriented behavior.</p>
              </div>
              <div class="bg-white p-6 rounded-lg shadow-sm border border-primary/20">
                <div class="w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mb-4">
                  <i class="fas fa-vector-square text-primary text-xl"></i>
                </div>
                <h4 class="font-semibold mb-3">Vectorized CBR</h4>
                <p class="text-sm text-dark/80">Connectionist learning through transformer-based embeddings for adaptive threat response.</p>
              </div>
              <div class="bg-white p-6 rounded-lg shadow-sm border border-primary/20">
                <div class="w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mb-4">
                  <i class="fas fa-shield-alt text-primary text-xl"></i>
                </div>
                <h4 class="font-semibold mb-3">Formal Verification</h4>
                <p class="text-sm text-dark/80">LTL-based mathematical guarantees ensuring &#34;do no harm&#34; principles in autonomous actions.</p>
              </div>
            </div>
          </div>

          <div class="mb-12">
            <h3 class="font-serif text-2xl font-semibold mb-6">The Neuro-Symbolic Fusion Gap</h3>
            <p class="text-lg leading-relaxed mb-6">
              While each component has been explored individually, their integration for autonomous threat response in Financial Critical Infrastructure represents a
              <strong>significant and verifiable gap</strong> in current knowledge. The framework&#39;s application to protecting
              <a href="https://defense.engineer/" class="citation-link">Thailand&#39;s Student Loan Fund (200B baht, 7M accounts)</a>
              demonstrates practical significance beyond theoretical innovation.
            </p>

            <div class="bg-accent/20 p-6 rounded-lg">
              <h4 class="font-semibold mb-4">Key Performance Metrics</h4>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="text-center">
                  <div class="text-2xl font-bold text-primary">50M</div>
                  <div class="text-sm text-dark/70">Daily Events</div>
                </div>
                <div class="text-center">
                  <div class="text-2xl font-bold text-primary">
                    &lt; 10ms</div>
                      <div class="text-sm text-dark/70">Similarity Search</div>
                  </div>
                  <div class="text-center">
                    <div class="text-2xl font-bold text-primary">70B</div>
                    <div class="text-sm text-dark/70">LLM Parameters</div>
                  </div>
                  <div class="text-center">
                    <div class="text-2xl font-bold text-primary">
                      &lt; 5min</div>
                        <div class="text-sm text-dark/70">Target MTTR</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="mb-12">
                <h3 class="font-serif text-2xl font-semibold mb-6">Mathematical Rigor and Efficiency</h3>
                <p class="text-lg leading-relaxed mb-6">
                  The framework&#39;s <strong>novel application of HNSW indexing</strong> transforms incident retrieval from traditional
                  <code class="bg-primary/10 px-2 py-1 rounded">O(n²)</code> playbook matching to
                  <code class="bg-primary/10 px-2 py-1 rounded">O(log N)</code> vector retrieval complexity,
                  enabling a <strong>&#34;multi-billion-fold speedup&#34;</strong> for large-scale case libraries.
                </p>

                <div class="bg-white border border-primary/20 rounded-lg p-6">
                  <h4 class="font-semibold mb-4">Algorithmic Complexity Comparison</h4>
                  <div class="space-y-4">
                    <div class="flex items-center justify-between">
                      <span>Traditional Linear Search</span>
                      <span class="font-mono text-red-600">O(n)</span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span>Pairwise Similarity</span>
                      <span class="font-mono text-red-600">O(n²)</span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span>HNSW Vector Retrieval</span>
                      <span class="font-mono text-green-600">O(log N)</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="section-divider"></div>

              <h3 class="font-serif text-2xl font-semibold mb-6">Trustworthy AI and Formal Verification</h3>
              <p class="text-lg leading-relaxed mb-6">
                The pioneering use of <strong>LTL as &#34;guardrails&#34; for generative AI</strong> represents a fundamental departure from
                standard &#34;black box&#34; implementations. This approach ensures <strong>&#34;explainable by design&#34;</strong> decision-making
                with mathematical guarantees of safety—essential for meeting stringent
                <a href="https://data.fca.org.uk/artefacts/NSM/Portal/NI-000124607/NI-000124607.pdf" class="citation-link">FCI regulatory requirements</a>.
              </p>

              <!-- Framework Architecture Diagram -->
              <div class="bg-white border border-primary/20 rounded-lg p-6 mt-8">
                <h4 class="font-semibold mb-4">Cognitive SOAR Framework Architecture</h4>
                <div class="mermaid-container">
                  <div class="mermaid-controls">
                    <button class="mermaid-control-btn zoom-in" title="放大">
                      <i class="fas fa-search-plus"></i>
                    </button>
                    <button class="mermaid-control-btn zoom-out" title="缩小">
                      <i class="fas fa-search-minus"></i>
                    </button>
                    <button class="mermaid-control-btn reset-zoom" title="重置">
                      <i class="fas fa-expand-arrows-alt"></i>
                    </button>
                    <button class="mermaid-control-btn fullscreen" title="全屏查看">
                      <i class="fas fa-expand"></i>
                    </button>
                  </div>
                  <div class="mermaid" id="framework-diagram">
                    graph TB
                    A[&#34;Security Incident&#34;] --&gt; B[&#34;Vector Embedding
                    <br/>ℝ¹⁰²⁴/ℝ¹⁵³⁶&#34;]
                    B --&gt; C[&#34;HNSW Index
                    <br/>O(log N) Search&#34;]
                    C --&gt; D[&#34;Similar Cases Retrieval&#34;]
                    D --&gt; E[&#34;Soar Cognitive Engine&#34;]
                    E --&gt; F[&#34;LLM Response Generation
                    <br/>Deepseek R1 70B&#34;]
                    F --&gt; G[&#34;LTL Verification
                    <br/>Safety Guardrails&#34;]
                    G --&gt; H{&#34;Invariant Check&#34;}
                    H --&gt;|&#34;Safe&#34;| I[&#34;Execute Response&#34;]
                    H --&gt;|&#34;Unsafe&#34;| J[&#34;Revise Plan&#34;]
                    J --&gt; F
                    I --&gt; K[&#34;Learning &amp; Retention&#34;]

                    style A fill:#8B5A3C,stroke:#2C1810,stroke-width:2px,color:#F5F1EB
                    style B fill:#D4A574,stroke:#2C1810,stroke-width:2px,color:#2C1810
                    style C fill:#D4A574,stroke:#2C1810,stroke-width:2px,color:#2C1810
                    style D fill:#D4A574,stroke:#2C1810,stroke-width:2px,color:#2C1810
                    style E fill:#8B5A3C,stroke:#2C1810,stroke-width:3px,color:#F5F1EB
                    style F fill:#E8D5B7,stroke:#8B5A3C,stroke-width:2px,color:#2C1810
                    style G fill:#E8D5B7,stroke:#8B5A3C,stroke-width:2px,color:#2C1810
                    style H fill:#E8D5B7,stroke:#8B5A3C,stroke-width:2px,color:#2C1810
                    style I fill:#2C1810,stroke:#8B5A3C,stroke-width:2px,color:#F5F1EB
                    style J fill:#2C1810,stroke:#8B5A3C,stroke-width:2px,color:#F5F1EB
                    style K fill:#2C1810,stroke:#8B5A3C,stroke-width:2px,color:#F5F1EB
                  </div>
                </div>
              </div>
            </div>
      </section>

      <!-- Section 2: Feasibility Confirmation -->
      <section id="feasibility" class="py-20 bg-accent/30">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8">
          <h2 class="font-serif text-4xl font-bold text-primary mb-12">2. Feasibility Confirmation and Technical Audit</h2>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mb-12">
            <div>
              <h3 class="font-serif text-2xl font-semibold mb-6">Hardware Platform Viability</h3>
              <p class="text-lg leading-relaxed mb-6">
                The <strong>Mac Studio M3 Ultra with 512GB RAM</strong> provides a technically viable platform for local inference.
                <a href="https://www.macrumors.com/2025/03/17/apples-m3-ultra-runs-deepseek-r1-efficiently/" class="citation-link">Real-world tests confirm</a>
                the ability to run 671B-parameter DeepSeek R1 in 4-bit quantized format, requiring ~404GB memory.
              </p>

              <div class="bg-white p-6 rounded-lg shadow-sm border border-primary/20">
                <h4 class="font-semibold mb-4">Mac Studio M3 Ultra Specifications</h4>
                <div class="space-y-3">
                  <div class="flex justify-between">
                    <span>CPU Cores</span>
                    <span class="font-mono">32 cores</span>
                  </div>
                  <div class="flex justify-between">
                    <span>GPU Cores</span>
                    <span class="font-mono">80 cores</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Unified Memory</span>
                    <span class="font-mono">512GB</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Memory Bandwidth</span>
                    <span class="font-mono">819 GB/s</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Token Generation</span>
                    <span class="font-mono">16-18 tok/sec</span>
                  </div>
                </div>
              </div>
            </div>

            <div>
              <h3 class="font-serif text-2xl font-semibold mb-6">Performance Considerations</h3>
              <p class="text-lg leading-relaxed mb-6">
                While technically feasible, performance limitations exist compared to multi-node configurations.
                <a href="https://workos.com/blog/deepseek-r1-pushes-local-and-open-ai-forward" class="citation-link">Benchmarks show</a>
                usable but sub-optimal performance for real-time autonomous response.
              </p>

              <div class="bg-white p-6 rounded-lg shadow-sm border border-primary/20">
                <h4 class="font-semibold mb-4">Performance Trade-offs</h4>
                <div class="space-y-4">
                  <div class="flex items-center justify-between">
                    <span>4-bit Quantization</span>
                    <span class="text-yellow-600">Accuracy Trade-off</span>
                  </div>
                  <div class="flex items-center justify-between">
                    <span>Single Node</span>
                    <span class="text-red-600">Single Point of Failure</span>
                  </div>
                  <div class="flex items-center justify-between">
                    <span>Token Speed</span>
                    <span class="text-yellow-600">Moderate Throughput</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="bg-white p-8 rounded-lg shadow-sm border border-primary/20">
            <h3 class="font-serif text-2xl font-semibold mb-6">Cost-Benefit Analysis</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div>
                <h4 class="font-semibold mb-4 text-green-700">Local Deployment Advantages</h4>
                <ul class="space-y-2 text-sm">
                  <li class="flex items-center"><i class="fas fa-check text-green-600 mr-2"></i>Enhanced data privacy and sovereignty</li>
                  <li class="flex items-center"><i class="fas fa-check text-green-600 mr-2"></i>No recurring cloud service costs</li>
                  <li class="flex items-center"><i class="fas fa-check text-green-600 mr-2"></i>Lower latency for sensitive operations</li>
                  <li class="flex items-center"><i class="fas fa-check text-green-600 mr-2"></i>Full control over hardware environment</li>
                </ul>
              </div>
              <div>
                <h4 class="font-semibold mb-4 text-red-700">Cost Considerations</h4>
                <ul class="space-y-2 text-sm">
                  <li class="flex items-center"><i class="fas fa-times text-red-600 mr-2"></i>Initial hardware investment: ~$14,099</li>
                  <li class="flex items-center"><i class="fas fa-times text-red-600 mr-2"></i>Manual configuration complexity</li>
                  <li class="flex items-center"><i class="fas fa-times text-red-600 mr-2"></i>Limited scalability options</li>
                  <li class="flex items-center"><i class="fas fa-times text-red-600 mr-2"></i>Performance constraints vs. cloud</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 3: Six-Semester Roadmap -->
      <section id="roadmap" class="py-20 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8">
          <h2 class="font-serif text-4xl font-bold text-primary mb-12">3. Detailed Six-Semester Roadmap</h2>

          <div class="mb-12">
            <img src="https://kimi-web-img.moonshot.cn/img/www.sfu.ca/d8673699aeb53ad663244fd1d759c9164e707a40.png" alt="University research timeline showing three academic years" class="w-full h-64 object-cover rounded-lg shadow-lg mb-6" size="medium" aspect="wide" style="photo" query="university research timeline" referrerpolicy="no-referrer" data-modified="1" data-score="0.00"/>
          </div>

          <!-- Timeline visualization -->
          <div class="bg-accent/20 p-8 rounded-lg mb-12">
            <h3 class="font-serif text-xl font-semibold mb-6">Academic Timeline Structure</h3>
            <div class="mermaid-container">
              <div class="mermaid-controls">
                <button class="mermaid-control-btn zoom-in" title="放大">
                  <i class="fas fa-search-plus"></i>
                </button>
                <button class="mermaid-control-btn zoom-out" title="缩小">
                  <i class="fas fa-search-minus"></i>
                </button>
                <button class="mermaid-control-btn reset-zoom" title="重置">
                  <i class="fas fa-expand-arrows-alt"></i>
                </button>
                <button class="mermaid-control-btn fullscreen" title="全屏查看">
                  <i class="fas fa-expand"></i>
                </button>
              </div>
              <div class="mermaid" id="timeline-diagram">
                timeline
                title &#34;Capitol Technology University D.Sc. Program - Six Semester Structure&#34;

                section &#34;Year 1: Foundation&#34;
                Semester 1 : &#34;RSC 802 - Doctoral Learning&#34;
                : &#34;IAE 830 - Research Literature&#34;
                : &#34;Literature Review &amp; Problem Definition&#34;
                Semester 2 : &#34;RSC 810 - Research Theory&#34;
                : &#34;RSC 820 - Situational Awareness&#34;
                : &#34;Theoretical Framework Design&#34;
                Semester 3 : &#34;RSC 825 - Applied Research&#34;
                : &#34;RSC 813 - Professional Ethics&#34;
                : &#34;Mathematical Formalization&#34;

                section &#34;Year 2: Implementation&#34;
                Semester 4 : &#34;RSC 860 - Research Design&#34;
                : &#34;IAE 881 - Special Topics II&#34;
                : &#34;Hardware Setup &amp; Pipeline&#34;
                Semester 5 : &#34;RSC 812 - Research Theory II&#34;
                : &#34;IAE 880 - Special Topics&#34;
                : &#34;Dataset Generation &amp; Training&#34;
                Semester 6 : &#34;DSR 925 - Dissertation Prep I&#34;
                : &#34;IAE 882/883 - Special Topics&#34;
                : &#34;Controlled Experiments &amp; Validation&#34;

                section &#34;Year 3: Analysis &amp; Defense&#34;
                Semester 7 : &#34;DSR 900 - Dissertation Writing&#34;
                : &#34;IAE 884 - Special Topics V&#34;
                : &#34;Statistical Analysis &amp; Validation&#34;
                Semester 8 : &#34;DSR 935 - Dissertation Prep II&#34;
                : &#34;Dissertation Completion&#34;
                Semester 9 : &#34;DSR 950 - Final Defense&#34;
                : &#34;Oral Defense &amp; Dissemination&#34;
              </div>
            </div>
          </div>

          <!-- Year 1 -->
          <div class="mb-16">
            <h3 class="font-serif text-2xl font-semibold mb-8">Year 1: Foundation and Theoretical Framework</h3>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
              <div class="bg-accent/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 1 • Terms 1-2</h4>
                <div class="text-sm space-y-2">
                  <div><strong>RSC 802:</strong> Doctoral Learning Foundations</div>
                  <div><strong>IAE 830:</strong> Information Assurance Literature</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Focus:</strong> Comprehensive literature review documenting the &#34;Neuro-Symbolic Fusion Gap&#34; and traditional SOAR failures in FCI contexts.
                  </div>
                </div>
              </div>

              <div class="bg-accent/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 2 • Terms 3-4</h4>
                <div class="text-sm space-y-2">
                  <div><strong>RSC 810:</strong> Research Theory &amp; Practice</div>
                  <div><strong>RSC 820:</strong> Situational Awareness</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Focus:</strong> Design science methodology development and architectural blueprint for neuro-symbolic fusion framework.
                  </div>
                </div>
              </div>

              <div class="bg-accent/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 3 • Terms 5-6</h4>
                <div class="text-sm space-y-2">
                  <div><strong>RSC 825:</strong> Applied Research</div>
                  <div><strong>RSC 813:</strong> Professional Ethics</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Focus:</strong> Mathematical formalization of vector space mapping Ψ: E → ℝᵈ and LTL-based ethical guardrails.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Year 2 -->
          <div class="mb-16">
            <h3 class="font-serif text-2xl font-semibold mb-8">Year 2: Implementation and Experimentation</h3>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
              <div class="bg-primary/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 4 • Terms 7-8</h4>
                <div class="text-sm space-y-2">
                  <div><strong>RSC 860:</strong> Research Design</div>
                  <div><strong>IAE 881:</strong> Special Topics II</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Deliverables:</strong>
                    <ul class="mt-2 space-y-1 text-xs">
                      <li>• Mac Studio M3 Ultra setup</li>
                      <li>• Apache Airflow + dbt pipeline</li>
                      <li>• Qdrant Vector DB implementation</li>
                      <li>• Deepseek R1 quantization setup</li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="bg-primary/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 5 • Terms 9-10</h4>
                <div class="text-sm space-y-2">
                  <div><strong>RSC 812:</strong> Research Theory II</div>
                  <div><strong>IAE 880:</strong> Special Topics</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Activities:</strong>
                    <ul class="mt-2 space-y-1 text-xs">
                      <li>• Burp Suite + Exploit Pack APT simulation</li>
                      <li>• Labeled dataset generation</li>
                      <li>• Transformer model fine-tuning</li>
                      <li>• Soar cognitive architecture integration</li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="bg-primary/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 6 • Terms 11-12</h4>
                <div class="text-sm space-y-2">
                  <div><strong>DSR 925:</strong> Dissertation Prep I</div>
                  <div><strong>IAE 882/883:</strong> Special Topics</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Validation:</strong>
                    <ul class="mt-2 space-y-1 text-xs">
                      <li>• Controlled APT experiments</li>
                      <li>• MTTR target: &lt; 5 minutes</li>
                      <li>• &#34;Do no harm&#34; principle validation</li>
                      <li>• Statistical performance measurement</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Year 3 -->
          <div class="mb-16">
            <h3 class="font-serif text-2xl font-semibold mb-8">Year 3: Analysis, Writing, and Defense</h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div class="bg-secondary/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 7 • Terms 13-14</h4>
                <div class="text-sm space-y-2">
                  <div><strong>DSR 900:</strong> Dissertation Writing</div>
                  <div><strong>IAE 884:</strong> Special Topics V</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Analysis:</strong>
                    <ul class="mt-2 space-y-1 text-xs">
                      <li>• Statistical analysis (t-tests, ANOVA)</li>
                      <li>• User studies for explainability</li>
                      <li>• Chapter 4: Results writing</li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="bg-secondary/10 p-6 rounded-lg">
                <h4 class="font-semibold text-primary mb-4">Semester 8 • Term 15</h4>
                <div class="text-sm space-y-2">
                  <div><strong>DSR 935:</strong> Dissertation Prep II</div>
                  <div class="mt-4 p-3 bg-white rounded">
                    <strong>Writing:</strong>
                    <ul class="mt-2 space-y-1 text-xs">
                      <li>• Chapter 5: Discussion &amp; Conclusions</li>
                      <li>• Defense presentation preparation</li>
                      <li>• Final manuscript polish</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-8 bg-secondary/10 p-6 rounded-lg">
              <h4 class="font-semibold text-primary mb-4">Semester 9 • Term 16 - Final Defense</h4>
              <div class="text-sm">
                <div><strong>DSR 950:</strong> Dissertation Presentation and Oral Defense</div>
                <div class="mt-4 p-3 bg-white rounded">
                  <strong>Final Steps:</strong>
                  <ul class="mt-2 space-y-1 text-xs">
                    <li>• Public presentation of research</li>
                    <li>• Committee examination defense</li>
                    <li>• Final revisions and submission</li>
                    <li>• Research dissemination planning</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: Risk Analysis -->
      <section id="risk-analysis" class="py-20 bg-accent/30">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8">
          <h2 class="font-serif text-4xl font-bold text-primary mb-12">4. Risk Analysis</h2>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-red-500">
              <div class="flex items-center mb-4">
                <i class="fas fa-microchip text-red-500 text-xl mr-3"></i>
                <h3 class="font-semibold text-red-700">Technical &amp; Hardware Risks</h3>
              </div>
              <ul class="space-y-2 text-sm">
                <li>• Single-node performance bottlenecks</li>
                <li>• Manual VRAM allocation complexity</li>
                <li>• Quantization accuracy trade-offs</li>
                <li>• Single point of failure vulnerability</li>
              </ul>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-yellow-500">
              <div class="flex items-center mb-4">
                <i class="fas fa-flask text-yellow-500 text-xl mr-3"></i>
                <h3 class="font-semibold text-yellow-700">Research &amp; Methodological Risks</h3>
              </div>
              <ul class="space-y-2 text-sm">
                <li>• Complex technology integration challenges</li>
                <li>• Realistic APT dataset generation difficulty</li>
                <li>• LTL invariant completeness verification</li>
                <li>• Edge case scenario validation complexity</li>
              </ul>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
              <div class="flex items-center mb-4">
                <i class="fas fa-clock text-blue-500 text-xl mr-3"></i>
                <h3 class="font-semibold text-blue-700">Timeline &amp; Resource Risks</h3>
              </div>
              <ul class="space-y-2 text-sm">
                <li>• 6-semester timeline feasibility</li>
                <li>• Hardware/software version dependencies</li>
                <li>• Scope creep potential</li>
                <li>• Unforeseen technical hurdles</li>
              </ul>
            </div>
          </div>

          <div class="bg-white p-8 rounded-lg shadow-sm">
            <h3 class="font-serif text-2xl font-semibold mb-6">Risk Mitigation Strategies</h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div>
                <h4 class="font-semibold text-primary mb-4">Technical Risk Mitigation</h4>
                <ul class="space-y-3 text-sm">
                  <li class="flex items-start">
                    <i class="fas fa-shield-alt text-green-600 mr-2 mt-1"></i>
                    <div>
                      <strong>Modular Architecture:</strong> Implement components with clear interfaces for incremental development and testing.
                    </div>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-database text-green-600 mr-2 mt-1"></i>
                    <div>
                      <strong>Progressive Dataset:</strong> Start with simplified threat scenarios before progressing to complex APT simulations.
                    </div>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-cog text-green-600 mr-2 mt-1"></i>
                    <div>
                      <strong>Performance Monitoring:</strong> Continuous benchmarking against MTTR targets throughout development.
                    </div>
                  </li>
                </ul>
              </div>

              <div>
                <h4 class="font-semibold text-primary mb-4">Timeline Risk Mitigation</h4>
                <ul class="space-y-3 text-sm">
                  <li class="flex items-start">
                    <i class="fas fa-tasks text-green-600 mr-2 mt-1"></i>
                    <div>
                      <strong>Phased Approach:</strong> Clear milestone definitions with contingency buffers built into schedule.
                    </div>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-users text-green-600 mr-2 mt-1"></i>
                    <div>
                      <strong>Expert Consultation:</strong> Regular advisor meetings and technical expert reviews at critical integration points.
                    </div>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-clipboard-check text-green-600 mr-2 mt-1"></i>
                    <div>
                      <strong>Scope Management:</strong> Prioritized feature implementation with clear success criteria for MVP.
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 5: Commercial SOAR Comparison -->
      <section id="commercial-comparison" class="py-20 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8">
          <h2 class="font-serif text-4xl font-bold text-primary mb-12">5. Commercial SOAR Comparison</h2>

          <div class="mb-12">
            <img src="https://kimi-web-img.moonshot.cn/img/www.fortinet.com/3dc9add7417988d7d1ced0a9ee022fce0960eac4.png" alt="Commercial cybersecurity platforms comparison" class="w-full h-64 object-cover rounded-lg shadow-lg mb-6" size="medium" aspect="wide" style="photo" query="cybersecurity platforms comparison" referrerpolicy="no-referrer" data-modified="1" data-score="0.00"/>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mb-12">
            <div>
              <h3 class="font-serif text-2xl font-semibold mb-6">Commercial Landscape Overview</h3>
              <p class="text-lg leading-relaxed mb-6">
                The commercial SOAR market is dominated by established players like
                <strong>Splunk</strong> and <strong>Palo Alto Cortex XSOAR</strong>, with
                <a href="https://defense.engineer/" class="citation-link">Gartner Magic Quadrant leadership positions</a>.
                These platforms excel at orchestrating existing security tools but share fundamental limitations.
              </p>

              <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                <h4 class="font-semibold text-red-800 mb-4">Common Commercial Limitations</h4>
                <ul class="space-y-2 text-sm text-red-700">
                  <li>• <strong>70% failure rate against novel attacks</strong> (static playbook dependency)</li>
                  <li>• Brittle rule-based logic requiring manual updates</li>
                  <li>• Limited adaptation to emerging threat vectors</li>
                  <li>• High operational overhead and analyst fatigue</li>
                  <li>• &#34;Black box&#34; AI implementations lacking explainability</li>
                </ul>
              </div>
            </div>

            <div>
              <h3 class="font-serif text-2xl font-semibold mb-6">Cognitive SOAR Advantages</h3>
              <p class="text-lg leading-relaxed mb-6">
                The proposed framework directly addresses commercial limitations through its
                <strong>neuro-symbolic architecture</strong>, achieving both adaptive capability
                and mathematical safety guarantees required for FCI environments.
              </p>

              <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                <h4 class="font-semibold text-green-800 mb-4">Competitive Differentiators</h4>
                <ul class="space-y-2 text-sm text-green-700">
                  <li>• <strong>Novel threat recognition</strong> through vectorized CBR</li>
                  <li>• <strong>Autonomous response generation</strong> with LLM synthesis</li>
                  <li>• <strong>Mathematical safety guarantees</strong> via LTL verification</li>
                  <li>• <strong>Explainable by design</strong> with precedent-based reasoning</li>
                  <li>• <strong>Regulatory compliance</strong> for FCI requirements</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Performance Comparison -->
          <div class="bg-primary/5 p-8 rounded-lg">
            <h3 class="font-serif text-2xl font-semibold mb-8 text-center">Performance Comparison Matrix</h3>

            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b-2 border-primary/20">
                    <th class="text-left py-4 px-4 font-semibold">Capability</th>
                    <th class="text-center py-4 px-4 font-semibold">Traditional SOAR</th>
                    <th class="text-center py-4 px-4 font-semibold">Agentic AI</th>
                    <th class="text-center py-4 px-4 font-semibold text-primary">Cognitive SOAR</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-primary/10">
                  <tr>
                    <td class="py-4 px-4 font-medium">Response Time (MTTR)</td>
                    <td class="py-4 px-4 text-center">47 minutes</td>
                    <td class="py-4 px-4 text-center">Variable</td>
                    <td class="py-4 px-4 text-center text-primary font-semibold">
                      &lt; 5 minutes</td>
                  </tr>
                  <tr>
                    <td class="py-4 px-4 font-medium">Novel Threat Handling</td>
                    <td class="py-4 px-4 text-center text-red-600">❌ 70% failure</td>
                    <td class="py-4 px-4 text-center text-yellow-600">⚠️ Limited</td>
                    <td class="py-4 px-4 text-center text-green-600">✅ Adaptive</td>
                  </tr>
                  <tr>
                    <td class="py-4 px-4 font-medium">Safety Guarantees</td>
                    <td class="py-4 px-4 text-center text-red-600">❌ Rule-based</td>
                    <td class="py-4 px-4 text-center text-red-600">❌ Black box</td>
                    <td class="py-4 px-4 text-center text-green-600">✅ Mathematical</td>
                  </tr>
                  <tr>
                    <td class="py-4 px-4 font-medium">Explainability</td>
                    <td class="py-4 px-4 text-center text-yellow-600">⚠️ Limited</td>
                    <td class="py-4 px-4 text-center text-red-600">❌ Opaque</td>
                    <td class="py-4 px-4 text-center text-green-600">✅ Precedent-based</td>
                  </tr>
                  <tr>
                    <td class="py-4 px-4 font-medium">Regulatory Compliance</td>
                    <td class="py-4 px-4 text-center text-yellow-600">⚠️ Partial</td>
                    <td class="py-4 px-4 text-center text-red-600">❌ Challenging</td>
                    <td class="py-4 px-4 text-center text-green-600">✅ Designed for FCI</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Market Positioning -->
          <div class="mt-12 bg-gradient-to-r from-primary/10 to-secondary/10 p-8 rounded-lg">
            <h3 class="font-serif text-2xl font-semibold mb-6">Market Positioning and Impact</h3>
            <p class="text-lg leading-relaxed mb-6">
              The Cognitive SOAR Framework&#39;s unique combination of <strong>adaptive capability, mathematical safety,
                and explainable decision-making</strong> positions it as a next-generation solution for organizations
              requiring trustworthy AI in critical infrastructure protection.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div class="text-center">
                <div class="text-3xl font-bold text-primary mb-2">70%</div>
                <div class="text-sm text-dark/70">Reduction in threat response time</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-primary mb-2">30x</div>
                <div class="text-sm text-dark/70">Improvement in handling novel attacks</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-primary mb-2">100%</div>
                <div class="text-sm text-dark/70">Mathematical safety guarantees</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="bg-dark text-white py-12">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
              <h3 class="font-serif text-xl font-semibold mb-4">Research Conclusions</h3>
              <p class="text-sm text-white/80">
                The Cognitive SOAR Framework represents a viable and original contribution to cybersecurity research,
                with demonstrated feasibility for completion within the Capitol Technology University D.Sc. program timeline.
              </p>
            </div>
            <div>
              <h3 class="font-serif text-xl font-semibold mb-4">Key Contributions</h3>
              <ul class="text-sm text-white/80 space-y-1">
                <li>• Neuro-symbolic AI integration</li>
                <li>• Mathematical safety guarantees</li>
                <li>• Real-world FCI application</li>
                <li>• Sub-5-minute threat response</li>
              </ul>
            </div>
            <div>
              <h3 class="font-serif text-xl font-semibold mb-4">Research Status</h3>
              <p class="text-sm text-white/80">
                This viability report confirms the research proposal&#39;s originality, technical feasibility,
                and potential impact for Financial Critical Infrastructure protection.
              </p>
              <p class="text-xs text-white/60 mt-4">
                Capitol Technology University • Doctor of Science in Cybersecurity
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#F5F1EB',
                primaryTextColor: '#2C1810',
                primaryBorderColor: '#8B5A3C',
                lineColor: '#8B5A3C',
                secondaryColor: '#D4A574',
                tertiaryColor: '#E8D5B7',
                background: '#FFFFFF',
                mainBkg: '#F5F1EB',
                secondBkg: '#D4A574',
                tertiaryBkg: '#E8D5B7',
                clusterBkg: 'rgba(139, 90, 60, 0.1)',
                clusterBorder: '#8B5A3C',
                defaultLinkColor: '#8B5A3C',
                titleColor: '#2C1810',
                edgeLabelBackground: '#F5F1EB',
                nodeTextColor: '#2C1810',
                fontFamily: 'Inter, sans-serif',
                fontSize: '13px'
            },
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            },
            timeline: {
                useMaxWidth: false,
                padding: 20
            }
        });

        // Initialize Mermaid Controls for zoom and pan
        function initializeMermaidControls() {
            const containers = document.querySelectorAll('.mermaid-container');

            containers.forEach(container => {
            const mermaidElement = container.querySelector('.mermaid');
            let scale = 1;
            let isDragging = false;
            let startX, startY, translateX = 0, translateY = 0;

            // 触摸相关状态
            let isTouch = false;
            let touchStartTime = 0;
            let initialDistance = 0;
            let initialScale = 1;
            let isPinching = false;

            // Zoom controls
            const zoomInBtn = container.querySelector('.zoom-in');
            const zoomOutBtn = container.querySelector('.zoom-out');
            const resetBtn = container.querySelector('.reset-zoom');
            const fullscreenBtn = container.querySelector('.fullscreen');

            function updateTransform() {
                mermaidElement.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

                if (scale > 1) {
                container.classList.add('zoomed');
                } else {
                container.classList.remove('zoomed');
                }

                mermaidElement.style.cursor = isDragging ? 'grabbing' : 'grab';
            }

            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', () => {
                scale = Math.min(scale * 1.25, 4);
                updateTransform();
                });
            }

            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', () => {
                scale = Math.max(scale / 1.25, 0.3);
                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }
                updateTransform();
                });
            }

            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                scale = 1;
                translateX = 0;
                translateY = 0;
                updateTransform();
                });
            }

            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', () => {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
                });
            }

            // Mouse Events
            mermaidElement.addEventListener('mousedown', (e) => {
                if (isTouch) return; // 如果是触摸设备，忽略鼠标事件

                isDragging = true;
                startX = e.clientX - translateX;
                startY = e.clientY - translateY;
                mermaidElement.style.cursor = 'grabbing';
                updateTransform();
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && !isTouch) {
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            document.addEventListener('mouseleave', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            // 获取两点之间的距离
            function getTouchDistance(touch1, touch2) {
                return Math.hypot(
                touch2.clientX - touch1.clientX,
                touch2.clientY - touch1.clientY
                );
            }

            // Touch Events - 触摸事件处理
            mermaidElement.addEventListener('touchstart', (e) => {
                isTouch = true;
                touchStartTime = Date.now();

                if (e.touches.length === 1) {
                // 单指拖动
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;

                } else if (e.touches.length === 2) {
                // 双指缩放
                isPinching = true;
                isDragging = false;

                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                initialDistance = getTouchDistance(touch1, touch2);
                initialScale = scale;
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1 && isDragging && !isPinching) {
                // 单指拖动
                const touch = e.touches[0];
                translateX = touch.clientX - startX;
                translateY = touch.clientY - startY;
                updateTransform();

                } else if (e.touches.length === 2 && isPinching) {
                // 双指缩放
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const currentDistance = getTouchDistance(touch1, touch2);

                if (initialDistance > 0) {
                    const newScale = Math.min(Math.max(
                    initialScale * (currentDistance / initialDistance),
                    0.3
                    ), 4);
                    scale = newScale;
                    updateTransform();
                }
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchend', (e) => {
                // 重置状态
                if (e.touches.length === 0) {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                // 延迟重置isTouch，避免鼠标事件立即触发
                setTimeout(() => {
                    isTouch = false;
                }, 100);
                } else if (e.touches.length === 1 && isPinching) {
                // 从双指变为单指，切换为拖动模式
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;
                }

                updateTransform();
            });

            mermaidElement.addEventListener('touchcancel', (e) => {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                setTimeout(() => {
                isTouch = false;
                }, 100);

                updateTransform();
            });

            // Enhanced wheel zoom with better center point handling
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                const rect = container.getBoundingClientRect();
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                const newScale = Math.min(Math.max(scale * delta, 0.3), 4);

                // Adjust translation to zoom towards center
                if (newScale !== scale) {
                const scaleDiff = newScale / scale;
                translateX = translateX * scaleDiff;
                translateY = translateY * scaleDiff;
                scale = newScale;

                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }

                updateTransform();
                }
            });

            // Initialize display
            updateTransform();
            });
        }

        // Initialize Mermaid Controls on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', initializeMermaidControls);

        // Mobile TOC toggle
        const tocToggle = document.getElementById('toc-toggle');
        const toc = document.getElementById('toc');

        tocToggle.addEventListener('click', () => {
            toc.classList.toggle('open');
        });

        // Close TOC when clicking outside on mobile
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 1024 && !toc.contains(e.target) && !tocToggle.contains(e.target)) {
                toc.classList.remove('open');
            }
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    // Close mobile TOC
                    toc.classList.remove('open');
                }
            });
        });

        // Highlight current section in TOC
        const sections = document.querySelectorAll('section[id]');
        const tocLinks = document.querySelectorAll('#toc a[href^="#"]');

        function highlightCurrentSection() {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            tocLinks.forEach(link => {
                link.classList.remove('bg-primary', 'text-white');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('bg-primary', 'text-white');
                }
            });
        }

        window.addEventListener('scroll', highlightCurrentSection);
        highlightCurrentSection(); // Initial call
    </script>
  

</body></html>
